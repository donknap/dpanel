"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{43774:function(de,W,t){t.r(W),t.d(W,{default:function(){return Ae}});var Y=t(5574),d=t.n(Y),k=t(24963),y=t(15078),O=t(74453),G=t(97269),z=t(62370),q=t(97462),R=t(38345),oe=t(45360),A=t(42075),_=t(25278),M=t(83622),ee=t(92398),I=t(2487),te=t(86250),F=t(32983),m=t(4393),r=t(67294),D=t(15009),a=t.n(D),me=t(99289),he=t.n(me),pe=t(184),fe=t(5966),ne=t(1269),N=t(71230),Z=t(15746),ve=t(34041),ge=t(74842),ae=t(25593),je=t(83062),ie=t(66309),e=t(85893);function le(n){var C=(0,r.useState)(),v=d()(C,2),l=v[0],g=v[1];return(0,r.useEffect)(function(){var b=n.url.substring(0,n.url.indexOf("://"));switch(b){case"image":g((0,e.jsx)("img",{width:n.imageSize?n.imageSize.width:"auto",height:n.imageSize?n.imageSize.height:"auto",src:n.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":g((0,e.jsx)("img",{width:n.imageSize?n.imageSize.width:"auto",height:n.imageSize?n.imageSize.height:"auto",src:n.url}));break;case"markdown-file":(0,y.yL)({path:n.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(w){g((0,e.jsx)(ne.Z,{source:w,style:{padding:5}},"content"))});break;case"markdown":g((0,e.jsx)(ne.Z,{source:n.url.replace("markdown://",""),style:{padding:5}},"content"));break;default:g("")}},[n.url]),(0,e.jsx)(e.Fragment,{children:l})}var E=t(36146);function ue(n){var C=new E.Uo;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(N.Z,{gutter:[10,10],children:[(0,e.jsx)(Z.Z,{span:6,children:(0,e.jsx)(le,{url:n.app.logo,imageSize:n.logoSize})}),(0,e.jsxs)(Z.Z,{span:n.extra?12:18,children:[(0,e.jsx)(N.Z,{children:(0,e.jsx)(Z.Z,{span:24,children:(0,e.jsxs)(A.Z,{direction:"horizontal",children:[(0,e.jsx)(ae.Z.Title,{level:5,children:(0,e.jsx)("a",{href:n.app.website,target:"_blank",children:n.app.title})}),(0,e.jsx)(ae.Z.Text,{children:n.app.name})]})})}),(0,e.jsx)(N.Z,{style:{height:"60px"},children:(0,e.jsx)(Z.Z,{children:(0,e.jsx)(je.Z,{title:C.formatCurrent(n.app.descriptions,n.app.description),children:(0,e.jsx)(ae.Z.Paragraph,{ellipsis:{rows:2},children:C.formatCurrent(n.app.descriptions,n.app.description)})})})}),(0,e.jsx)(N.Z,{style:{height:"35px"},children:(0,e.jsx)(Z.Z,{children:(0,e.jsxs)(A.Z,{wrap:!0,children:[n.app.storeName?(0,e.jsx)(ie.Z,{color:"blue-inverse",children:n.app.storeName}):"",n.app.tag&&n.app.tag.map(function(v,l){return(0,e.jsx)(ie.Z,{children:v},l)})]})})})]}),(0,e.jsx)(Z.Z,{span:n.extra?6:0,children:n.extra})]})})}var xe=t(80821),Se=t(90098),re=t(82346),ye=t(91218),Ze=t(3616),Ce=(0,r.forwardRef)(function(n,C){var v=(0,r.useState)(!1),l=d()(v,2),g=l[0],b=l[1],w=(0,r.useState)(),J=d()(w,2),s=J[0],j=J[1],P=(0,r.useState)(""),Q=d()(P,2),x=Q[0],V=Q[1],H=(0,re.useNavigate)(),T=(0,r.useRef)(),S=(0,r.useRef)(),B=(0,r.useState)(),u=d()(B,2),i=u[0],f=u[1],h=new E.Uo("components.appstore");return(0,r.useImperativeHandle)(C,function(){return{show:function(c){var p;b(!0),j(c),V((p=Object.keys(c.version).find(function(U){return c.version[U].default}))!==null&&p!==void 0?p:c.version[0].name)}}}),(0,e.jsxs)(pe.a,{drawerProps:{width:Ze.R_},submitter:!1,open:g,onOpenChange:function(c){var p;b(c),(p=T.current)===null||p===void 0||p.resetFields()},title:"".concat(s==null?void 0:s.name," ").concat(E.FD.format("listManageDetail")),children:[(0,e.jsx)(ye.Z,{showBackListButton:!0,ref:S}),s&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(ue,{app:s,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(N.Z,{gutter:[10,10],children:[(0,e.jsx)(Z.Z,{span:24,children:(0,e.jsx)(xe.Z,{buttonProps:{block:!0,type:"primary",icon:(0,e.jsx)(ge.Z,{})},confirmProps:{description:(0,e.jsx)(G.A,{submitter:!1,formRef:T,layout:"horizontal",isKeyPressSubmit:!0,children:(0,e.jsx)(fe.Z,{placeholder:h.format("detailNameEmpty"),width:"md",label:h.format("detailName"),name:"name"})})},action:he()(a()().mark(function o(){var c,p,U,ce,K,se;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return ce={storeId:(c=s.storeId)!==null&&c!==void 0?c:0,name:(p=(U=T.current)===null||U===void 0?void 0:U.getFieldValue("name"))!==null&&p!==void 0?p:"".concat(s.name,"-%CURRENT_DATE%"),version:x,appName:s.name,title:s.title,composeFile:s.version[x].composeFile,environment:s.version[x].environment&&s.version[x].environment.map(function(X){return X.label=h.formatCurrent(X.labels,X.label),X})},$.next=3,(0,Se.iE)(ce);case 3:K=$.sent,K&&K.data.id&&(f(K.data.id),(se=S.current)===null||se===void 0||se.show(K.data.id));case 5:case"end":return $.stop()}},o)})),children:E.FD.format("listManageDeploy")},"deploy")}),(0,e.jsx)(Z.Z,{span:24,children:s.version&&(0,e.jsx)(ve.Z,{style:{width:"100%"},value:x,onChange:function(c){V(c)},options:Object.keys(s.version).map(function(o){return{value:o,label:o,checked:!0}})})})]})})})}),Object.keys(s.version).map(function(o){if(!(x!=o||!s.version[o].environment||s.version[o].environment.length==0)){var c="";return c+="## ".concat(h.format("detailDescVersion")," <sup>").concat(o,`</sup> 
 |`).concat(h.format("detailDescName"),"|").concat(h.format("detailDescDefault"),"|").concat(h.format("detailDescDesc"),`| 
 |---|---|---|
`),s.version[o].environment.map(function(p){c+="|".concat(p.name,"|").concat(p.value,"|").concat(h.formatCurrent(p.labels,p.label),`| 
`)}),c+="<br />",(0,e.jsx)(ne.Z,{source:c,style:{padding:5}},o)}}),(0,e.jsx)(le,{url:h.formatCurrent(s==null?void 0:s.contents,s==null?void 0:s.content)})]})]})}),Oe=Ce,L="dpanel-search-result";function Ae(){var n=(0,r.useRef)(),C=(0,r.useState)(),v=d()(C,2),l=v[0],g=v[1],b=(0,r.useContext)(k.Z),w=b.loading,J=(0,r.useState)(""),s=d()(J,2),j=s[0],P=s[1],Q=(0,r.useState)([]),x=d()(Q,2),V=x[0],H=x[1],T=(0,re.useLocation)(),S=new E.Uo("compose");(0,r.useEffect)(function(){w.show(),(0,y.eO)().then(function(u){if(u&&u.data&&u.data.list&&u.data.list.push({id:-1,name:L,title:S.format("storeSearchTitle"),setting:{apps:[]}}),g(Object.fromEntries(u.data.list.map(function(f){return[f.name,f]}))),T.state){var i=T.state;i.name!=""&&P(T.state.name)}else u.data.list.length>0&&P(u.data.list[0].name)}).finally(function(){w.destroy()})},[]);var B=function(i){var f=[];i=i.toLowerCase(),l&&(Object.keys(l).map(function(h){h!=L&&l[h].setting.apps&&l[h].setting.apps.map(function(o){if(i&&(o.name.toLowerCase().indexOf(i)!==-1||o.title&&o.title.toLowerCase().indexOf(i)!==-1||o.description&&o.description.toLocaleLowerCase().indexOf(i)!==-1)){var c=JSON.parse(JSON.stringify(o));c.storeName="".concat(l[h].title),c.storeId=l[h].id,f.push(c)}})}),f.length>0?(H(f),P(L)):(oe.ZP.error(S.format("storeSearchNotMatch")),P(Object.keys(l)[0]),H([])))};return(0,e.jsxs)(O._z,{extra:[(0,e.jsx)(G.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(i){B(i.search)},children:(0,e.jsxs)(A.Z.Compact,{children:[(0,e.jsx)(z.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(_.Z,{allowClear:!0,addonBefore:S.format("storeSearchButtonTip"),placeholder:S.format("storeSearchButtonEmpty"),onClear:function(){B("")}})}),(0,e.jsx)(q.Z,{name:["search"],children:function(i){var f=i.search;return(0,e.jsx)(M.ZP,{onClick:function(){B(f)},children:S.format("storeSearchButton")})}})]})},"form")],children:[(0,e.jsx)(Oe,{ref:n}),(0,e.jsxs)(R.Z,{children:[j!=""&&l&&(0,e.jsx)(ee.Z,{activeKey:j,onChange:function(i){H([]),P(i)},items:Object.keys(l).map(function(u){return{label:l[u].title||new E.Uo("compose").format("storeTitleOption."+u),key:u,disabled:j!=L&&u==L}})}),(0,e.jsx)(I.Z,{locale:{emptyText:(0,e.jsx)(te.Z,{justify:"center",style:{height:"40vh"},vertical:!0,children:(0,e.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(e.Fragment,{children:[S.format("storeEmpty"),", ",(0,e.jsx)(re.Link,{to:"/system/appstore?op=create",children:E.Ob.format("compose.appstore.create")})]})})})},pagination:{pageSize:36},rowKey:function(i){return"".concat(i.name).concat(i.storeName)},grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:j==L?V:l&&l[j]&&l[j].setting.apps,renderItem:function(i,f){return(0,e.jsx)(I.Z.Item,{children:(0,e.jsx)(m.Z,{onClick:function(){if(l){var o;i.storeId||(i.storeId=l[j].id),(o=n.current)===null||o===void 0||o.show(i)}},hoverable:!0,children:(0,e.jsx)(ue,{app:i,logoSize:{width:"50",height:"50"}})})},f)}})]})]})}},15078:function(de,W,t){t.d(W,{$c:function(){return G},Me:function(){return ee},eO:function(){return _},ks:function(){return q},yL:function(){return te}});var Y=t(15009),d=t.n(Y),k=t(99289),y=t.n(k),O=t(82346);function G(m){return z.apply(this,arguments)}function z(){return z=y()(d()().mark(function m(r){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/common/store/create",{method:"POST",data:r}));case 1:case"end":return a.stop()}},m)})),z.apply(this,arguments)}function q(m){return R.apply(this,arguments)}function R(){return R=y()(d()().mark(function m(r){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/common/store/sync",{method:"POST",data:r}));case 1:case"end":return a.stop()}},m)})),R.apply(this,arguments)}function oe(m){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function m(r){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/dpanel/api/common/store/get-detail",{method:"POST",data:r}));case 1:case"end":return a.stop()}},m)})),A.apply(this,arguments)}function _(m){return M.apply(this,arguments)}function M(){return M=y()(d()().mark(function m(r){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/common/store/get-list",{method:"POST",data:r}));case 1:case"end":return a.stop()}},m)})),M.apply(this,arguments)}function ee(m){return I.apply(this,arguments)}function I(){return I=y()(d()().mark(function m(r){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,O.request)("/dpanel/api/common/store/delete",{method:"POST",data:r});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},m)})),I.apply(this,arguments)}function te(m){return F.apply(this,arguments)}function F(){return F=y()(d()().mark(function m(r){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)(r==null?void 0:r.path,{method:"GET"}));case 1:case"end":return a.stop()}},m)})),F.apply(this,arguments)}}}]);
