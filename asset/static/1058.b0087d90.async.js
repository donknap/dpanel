"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(Q,W,e){var b=e(9783),l=e.n(b),j=e(19632),p=e.n(j),i=e(97857),m=e.n(i),S=e(5574),I=e.n(S),R=e(89035),M=e(45605),L=e(64317),Y=e(31199),g=e(5966),h=e(38345),x=e(17186),f=e(24739),A=e(42075),F=e(83622),K=e(83062),T=e(85576),C=e(67294),N=e(11106),Z=e(12491),D=e(62597),O=e(79245),o=e(3616),s=e(36146),a=e(85893),n="docker-image",$=(0,C.forwardRef)(function(u,q){var G=(0,C.useState)(n),ee=I()(G,2),z=ee[0],w=ee[1],E=(0,C.useRef)(),J=(0,C.useState)(""),ne=I()(J,2),ae=ne[0],oe=ne[1],B=new s.Uo("components.appForm");(0,C.useImperativeHandle)(q,function(){return{addEnvItem:function(t,d){var c,_=(c=E.current)===null||c===void 0?void 0:c.getList(),v=!1;if(_==null||_.map(function(y){if(y.name==t){v=!0;return}}),!v){var P;(P=E.current)===null||P===void 0||P.add({name:t,value:d})}},clear:function(){var t;(t=E.current)===null||t===void 0||(t=t.getList())===null||t===void 0||t.map(function(d,c){var _;(_=E.current)===null||_===void 0||_.remove(c)})}}});function re(r){try{var t,d;r==""&&(r=te());for(var c=(t=(d=E.current)===null||d===void 0||(d=d.getList())===null||d===void 0?void 0:d.length)!==null&&t!==void 0?t:0,_=c;_>=0;_--){var v,P,y=(v=E.current)===null||v===void 0?void 0:v.get(_);c-=1,(P=E.current)===null||P===void 0||P.remove(_)}var V=r.split(`
`),X=c+1;V.map(function(k){var U,H=k.split("=");H.length<2||((U=E.current)===null||U===void 0||U.add({name:H[0],value:H.slice(1).join("=")},X),X++)})}catch(k){console.log(k)}}function _e(){z!="code"?w("code"):w(n)}function te(){if(E&&E.current&&E.current.getList){var r,t=(r=E.current)===null||r===void 0?void 0:r.getList();if(t){var d=[];return t.forEach(function(c){d.push("".concat(c.name,"=").concat(c.value))}),d.join(`
`)}else return""}else return""}function ue(r){var t,d,c,_,v,P,y={},V={help:(0,O.y)((t=r.rule)===null||t===void 0?void 0:t.kind,D.fp.EnvValueTypeOnePanel)?B.formatOnePanel(r.name):B.formatUser(r.labels),name:"value",label:B.format("createEnvFormValue"),rules:[{required:u.requireValue?!0:(0,O.y)((d=r.rule)===null||d===void 0?void 0:d.kind,D.fp.EnvValueRuleRequired)}],addonAfter:!0,disabled:u.showDisableValue||(0,O.y)((c=r.rule)===null||c===void 0?void 0:c.kind,D.fp.EnvValueRuleDisabled),placeholder:r.label};if((0,O.y)((_=r.rule)===null||_===void 0?void 0:_.kind,D.fp.EnvValueTypeSelect)){var X;return(0,a.jsx)(L.Z,m()(m()({fieldProps:y},V),{},{initialValue:r.value,width:u.showInDrawer?"sm":"md",options:((X=r.rule)===null||X===void 0?void 0:X.option)&&r.rule.option.map(function(U){return{label:U.name,value:U.value}})}),r.name)}else if((0,O.y)((v=r.rule)===null||v===void 0?void 0:v.kind,D.fp.EnvValueTypeSelectMultiple)){var k;return(0,a.jsx)(L.Z,m()(m()({mode:"tags"},V),{},{fieldProps:y,convertValue:function(H){return Array.isArray(H)?H:H.split(",")},width:u.showInDrawer?"sm":"md",options:((k=r.rule)===null||k===void 0?void 0:k.option)&&r.rule.option.map(function(U){return{label:U.name,value:U.value}})}),r.name)}else return(0,O.y)((P=r.rule)===null||P===void 0?void 0:P.kind,D.fp.EnvValueTypeNumber)?(0,a.jsx)(Y.Z,m()(m()({fieldProps:y},V),{},{width:u.showInDrawer?"sm":"md",rules:[].concat(p()(V.rules),[{pattern:new RegExp("^[0-9]*$")}])}),r.name):(0,a.jsx)(g.Z,m()(m()({fieldProps:y},V),{},{width:u.showInDrawer?"sm":"md"}),r.name)}return(0,a.jsxs)(h.Z,m()(m()({headerBordered:!0,extra:(u.showCodeMode||u.showImportButton)&&(0,a.jsxs)(A.Z,{children:[u.showImportButton&&(0,a.jsx)("div",{style:{marginBottom:"-25px"},children:(0,a.jsx)(Z.Z,{title:B.format("createEnvFormEnvImport"),onImport:function(t){return re(t),!0},onLoad:function(t){if(t.indexOf("=")<0)throw new Error(s.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),u.showCodeMode?(0,a.jsx)(F.ZP,{icon:(0,a.jsx)(R.Z,{}),type:z=="code"?"primary":"default",onClick:_e,children:B.format("createEnvFormEnvCode")},"code"):""]})},u.drawerProps),{},{children:[(0,a.jsx)(x.u,{style:{marginTop:10},name:u.name?u.name:"environment",actionRef:E,creatorButtonProps:u.showAddButton?{creatorButtonText:u.addButtonLabel?u.addButtonLabel:B.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:u.showDeleteButton,actionRender:function(t,d,c,_){var v,P,y=(v=E.current)===null||v===void 0?void 0:v.get(t.key);return y&&(0,O.y)((P=y.rule)===null||P===void 0?void 0:P.kind,D.fp.EnvValueRuleInEnvFile)?[(0,a.jsx)(K.Z,{title:B.format("createEnvFormListInEnvFile"),children:(0,a.jsx)(F.ZP,{type:"text",icon:(0,a.jsx)(M.Z,{})})},"inEnvFile")]:[c[0]]},min:100,label:u.listLabel,transform:function(t,d,c){return l()({},d,t.map(function(_){return Array.isArray(_.value)?_.value=_.value.filter(function(v){return v!=""}).join(","):_.value=_.value.toString(),_}))},children:function(t,d,c){var _,v=c.getCurrentRowData();return(0,a.jsxs)(f.UW,{style:{marginBottom:"5px"},children:[(0,a.jsx)(g.Z,{width:u.showInDrawer?"sm":"md",name:"name",label:B.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:u.showDisableName||(0,O.y)((_=v.rule)===null||_===void 0?void 0:_.kind,D.fp.EnvValueRuleInEnvFile),placeholder:B.format("createEnvFormName")},d),ue(v)]})}}),u.showCodeMode&&(0,a.jsx)(T.Z,{width:o.ob,open:z=="code",onCancel:function(){return w("docker-image")},onOk:function(){re(ae),w("docker-image")},children:(0,a.jsx)(N.ZP,{onChange:function(t){return oe(t)},value:te(),height:o.Ed,theme:"dark"})})]}))});W.Z=$},12491:function(Q,W,e){e.d(W,{Z:function(){return x}});var b=e(5574),l=e.n(b),j=e(3616),p=e(24963),i=e(36146),m=e(88484),S=e(57546),I=e(62370),R=e(11106),M=e(42075),L=e(83622),Y=e(85576),g=e(67294),h=e(85893);function x(f){var A=(0,g.useContext)(p.Z),F=A.message,K=A.notice,T=(0,g.useRef)(null),C=(0,g.useState)(!1),N=l()(C,2),Z=N[0],D=N[1],O=(0,g.useState)(""),o=l()(O,2),s=o[0],a=o[1];(0,g.useEffect)(function(){f.data&&a(f.data)},[f.data]);var n=function(){T.current&&(T.current.click(),T.current.onchange=function(u){if(!u||!u.target)return"";var q=new FileReader;q.onload=function(z){var w,E,J=(w=z.target)===null||w===void 0?void 0:w.result;if(f.onLoad)try{f.onLoad&&f.onLoad(J)}catch(ne){K.error(ne);return}a(J),typeof f.onImport=="function"&&(F.success(i.FD.format("finish")),f.onImport(J)),(E=T.current)!==null&&E!==void 0&&E.value&&(T.current.value="")};var G=u.target;if(G.files&&G.files[0]){var ee=G.files[0];try{q.readAsText(ee)}catch(z){K.error(i.FD.format("commonContentIncorrectFormat",{name:G.files[0].name}))}}})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(I.Z,{children:(0,h.jsxs)(M.Z.Compact,{block:!0,children:[(0,h.jsx)(L.ZP,{icon:(0,h.jsx)(m.Z,{}),block:!0,onClick:n,children:f.title}),f.showPaset&&(0,h.jsx)(L.ZP,{icon:(0,h.jsx)(S.Z,{}),onClick:function(){D(!0)}})]})}),(0,h.jsx)("input",{style:{display:"none"},type:"file",ref:T,name:"importFileInput"}),(0,h.jsx)(Y.Z,{width:j.ob,open:Z,onCancel:function(){D(!1)},onOk:function(){typeof f.onImport=="function"&&(F.success(i.FD.format("finish")),f.onImport(s)),D(!1)},children:(0,h.jsx)(R.ZP,{height:j.Ed,theme:"dark",value:s,onChange:function(u){a(u)}})})]})}},3616:function(Q,W,e){e.d(W,{Ed:function(){return p},FK:function(){return l},R_:function(){return b},ob:function(){return j}});var b=window.innerWidth<=1024?"90vw":"65vw",l="90vw",j="60vw",p="50vh"},62597:function(Q,W,e){e.d(W,{$G:function(){return R},Ct:function(){return T},Tb:function(){return h},XH:function(){return f},cl:function(){return Y},fp:function(){return L},fu:function(){return S},iE:function(){return F},nL:function(){return I},xb:function(){return N},ze:function(){return D}});var b=e(15009),l=e.n(b),j=e(99289),p=e.n(j),i=e(82346),m="com.dpanel.container.description",S="com.dpanel.container.title",I={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function R(o){return M.apply(this,arguments)}function M(){return M=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/dpanel/api/app/site/create-by-image",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),M.apply(this,arguments)}var L={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleInEnvFile:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192,EnvValueTypeOnePanel:16384};function Y(o){return g.apply(this,arguments)}function g(){return g=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/dpanel/api/app/site/get-list",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),g.apply(this,arguments)}function h(o){return x.apply(this,arguments)}function x(){return x=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.download=!1,n.next=3,(0,i.request)("/dpanel/api/app/log/run",{method:"POST",data:s});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),x.apply(this,arguments)}function f(o){return A.apply(this,arguments)}function A(){return A=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.download=!0,n.next=3,(0,i.request)("/dpanel/api/app/log/run",{method:"POST",data:s,responseType:"blob"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),A.apply(this,arguments)}function F(o){return K.apply(this,arguments)}function K(){return K=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.id=String(s.id),n.next=3,(0,i.request)("/dpanel/api/app/site/get-detail",{data:s,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),K.apply(this,arguments)}function T(o){return C.apply(this,arguments)}function C(){return C=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/dpanel/api/app/container/delete",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),C.apply(this,arguments)}function N(o){return Z.apply(this,arguments)}function Z(){return Z=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/dpanel/api/app/site/delete",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),Z.apply(this,arguments)}function D(o){return O.apply(this,arguments)}function O(){return O=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,i.request)("/dpanel/api/app/container/ignore",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),O.apply(this,arguments)}},79245:function(Q,W,e){e.d(W,{m:function(){return j},y:function(){return p}});var b=e(64599),l=e.n(b);function j(i){var m=[];if(!i||i=="")return m;var S=i.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),I=l()(S),R;try{for(I.s();!(R=I.n()).done;){var M=R.value;m.push({name:M[1],value:M[2]?M[2].indexOf("-")==0?M[2].substring(1):M[2]:""})}}catch(L){I.e(L)}finally{I.f()}return m}function p(i,m){return!i||!m?!1:(i&m)!==0}}}]);
