(self.webpackChunk=self.webpackChunk||[]).push([[6856],{49610:function(O,_,e){"use strict";var n=e(5574),i=e.n(n),P=e(12323),h=e(52626),v=e(87662),d=e(78267),f=e.n(d),E=e(4244),p=e.n(E),A=e(24078),c=e(67294),D=e(85893),t,l,s,m,S=(0,c.forwardRef)(function(R,B){var b,K=(0,c.useState)(),C=i()(K,2),W=C[0],w=C[1],L=(0,c.useState)(""),I=i()(L,2),y=I[0],x=I[1];function T(){m&&(t.reset(),l.fit(),t.focus(),m.dispose()),s&&(s.close(),s=null)}return(0,c.useImperativeHandle)(B,function(){return{start:function(r,o){T(),l.fit(),o.width=t.cols,o.height=t.rows;var g=o?Object.keys(o).filter(function(u){return o&&o[u]}).map(function(u){return o&&o[u]?"".concat(u,"=").concat(o[u]):""}):[];s=new WebSocket((0,h.R)(r+"?"+g.join("&"))),s.addEventListener("message",function(u){var M=JSON.parse(u.data),U=M.type;if(U===r&&(t.write(M.data),M.data.indexOf("exec failed")!==-1)){T();return}}),m=t.onData(function(u){var M={content:{command:u},type:r};s&&s.send(JSON.stringify(M))}),x(r),w(o)},close:function(){T()},fit:function(){return l.fit(),{width:t.cols,height:t.rows}},run:function(r){W&&(r==null||r.forEach(function(o){var g={content:{command:o+`
`},type:y};s&&s.send(JSON.stringify(g))}))}}}),(0,c.useEffect)(function(){return t=new E.Terminal(P.X),l=new d.FitAddon,t.loadAddon(l),t.open(document.getElementById("terminal-container-console")),l.fit(),t.onKey(function(a){var r=a.domEvent;if(r.ctrlKey&&r.key==="c"){var o=t.getSelection();if(o){navigator.clipboard.writeText(o).then(function(){t.clearSelection()}),r.preventDefault();return}}r.ctrlKey&&r.key==="v"&&(navigator.clipboard.readText().then(function(g){g&&t.input(g)}),r.preventDefault())}),(0,v.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(a){a.data&&a.data.fontSize&&Object.assign(t.options,a.data)}),function(){T()}},[]),(0,c.useEffect)(function(){window.addEventListener("resize",function(){l.fit();var a={size:{width:t.cols,height:t.rows},type:y};y&&s&&s.send(JSON.stringify(a))})},[y]),(0,D.jsx)("div",{style:{height:(b=R.height)!==null&&b!==void 0?b:"100vh"},id:"terminal-container-console"})});_.Z=S},12323:function(O,_,e){"use strict";e.d(_,{X:function(){return n},n:function(){return i}});var n={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},i=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},67359:function(O,_,e){"use strict";e.r(_),e.d(_,{default:function(){return E}});var n=e(5574),i=e.n(n),P=e(49610),h=e(87662),v=e(63713),d=e(67294),f=e(85893);function E(){var p=(0,v.useParams)(),A=(0,v.useSearchParams)(),c=i()(A,2),D=c[0],t=c[1],l=(0,d.useRef)();return(0,d.useEffect)(function(){p.id&&(0,h.K3)({name:p.id}).then(function(s){var m;window.document.title="".concat(s.data.name," - console"),(m=l.current)===null||m===void 0||m.start("/console/host/".concat(s.data.name),{cmd:D.get("cmd"),workDir:D.get("workDir")})}),document.body.style.overflow="hidden"},[]),(0,f.jsx)(P.Z,{ref:l})}},24078:function(){"use strict"},78267:function(O){(function(_,e){O.exports=e()})(self,()=>(()=>{"use strict";var _={};return(()=>{var e=_;Object.defineProperty(e,"__esModule",{value:!0}),e.FitAddon=void 0,e.FitAddon=class{activate(n){this._terminal=n}dispose(){}fit(){const n=this.proposeDimensions();if(!n||!this._terminal||isNaN(n.cols)||isNaN(n.rows))return;const i=this._terminal._core;this._terminal.rows===n.rows&&this._terminal.cols===n.cols||(i._renderService.clear(),this._terminal.resize(n.cols,n.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const n=this._terminal._core,i=n._renderService.dimensions;if(i.css.cell.width===0||i.css.cell.height===0)return;const P=this._terminal.options.scrollback===0?0:n.viewport.scrollBarWidth,h=window.getComputedStyle(this._terminal.element.parentElement),v=parseInt(h.getPropertyValue("height")),d=Math.max(0,parseInt(h.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),E=v-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),p=d-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-P;return{cols:Math.max(2,Math.floor(p/i.css.cell.width)),rows:Math.max(1,Math.floor(E/i.css.cell.height))}}}})(),_})())}}]);
