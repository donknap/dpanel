"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[206],{99922:function(Le,he,e){var pe=e(97857),H=e.n(pe),q=e(15009),t=e.n(q),ge=e(99289),_=e.n(ge),ne=e(5574),k=e.n(ne),l=e(67294),B=e(85265),re=e(42075),ye=e(83622),I=e(49610),J=e(3616),V=e(29463),te=e(90581),be=e(5251),Q=e(36146),Me=e(95591),_e=e(24963),ae=e(85893),Ce=new Q.Uo("components.console"),xe=(0,l.forwardRef)(function(we,M){var le,A,ve,Oe=(0,l.useRef)(),j=(0,l.useRef)(),ee=(0,l.useState)(!1),x=k()(ee,2),oe=x[0],F=x[1],ue=(0,l.useState)(),Y=k()(ue,2),d=Y[0],se=Y[1],Ue=(0,l.useContext)(_e.Z),de=Ue.message,je=(0,l.useRef)();return(0,l.useImperativeHandle)(M,function(){return{show:function(S){return _()(t()().mark(function ce(){var Be;return t()().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:se(S),F(!0),(Be=Oe.current)===null||Be===void 0||Be.resetFields();case 3:case"end":return Fe.stop()}},ce)}))()}}}),(0,l.useEffect)(function(){return setTimeout(function(){var X;d&&((X=j.current)===null||X===void 0||X.start(d.url,{cmd:d&&d.cmd,workDir:d&&d.workDir}))},1e3),function(){var X;(X=j.current)===null||X===void 0||X.close()}},[d,oe]),(0,ae.jsxs)(B.Z,{forceRender:!0,width:J.FK,open:oe,onClose:function(){var S;F(!1),!((S=je.current)===null||S===void 0)&&S.reset&&je.current.reset()},title:Ce.format("drawerTitle",{name:(0,be.fi)((le=d==null?void 0:d.title)!==null&&le!==void 0?le:"","/")}),children:[(0,ae.jsxs)(re.Z,{style:{marginBottom:20},children:[we.showFileExplorer&&(0,ae.jsx)(V.Z,{trigger:(0,ae.jsx)(ye.ZP,{icon:(0,ae.jsx)(Me.Z,{}),type:"primary",children:Q.FD.format("listManageFilePath")}),type:"container",title:(0,be.fi)((A=d==null?void 0:d.title)!==null&&A!==void 0?A:"","/"),name:d&&d.url&&(ve=d.url.split("/").pop())!==null&&ve!==void 0?ve:""}),(0,ae.jsx)(te.Z,{ref:je,onChangeShell:function(S){var ce;if(!d)return!1;(ce=j.current)===null||ce===void 0||ce.close(),se(H()(H()({},d),{cmd:S!=null?S:d==null?void 0:d.cmd})),de.success(Q.FD.format("finish"))},onOpenNewWindow:function(S){return d?(S.workDir=d&&d.workDir?d.workDir:"","".concat(d.url,"?").concat(Object.keys(S).map(function(ce){return"".concat(ce,"=").concat(encodeURIComponent(S[ce]))}).join("&"))):""},onOpenNewWindowFinish:function(){var S;(S=j.current)===null||S===void 0||S.close(),F(!1)},onBatchCommandFinish:function(S){j.current&&j.current.run(S)}})]}),oe&&(0,ae.jsx)(I.Z,{height:"80vh",ref:j})]})});he.Z=xe},29463:function(Le,he,e){e.d(he,{Z:function(){return vn}});var pe=e(97857),H=e.n(pe),q=e(15009),t=e.n(q),ge=e(99289),_=e.n(ge),ne=e(5574),k=e.n(ne),l=e(67294),B=e(82346);function re(r,i){return ye.apply(this,arguments)}function ye(){return ye=_()(t()().mark(function r(i,s){var E;return t()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return E="/dpanel/api/".concat(i,"/explorer/get-path-list"),K.next=3,(0,B.request)(E,{data:s,method:"POST"});case 3:return K.abrupt("return",K.sent);case 4:case"end":return K.stop()}},r)})),ye.apply(this,arguments)}function I(r,i){return J.apply(this,arguments)}function J(){return J=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/export"),{data:s,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),J.apply(this,arguments)}function V(r,i){return te.apply(this,arguments)}function te(){return te=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/import"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),te.apply(this,arguments)}function be(r,i){return Q.apply(this,arguments)}function Q(){return Q=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/delete"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),Q.apply(this,arguments)}function Me(r,i){return _e.apply(this,arguments)}function _e(){return _e=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/unzip"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),_e.apply(this,arguments)}function ae(r,i){return Ce.apply(this,arguments)}function Ce(){return Ce=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/get-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),Ce.apply(this,arguments)}function xe(r,i){return we.apply(this,arguments)}function we(){return we=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/import-file-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),we.apply(this,arguments)}function M(r,i){return le.apply(this,arguments)}function le(){return le=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/mkdir"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),le.apply(this,arguments)}function A(r,i){return ve.apply(this,arguments)}function ve(){return ve=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/chmod"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ve.apply(this,arguments)}function Oe(r,i){return j.apply(this,arguments)}function j(){return j=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/get-user-list"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),j.apply(this,arguments)}function ee(r,i){return x.apply(this,arguments)}function x(){return x=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/get-file-stat"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),x.apply(this,arguments)}function oe(r,i){return F.apply(this,arguments)}function F(){return F=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/attach-volume"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function ue(r){return Y.apply(this,arguments)}function Y(){return Y=_()(t()().mark(function r(i){return t()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/destroy-proxy-container"),{data:{},method:"POST"});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},r)})),Y.apply(this,arguments)}function d(r,i){return se.apply(this,arguments)}function se(){return se=_()(t()().mark(function r(i,s){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,B.request)("/dpanel/api/".concat(i,"/explorer/copy"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),se.apply(this,arguments)}var Ue=e(97269),de=e(5966),je=e(31112),X=e(81366),S=e(86615),ce=e(62370),Be=e(97462),$e=e(11106),Fe=e(24963),Ae=e(5251),We=e(36146),ke=e(27166),a=e(85893),Ee=new We.Uo("components.explorer"),Ve=(0,l.forwardRef)(function(r,i){var s,E,n=(0,l.useContext)(Fe.Z),K=n.notice,T=(0,l.useContext)(je.Z),W=T.currentPath,G=T.refresh,L=T.name,U=T.apiPrefix,f=(0,l.useRef)(),me=(0,l.useState)(!1),$=k()(me,2),O=$[0],h=$[1],u=(0,l.useRef)();return(0,l.useImperativeHandle)(i,function(){return{newFile:function(){var P;h(!0),(P=f.current)===null||P===void 0||P.setFieldValue("type","newFile")},editFile:function(P,y,Pe){return _()(t()().mark(function m(){var fe,Te,D,g,o,w;return t()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return h(!0),(fe=u.current)===null||fe===void 0||fe.loading(),R.prev=2,R.next=5,ae(U,{name:L,file:y}).finally(function(){var z;(z=u.current)===null||z===void 0||z.finish()});case 5:if(w=R.sent,!(w.data.content==""&&Pe!="0")){R.next=10;break}return K.error(Ee.format("editFileMessageNotSupport")),h(!1),R.abrupt("return");case 10:(Te=f.current)===null||Te===void 0||Te.setFieldValue("newValue",w.data.content),(D=f.current)===null||D===void 0||D.setFieldValue("newName",P),(g=f.current)===null||g===void 0||g.setFieldValue("type","editFile"),(o=f.current)===null||o===void 0||o.setFieldValue("fileMode",w.data.fileMode),R.next=19;break;case 16:R.prev=16,R.t0=R.catch(2),h(!1);case 19:return R.abrupt("return");case 20:case"end":return R.stop()}},m,null,[[2,16]])}))()}}}),(0,a.jsxs)(ke.Z,{drawerProps:{width:"50vw",forceRender:!0},onFinish:function(){var p=_()(t()().mark(function P(y){return t()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(y.type!="newDir"){m.next=13;break}return m.prev=1,m.next=4,M(U,{name:L,destPath:"".concat(W,"/").concat((0,Ae.fi)(y.newPath,"/"))});case 4:return G(),h(!1),m.abrupt("return",!0);case 9:m.prev=9,m.t0=m.catch(1);case 11:m.next=23;break;case 13:return m.prev=13,m.next=16,xe(U,{destPath:W,file:y.newName,content:y.newValue,name:L,fileMode:y.fileMode});case 16:return G(),h(!1),m.abrupt("return",!0);case 21:m.prev=21,m.t1=m.catch(13);case 23:return m.abrupt("return",!1);case 24:case"end":return m.stop()}},P,null,[[1,9],[13,21]])}));return function(P){return p.apply(this,arguments)}}(),ref:u,title:Ee.format("editFileTypeEditFile"),open:O,onOpenChange:function(P){if(h(P),!P){var y;(y=f.current)===null||y===void 0||y.resetFields(),r.onFinish&&r.onFinish()}},formRef:f,children:[(0,a.jsx)(S.Z.Group,{name:"type",options:[{label:Ee.format("editFileTypeEditFile"),value:"editFile",disabled:((s=f.current)===null||s===void 0?void 0:s.getFieldValue("type"))!="editFile"},{label:Ee.format("editFileTypeNewFile"),value:"newFile"},{label:Ee.format("editFileTypeNewDir"),value:"newDir"}],disabled:((E=f.current)===null||E===void 0?void 0:E.getFieldValue("type"))=="editFile"}),(0,a.jsx)(ce.Z,{name:"fileMode",hidden:!0}),(0,a.jsx)(Be.Z,{name:["type"],children:function(P){var y=P.type;return y!="newDir"?[(0,a.jsx)(de.Z,{label:Ee.format("editFileNewName"),tooltip:Ee.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(W,"/")},placeholder:Ee.format("editFileNewNameEmpty"),disabled:y=="editFile"},"fileName"),(0,a.jsx)(ce.Z,{label:Ee.format("editFileNewValue"),name:"newValue",children:(0,a.jsx)($e.ZP,{theme:"dark",height:"58vh",onChange:function(m){var fe;(fe=f.current)===null||fe===void 0||fe.setFieldValue("newValue",m)}})},"fileContent")]:(0,a.jsx)(de.Z,{name:"newPath",label:Ee.format("editFileNewPath"),placeholder:Ee.format("editFileNewPathEmpty")})}})]})}),ze=Ve,Se=e(68536),Ze=e(83622),He=e(83062),Ge=e(66309),De=e(98510),Je=e(51042),Qe=e(86548),Ye=e(12119),Xe=e(51947),qe=e(27461),en=e(23430),nn=e(58638),rn=e(82061),tn=e(93162),an=e(88484),Ne=e(37476),on=e(91604),Ke=e(3616),sn=e(4813);function ln(){var r=(0,l.useRef)(),i=(0,l.useContext)(je.Z),s=i.refresh,E=i.name,n=i.apiPrefix,K=i.currentPath,T=new We.Uo("components.explorer");return(0,a.jsx)(Ne.Y,{modalProps:{width:Ke.ob},formRef:r,trigger:(0,a.jsx)(Ze.ZP,{icon:(0,a.jsx)(an.Z,{}),children:T.format("toolbarUploadButton")}),title:T.format("toolbarUploadModalTitle"),onFinish:function(){var W=_()(t()().mark(function G(L){var U,f;return t()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return f=[],L.importFileList&&L.importFileList.map(function(O){f.push({name:O.name,path:O.response.data.path})}),V(n,{fileList:f,name:E,destPath:K}),(U=r.current)===null||U===void 0||U.resetFields(),s(),$.abrupt("return",!0);case 6:case"end":return $.stop()}},G)}));return function(G){return W.apply(this,arguments)}}(),children:(0,a.jsx)(on.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(G){return new Promise(function(L){var U;(0,sn._)({path:(U=G.response.data.path)!==null&&U!==void 0?U:""}).then(function(f){L(!0)})})}}})})}var Ie=e(38345),Re=e(63434),un=e(42075),dn=(0,l.forwardRef)(function(r,i){var s=(0,l.useRef)(),E=(0,l.useContext)(je.Z),n=E.refresh,K=E.name,T=E.apiPrefix,W=(0,l.useState)(!1),G=k()(W,2),L=G[0],U=G[1],f=new We.Uo("components.explorer");(0,l.useImperativeHandle)(i,function(){return{show:function(h){var u;U(!0),h.length==1&&$(me(h[0].modStr)),(u=s.current)===null||u===void 0||u.setFieldValue("fileList",h.map(function(p){return p.path}))}}});function me(O){var h=O.split(""),u=0,p=0,P=0;return h[1]=="r"&&(u+=4),h[2]=="w"&&(u+=2),h[3]=="x"&&(u+=1),h[4]=="r"&&(p+=4),h[5]=="w"&&(p+=2),h[6]=="x"&&(p+=1),h[7]=="r"&&(P+=4),h[8]=="w"&&(P+=2),h[9]=="x"&&(P+=1),"".concat(u).concat(p).concat(P)}function $(O){var h;if((h=s.current)===null||h===void 0||h.setFieldValue("permission",O),O.length>=1){var u;(u=s.current)===null||u===void 0||u.setFieldsValue({ownerRead:Number(O[0])&4,ownerWrite:Number(O[0])&2,ownerExec:Number(O[0])&1})}if(O.length>=2){var p;(p=s.current)===null||p===void 0||p.setFieldsValue({groupRead:Number(O[1])&4,groupWrite:Number(O[1])&2,groupExec:Number(O[1])&1})}if(O.length>=3){var P;(P=s.current)===null||P===void 0||P.setFieldsValue({everyoneRead:Number(O[2])&4,everyoneWrite:Number(O[2])&2,everyoneExec:Number(O[2])&1})}}return(0,a.jsxs)(Ne.Y,{modalProps:{forceRender:!0,width:Ke.ob},title:f.format("toolbarPermissionModalTitle"),layout:"horizontal",open:L,onOpenChange:function(h){if(U(h),!h){var u;(u=s.current)===null||u===void 0||u.resetFields()}},formRef:s,onValuesChange:function(h,u){if(h.permission)$(h.permission);else{var p=["-",u.ownerRead?"r":"-",u.ownerWrite?"w":"-",u.ownerExec?"x":"-",u.groupRead?"r":"-",u.groupWrite?"w":"-",u.groupExec?"x":"-",u.everyoneRead?"r":"-",u.everyoneWrite?"w":"-",u.everyoneExec?"x":"-"];$(me(p.join("")))}},onFinish:function(){var O=_()(t()().mark(function h(u){var p,P,y;return t()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,A(T,{name:K,fileList:u.fileList,mod:(p=u.permission)!==null&&p!==void 0?p:"600",hasChildren:(P=u.hasChildren)!==null&&P!==void 0?P:!0,user:u.user});case 2:return y=m.sent,n(),m.abrupt("return",!0);case 5:case"end":return m.stop()}},h)}));return function(h){return O.apply(this,arguments)}}(),children:[(0,a.jsxs)(Ie.Z,{ghost:!0,split:"vertical",bordered:!0,children:[(0,a.jsx)(ce.Z,{name:"fileList",hidden:!0}),(0,a.jsxs)(Ie.Z,{title:f.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionRead"),name:"ownerRead"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,a.jsxs)(Ie.Z,{title:f.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionRead"),name:"groupRead"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,a.jsxs)(Ie.Z,{title:f.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,a.jsxs)(Ie.Z,{bordered:!0,style:{marginTop:10},children:[(0,a.jsx)(de.Z,{label:f.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},labelCol:{span:2}}),(0,a.jsxs)(un.Z.Compact,{children:[(0,a.jsx)(de.Z,{width:"sm",placeholder:f.format("toolbarPermissionOwnerEmpty"),label:f.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,a.jsx)(de.Z,{width:"sm",placeholder:f.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,a.jsx)(Re.Z,{label:f.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})]})}),cn=dn,En=null,N=new We.Uo("components.explorer"),mn=(0,l.forwardRef)(function(r,i){(0,l.useImperativeHandle)(i,function(){return{close:function(){$([]),m("")}}});var s=r.type=="host"?"common":"app",E=(0,l.useContext)(Fe.Z),n=E.message,K=(0,l.useRef)(),T=(0,l.useRef)(),W=(0,l.useRef)(),G=(0,l.useRef)(),L=(0,l.useRef)(),U=(0,B.useSearchParams)(),f=k()(U,2),me=f[0],$=f[1],O=(0,l.useState)(),h=k()(O,2),u=h[0],p=h[1],P=(0,l.useState)(""),y=k()(P,2),Pe=y[0],m=y[1];(0,l.useEffect)(function(){var D;n.info(N.format("commonMessageCreateExplorerPlugin")),m((D=r.workDir)!==null&&D!==void 0?D:"")},[]);function fe(D,g){return Te.apply(this,arguments)}function Te(){return Te=_()(t()().mark(function D(g,o){var w,Z,R;return t()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:(w=K.current)===null||w===void 0||w.addHistory(g,o),m(o),!((Z=W.current)===null||Z===void 0)&&Z.reloadAndRest&&((R=W.current)===null||R===void 0||R.reloadAndRest()),o=="/"?$([]):(me.set("path",o),$(me));case 4:case"end":return C.stop()}},D)})),Te.apply(this,arguments)}return r&&(0,a.jsxs)(je.Z.Provider,{value:{name:r.name,apiPrefix:s,currentPath:Pe,showPath:fe,redirectPath:function(g){var o;if(m(g),W.current&&(o=W.current)!==null&&o!==void 0&&o.reloadAndRest){var w;(w=W.current)===null||w===void 0||w.reloadAndRest()}g=="/"?$([]):(me.set("path",g),$(me))},refresh:function(){var g;if(W&&typeof((g=W.current)===null||g===void 0?void 0:g.reloadAndRest)=="function"){var o;(o=W.current)===null||o===void 0||o.reloadAndRest()}}},children:[(0,a.jsx)(De.C,{sticky:!1,quickToolbarAffix:{offsetTop:10,target:function(){return document.querySelector(".file-explorer .ant-drawer-body")}},quickToolbarRender:function(g){var o=g.selectedRows,w=o.map(function(Z){return Z.path});return[r.onConsole&&(0,a.jsx)(Ze.ZP,{onClick:function(){r.onConsole&&r.onConsole(Pe)},children:"Console"},"fileConsole"),(0,a.jsx)(ln,{},"upload"),(0,a.jsx)(Ze.ZP,{icon:(0,a.jsx)(Je.Z,{}),onClick:function(){T.current&&T.current.newFile()},type:"primary",children:N.format("toolbarNewButton")},"newfile")]},contextMenu:function(g){var o=g.selectedRow,w=g.selectedRows,Z=g.isMultiple,R=g.loading,z=g.finish;return{items:[{key:"edit",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(Qe.Z,{}),disabled:Z()||o&&o.isDir||w.length==0},action:_()(t()().mark(function C(){var c,v;return t()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,ee(s,{name:r.name,path:o.path});case 2:c=ie.sent,c.data.info.isDir?fe(o.name,c.data.info.target):(v=T.current)===null||v===void 0||v.editFile(c.data.info.name,c.data.info.target,o.size);case 4:case"end":return ie.stop()}},C)})),children:We.FD.format("listManageEdit")})},{key:"permission",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(Ye.Z,{}),disabled:w.length==0},action:_()(t()().mark(function C(){var c;return t()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:(c=G.current)===null||c===void 0||c.show(w);case 1:case"end":return b.stop()}},C)})),children:N.format("toolbarPermissionButton")})},{key:"rename",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(Xe.Z,{}),disabled:w.length!=1},action:_()(t()().mark(function C(){var c;return t()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return R(),b.abrupt("return",d(s,{name:r.name,sourceFile:o.path,targetFile:"./".concat((c=L.current)===null||c===void 0?void 0:c.getFieldValue("targetFile")),isMove:!0}).finally(function(){z(!0)}));case 2:case"end":return b.stop()}},C)})),confirmProps:{onOpenChange:function(c,v){var b;(b=L.current)===null||b===void 0||b.resetFields(),c&&z()},getPopupContainer:function(c){return document.querySelector(".file-explorer .ant-pro-table")},zIndex:9999,description:(0,a.jsx)(Ue.A,{submitter:!1,style:{width:300,paddingTop:10,paddingRight:10},formRef:L,children:(0,a.jsx)(de.Z,{name:"targetFile"})})},children:N.format("toolbarRenameButton")})},{key:"unzip",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(qe.Z,{}),disabled:w.length==0},action:_()(t()().mark(function C(){return t()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return R(),v.abrupt("return",Me(s,{name:r.name,file:w.map(function(b){return b.path}),path:Pe}).finally(function(){z(!0)}));case 2:case"end":return v.stop()}},C)})),children:N.format("toolbarUnzipButton")})},{type:"divider"},{key:"download",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(en.Z,{}),disabled:w.length==0},action:_()(t()().mark(function C(){return t()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",I(s,{name:r.name,fileList:w.map(function(b){return b.path})}));case 1:case"end":return v.stop()}},C)})),onSuccess:function(c){var v=new Blob([c],{type:"application/zip"});(0,tn.saveAs)(v,"export.zip")},children:N.format("toolbarDownloadButton")})},r.type=="container"||r.type=="volume"?{key:"export",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{icon:(0,a.jsx)(nn.Z,{}),disabled:w.length==0},action:_()(t()().mark(function C(){return t()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return R(),v.abrupt("return",I(s,{name:r.name,fileList:w.map(function(b){return b.path}),enableExportToPath:!0}).finally(function(){z(!0)}));case 2:case"end":return v.stop()}},C)})),onSuccess:function(){},children:N.format("toolbarExportButton")})}:null,{type:"divider"},{key:"delete",label:(0,a.jsx)(De.C.ContextMenuItem,{buttonProps:{danger:!0,icon:(0,a.jsx)(rn.Z,{})},confirmProps:{showCommonConfirm:!0},action:_()(t()().mark(function C(){return t()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return R(),v.abrupt("return",be(s,{name:r.name,fileList:w.map(function(b){return b.path})}).finally(function(){z(!0)}));case 2:case"end":return v.stop()}},C)})),children:N.format("toolbarDeleteButton")},"deleteBatch")}]}},headerTitle:(0,a.jsx)(X.Z,{ref:K}),actionRef:W,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:_()(t()().mark(function D(){var g,o,w,Z,R;return t()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,re(s,{name:r.name,path:Pe});case 2:if(o=C.sent,Pe==""&&o.data.currentPath!=""&&m(o.data.currentPath),w=[],(g=K.current)===null||g===void 0||g.initHistory(o.data.currentPath.split("/").filter(function(c){return c!=""}).map(function(c){return w.push(c),{title:c,path:"/".concat(w.join("/"))}}),o.data.rootDirs),Z=u,Z){C.next=13;break}return C.next=10,Oe(s,{name:r.name});case 10:R=C.sent,p(R.data),Z=R.data;case 13:return C.abrupt("return",{data:o.data.list.map(function(c){if(Z){var v,b;c.group=(v=(b=Z.group.find(function(ie){return ie.gid==c.group}))===null||b===void 0?void 0:b.name)!==null&&v!==void 0?v:c.group}return c}),success:!0,total:o.data.list.length});case 14:case"end":return C.stop()}},D)})),columns:[{title:N.format("listName"),dataIndex:"name",key:"name",render:function(z,o,w,Z,R){var z;return o.isDir?z=(0,a.jsx)(Se.Z,{isDir:!0,onClick:function(){return fe(o.name,o.path)},showName:o.name}):o.isSymlink?z=(0,a.jsx)(Se.Z,{isLink:!0,showName:"".concat(o.name," -> ").concat(o.linkName),onClick:_()(t()().mark(function C(){var c,v;return t()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,ee(s,{name:r.name,path:o.path});case 2:c=ie.sent,c.data.info.isDir?fe(o.name,c.data.info.target):(v=T.current)===null||v===void 0||v.editFile(c.data.info.name,c.data.info.target,o.size);case 4:case"end":return ie.stop()}},C)}))}):z=(0,a.jsx)(Se.Z,{showName:o.name,onClick:function(){var c;(c=T.current)===null||c===void 0||c.editFile(o.name,o.path,o.size)}}),z}},{title:N.format("listStatus"),key:"status",width:110,render:function(g,o,w,Z,R){return o.change>-1&&(0,a.jsx)(He.Z,{title:N.format("listStatusTipOption.".concat(o.change)),children:(0,a.jsx)(Ge.Z,{color:N.format("listStatusColorOption.".concat(o.change)),children:N.format("listStatusOption.".concat(o.change))})})}},{title:N.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:N.format("listUser"),dataIndex:"user"},{title:N.format("listGroup"),dataIndex:"group"},{title:N.format("listSize"),dataIndex:"size",key:"size",render:function(g,o,w,Z,R){return(0,Ae.FI)(o.size)}},{title:N.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(g,o){return new Date(g.modTime).getTime()-new Date(o.modTime).getTime()},render:function(g,o,w,Z,R){return(0,Ae.NF)(o.modTime)}}],cardProps:{ghost:!0}},"explorer-list"),(0,a.jsx)(ze,{onFinish:function(){var g;!((g=W.current)===null||g===void 0)&&g.reset&&W.current.reset()},ref:T}),(0,a.jsx)(cn,{ref:G},"chmod")]})}),fn=mn,hn=e(85265),pn=e(99922),_n=(0,l.forwardRef)(function(r,i){var s,E=(0,l.useState)(!1),n=k()(E,2),K=n[0],T=n[1],W=(0,l.useState)(),G=k()(W,2),L=G[0],U=G[1],f=(0,l.useRef)(),me=new We.Uo("components.explorer"),$=(0,l.useContext)(Fe.Z),O=$.loading,h=(0,l.useRef)();return(0,l.useImperativeHandle)(i,function(){return{showContainer:function(p,P){U({name:(0,Ae.fi)(p,"/"),type:"container",workDir:P!=null?P:void 0}),T(!0)},showHost:function(p){U({name:p,type:"host"}),T(!0)},showVolume:function(p){return _()(t()().mark(function P(){var y;return t()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return O.show(),m.next=3,oe("app",{name:p}).finally(function(){O.destroy()});case 3:y=m.sent,U({name:y.data.containerName,type:"container",workDir:y.data.path}),T(!0);case 6:case"end":return m.stop()}},P)}))()}}}),(0,a.jsxs)(a.Fragment,{children:[r.trigger?l.cloneElement(r.trigger,{onClick:function(){r.name&&r.type&&(U(r),T(!0))}}):null,(0,a.jsxs)(hn.Z,{destroyOnHidden:!0,width:Ke.R_,title:me.format("drawerTitle",{name:(s=r.title)!==null&&s!==void 0?s:L==null?void 0:L.name}),onClose:_()(t()().mark(function u(){var p;return t()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(O.show(),T(!1),(p=f.current)===null||p===void 0||p.close(),U(void 0),!r.onCloseDestroy){y.next=7;break}return y.next=7,ue("app");case 7:O.destroy();case 8:case"end":return y.stop()}},u)})),rootClassName:"file-explorer",open:K,children:[r.showConsole&&(0,a.jsx)(pn.Z,{showFileExplorer:!1,ref:h}),K&&L&&(0,a.jsx)(fn,H()(H()({ref:f},L),{},{onConsole:r.showConsole?function(u){var p;(p=h.current)===null||p===void 0||p.show({url:"/console/container/".concat(L.name),title:L.name,workDir:u})}:void 0}))]})]})}),vn=_n},90581:function(Le,he,e){var pe=e(15009),H=e.n(pe),q=e(99289),t=e.n(q),ge=e(5574),_=e.n(ge),ne=e(3616),k=e(97269),l=e(38345),B=e(64317),re=e(37476),ye=e(62370),I=e(97462),J=e(11106),V=e(42075),te=e(83622),be=e(83062),Q=e(67294),Me=e(1883),_e=e(33160),ae=e(58638),Ce=e(82346),xe=e(75520),we=e(36146),M=e(85893),le=(0,Q.forwardRef)(function(A,ve){var Oe=(0,Q.useState)(!1),j=_()(Oe,2),ee=j[0],x=j[1],oe=(0,Q.useRef)(),F=new we.Uo("components.console"),ue=(0,Q.useRef)();return(0,Q.useImperativeHandle)(ve,function(){return{reset:function(){var d;(d=ue.current)===null||d===void 0||d.resetFields()}}}),(0,M.jsx)(k.A,{layout:"inline",submitter:!1,formRef:ue,children:(0,M.jsx)(l.Z,{ghost:!0,children:(0,M.jsxs)(V.Z,{children:[(0,M.jsx)(B.Z,{width:"sm",name:"entryCmd",placeholder:F.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(d){A.onChangeShell&&A.onChangeShell(d)}}),(0,M.jsx)(re.Y,{modalProps:{width:ne.ob,height:ne.Ed},title:F.format("toolbarBatchCommandTitle"),name:"batchCommand",open:ee,trigger:(0,M.jsx)(te.ZP,{icon:(0,M.jsx)(Me.Z,{}),children:F.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:oe,isKeyPressSubmit:!0,onFinish:function(){var Y=t()(H()().mark(function d(se){return H()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:A.onBatchCommandFinish&&A.onBatchCommandFinish(se.shell.split(`
`)),x(!1);case 2:case"end":return de.stop()}},d)}));return function(d){return Y.apply(this,arguments)}}(),onOpenChange:function(d){x(d),d&&oe.current&&oe.current.resetFields()},children:(0,M.jsx)(ye.Z,{name:"shell",children:(0,M.jsx)(J.ZP,{theme:"dark",height:ne.Ed})})}),(0,M.jsx)(te.ZP,{onClick:function(){A.onChangeShell&&A.onChangeShell()},icon:(0,M.jsx)(_e.Z,{}),type:"primary",children:we.FD.format("listManageRefresh")}),(0,M.jsx)(I.Z,{name:["entryCmd"],children:function(d){var se=d.entryCmd;return(!se||se=="")&&(se="/bin/sh"),A.onOpenNewWindow&&(0,M.jsx)(Ce.Link,{onClick:function(){A.onOpenNewWindowFinish&&A.onOpenNewWindowFinish()},target:"_blank",to:A.onOpenNewWindow({cmd:se}),children:(0,M.jsx)(be.Z,{title:F.format("toolbarOpenInNewWindowTip"),children:(0,M.jsx)(te.ZP,{type:"dashed",icon:(0,M.jsx)(ae.Z,{})})})})}}),(0,M.jsx)(xe.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})});he.Z=le},49610:function(Le,he,e){var pe=e(5574),H=e.n(pe),q=e(67294),t=e(52626),ge=e(78267),_=e.n(ge),ne=e(12323),k=e(87662),l=e(4244),B=e.n(l),re=e(24078),ye=e(85893),I,J,V,te,be=(0,q.forwardRef)(function(Q,Me){var _e,ae=(0,q.useState)(),Ce=H()(ae,2),xe=Ce[0],we=Ce[1],M=(0,q.useState)(""),le=H()(M,2),A=le[0],ve=le[1];(0,q.useImperativeHandle)(Me,function(){return{start:function(ee,x){Oe(),J.fit(),x.width=I.cols,x.height=I.rows;var oe=x?Object.keys(x).filter(function(F){return x&&x[F]}).map(function(F){if(x&&x[F])return"".concat(F,"=").concat(x[F])}):[];V=new WebSocket((0,t.R)(ee+"?"+oe.join("&"))),V.addEventListener("message",function(F){var ue=JSON.parse(F.data),Y=ue.type;if(Y==ee&&(I.write(ue.data),ue.data.indexOf("exec failed")!=-1)){Oe();return}}),te=I.onData(function(F){var ue={content:{command:F},type:ee};V&&V.send(JSON.stringify(ue))}),ve(ee),we(x)},close:function(){Oe()},fit:function(){return J.fit(),{width:I.cols,height:I.rows}},run:function(ee){xe&&ee&&ee.forEach(function(x){var oe={content:{command:x+`
`},type:A};V&&V.send(JSON.stringify(oe))})}}}),(0,q.useEffect)(function(){return I=new l.Terminal(ne.X),J=new ge.FitAddon,I.loadAddon(J),I.open(document.getElementById("terminal-container-console")),J.fit(),(0,k.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(j){j.data&&j.data.fontSize&&Object.assign(I.options,j.data)}),function(){Oe()}},[]),(0,q.useEffect)(function(){window.addEventListener("resize",function(){J.fit();var j={size:{width:I.cols,height:I.rows},type:A};A&&V&&V.send(JSON.stringify(j))})},[A]);function Oe(){te&&(I.reset(),J.fit(),I.focus(),te.dispose()),V&&(V.close(),V=null)}return(0,ye.jsx)("div",{style:{height:(_e=Q.height)!==null&&_e!==void 0?_e:"100vh"},id:"terminal-container-console"})});he.Z=be},12323:function(Le,he,e){e.d(he,{X:function(){return pe},n:function(){return H}});var pe={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},H=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},4813:function(Le,he,e){e.d(he,{_:function(){return _}});var pe=e(15009),H=e.n(pe),q=e(99289),t=e.n(q),ge=e(82346);function _(k){return ne.apply(this,arguments)}function ne(){return ne=t()(H()().mark(function k(l){return H()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,(0,ge.request)("/dpanel/api/common/attach/delete",{method:"POST",data:l});case 2:return re.abrupt("return",re.sent);case 3:case"end":return re.stop()}},k)})),ne.apply(this,arguments)}}}]);
