"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7523],{75544:function(Q,R,e){var C=e(5574),n=e.n(C),I=e(12323),s=e(78267),d=e.n(s),i=e(75458),j=e.n(i),p=e(67294),c=e(4244),g=e.n(c),m=e(24078),_=e(85893),D,v,a,T=(0,p.forwardRef)(function(r,o){var u,P=(0,p.useState)(!0),k=n()(P,2),ne=k[0],X=k[1];return(0,p.useEffect)(function(){return D=new c.Terminal(I.X),v=new i.SearchAddon,a=new s.FitAddon,window.addEventListener("resize",function(){r.showInModal||a.fit()}),r.style&&r.style.fontSize&&(D.options.fontSize=r.style.fontSize),D.loadAddon(a),D.loadAddon(v),D.open(document.getElementById(r.id?r.id:"terminal-container")),r.showInModal||a.fit(),function(){D.reset(),X(!0)}},[]),(0,p.useImperativeHandle)(o,function(){return{write:function(E){ne&&(a.fit(),X(!1)),D.write(E)},clear:function(){D.clear()},getTerminal:function(){return D},findNext:function(E){v.findNext(E)},findPrev:function(E){v.findPrevious(E)},fit:function(){a.fit()},onData:function(E){return D.onData(E)}}}),(0,_.jsx)("div",{id:r.id?r.id:"terminal-container",style:{width:r.width?r.width:"100%",height:r.height?r.height:"500px",marginTop:(u=r.style)===null||u===void 0?void 0:u.marginTop}})});R.Z=T},94359:function(Q,R,e){e.d(R,{Z:function(){return T}});var C=e(5574),n=e.n(C),I=e(3089),s=e(98165),d=e(18429),i=e(8751),j=e(66212),p=e(14313),c=e(30159),g=e(87740),m=e(50888),_=e(66309),D=e(83062),v=e(36146),a=e(85893);function T(r){var o,u,P=new v.Uo("components.containerStatus"),k=r.status.split("."),ne=n()(k,2),X=ne[0],h=ne[1],E="";E=P.format(r.status,(o=r.statusValue)!==null&&o!==void 0?o:{});var f=(0,a.jsx)(a.Fragment,{});return h=="0"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(I.Z,{}),color:"default",children:E})),h=="10"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(s.Z,{spin:!0}),color:"processing",children:E})),h=="20"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"error",children:E})),h=="30"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(i.Z,{}),color:"success",children:E})),h=="new"&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(j.Z,{}),children:E})),(h=="running"||h=="healthy"||h=="active"||h=="ready")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(p.Z,{}),color:"success",children:E})),(h=="paused"||h=="pause"||h=="rollback_paused")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(c.Z,{}),color:"warning",children:E})),(h=="waiting"||h=="starting"||h=="accepted")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(g.Z,{}),children:E})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(m.Z,{}),color:"processing",children:E})),(h=="error"||h=="down"||h=="failed")&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"error",children:E})),["complete","completed","rollback_completed"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(i.Z,{}),color:"success",children:E})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(h)&&(f=(0,a.jsx)(_.Z,{icon:(0,a.jsx)(d.Z,{}),color:"warning",children:E})),(0,a.jsx)(D.Z,{placement:"top",title:(u=r.tip)!==null&&u!==void 0?u:"",children:f})}},27166:function(Q,R,e){var C=e(97857),n=e.n(C),I=e(5574),s=e.n(I),d=e(13769),i=e.n(d),j=e(184),p=e(74330),c=e(67294),g=e(85893),m=["requestLoading"],_=(0,c.forwardRef)(function(D,v){var a=D.requestLoading,T=i()(D,m),r=(0,c.useState)(!1),o=s()(r,2),u=o[0],P=o[1];return(0,c.useImperativeHandle)(v,function(){return{loading:function(){P(!0)},finish:function(){P(!1)}}}),(0,g.jsx)(j.a,n()(n()({},T),{},{children:(0,g.jsx)(p.Z,{spinning:u!=null?u:D.requestLoading,size:"default",style:{marginTop:"30%"},children:D.children})}))});R.Z=_},81366:function(Q,R,e){var C=e(97857),n=e.n(C),I=e(19632),s=e.n(I),d=e(5574),i=e.n(d),j=e(27254),p=e(42075),c=e(85418),g=e(25593),m=e(83622),_=e(67294),D=e(31112),v=e(85893),a={title:"/",path:"/"},T=(0,_.forwardRef)(function(r,o){var u=(0,_.useContext)(D.Z),P=u.showPath,k=u.redirectPath,ne=(0,_.useState)([a]),X=i()(ne,2),h=X[0],E=X[1];(0,_.useImperativeHandle)(o,function(){return{addHistory:function(W,t){console.log(W,t),t=="/"?E([a]):E([].concat(s()(h),[{title:W,path:t}]))},initHistory:function(W,t){E([n()(n()({},a),{},{children:t})].concat(s()(W)))}}});var f=function(W){P?P(h[W].title,h[W].path):r.showPath&&r.showPath(h[W].title,h[W].path);var t=h.filter(function(ie,ce){return ce<=W});E(s()(t))};return(0,v.jsxs)(p.Z,{children:[(0,v.jsx)(p.Z.Compact,{children:h.map(function(y,W){return y.children?(0,v.jsxs)(c.Z.Button,{menu:{items:y.children.map(function(t,ie){return{key:ie,label:(0,v.jsx)(g.Z.Link,{onClick:function(){k(t)},children:t},ie)}})},type:"dashed",onClick:function(ie){f(W)},children:[(0,v.jsx)(j.Z,{})," ",y.title]},W):(0,v.jsx)(m.ZP,{icon:(0,v.jsx)(j.Z,{}),type:"dashed",onClick:function(){f(W)},children:y.title},W)})}),h.length>=2&&(0,v.jsx)(g.Z.Text,{copyable:{text:h[h.length-1].path}})]})});R.Z=T},31112:function(Q,R,e){var C=e(67294),n=(0,C.createContext)({});R.Z=n},68536:function(Q,R,e){e.d(R,{Z:function(){return m}});var C=e(24963),n=e(36146),I=e(93613),s=e(36693),d=e(2741),i=e(25593),j=e(42075),p=e(67294),c=e(85893),g=0;function m(_){var D=(0,p.useContext)(C.Z),v=D.message,a=new n.Uo("components.explorer");return _.isDir?(0,c.jsx)(i.Z.Link,{onClick:function(){_.onClick&&_.onClick()},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(I.Z,{}),_.showName]})}):_.isLink?(0,c.jsx)(i.Z.Link,{onClick:function(){_.onClick&&_.onClick()},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(s.Z,{}),_.showName]})}):(0,c.jsx)(i.Z.Text,{onClick:function(){if(g++,g==2){g=0,_.onClick&&_.onClick();return}setTimeout(function(){g==1&&v.info(a.format("fileNameMessageViewDetail")),g=0},400)},style:{cursor:"pointer"},children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(d.Z,{}),_.showName]})})}},80271:function(Q,R,e){var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(5574),i=e.n(d),j=e(184),p=e(9773),c=e(83062),g=e(67294),m=e(68536),_=e(5251),D=e(81366),v=e(3616),a=e(36146),T=e(73813),r=e(85893),o=(0,g.forwardRef)(function(u,P){(0,g.useImperativeHandle)(P,function(){return{show:function(){}}});var k=(0,g.useState)(""),ne=i()(k,2),X=ne[0],h=ne[1],E=(0,g.useState)(!1),f=i()(E,2),y=f[0],W=f[1],t=(0,g.useRef)(),ie=(0,g.useRef)(),ce=function(J,S){var H,ge,fe;h(S),(H=ie.current)===null||H===void 0||H.addHistory(J,S),!((ge=t.current)===null||ge===void 0)&&ge.reloadAndRest&&((fe=t.current)===null||fe===void 0||fe.reloadAndRest())},re=new a.Uo("components.explorer"),me=new a.Uo("image");return(0,r.jsx)(j.a,{drawerProps:{width:v.R_,destroyOnHidden:!0},open:y,submitter:!1,title:me.format("fileTitle"),onOpenChange:function(J){W(J),h(J?"/":"")},trigger:(0,r.jsx)(c.Z,{title:me.format("fileTitle"),children:u.trigger}),children:(0,r.jsx)(p.Z,{headerTitle:(0,r.jsx)(D.Z,{ref:ie,showPath:ce}),scroll:{x:"max-content"},search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},actionRef:t,request:s()(n()().mark(function Y(){var J;return n()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(X!=""){H.next=2;break}return H.abrupt("return",{data:[],total:0,success:!0});case 2:return H.next=4,(0,T.cD)({md5:u.imageId,path:X});case 4:return J=H.sent,H.abrupt("return",{data:J.data.info,total:J.data.info.length,success:!0});case 6:case"end":return H.stop()}},Y)})),columns:[{title:re.format("listName"),dataIndex:"showName",key:"name",render:function(ve,S,H,ge,fe){var ve,q=(0,_.fi)(S.name.replace(X,""),"/");return S.isDir?ve=(0,r.jsx)(m.Z,{isDir:!0,onClick:function(){return ce(q,S.path)},showName:q}):S.isSymlink?ve=(0,r.jsx)(m.Z,{isLink:!0,showName:q}):ve=(0,r.jsx)(m.Z,{showName:q}),ve}},{title:re.format("listModStr"),dataIndex:"modStr",key:"modStr"},{title:re.format("listUser"),dataIndex:"user"},{title:re.format("listGroup"),dataIndex:"group"},{title:re.format("listSize"),dataIndex:"size",key:"size",render:function(J,S,H,ge,fe){return(0,_.FI)(S.size)}},{title:re.format("listModTime"),dataIndex:"modTime",key:"modTime",render:function(J,S,H,ge,fe){return(0,_.NF)(S.modTime)},sorter:function(J,S){return new Date(J.modTime).getTime()-new Date(S.modTime).getTime()}}],cardProps:{ghost:!0}},"".concat(u.imageId))})});R.Z=o},2205:function(Q,R,e){e.d(R,{Z:function(){return g}});var C=e(97857),n=e.n(C),I=e(5574),s=e.n(I),d=e(75870),i=e(36146),j=e(34041),p=e(67294),c=e(85893);function g(m){var _=(0,p.useState)([]),D=s()(_,2),v=D[0],a=D[1],T=new i.Uo("components.selectRegistry");(0,p.useEffect)(function(){(0,d.Ot)().then(function(o){o&&a(o.data.list)})},[]);var r={};return m.multiple&&(r.mode="multiple"),m.top&&(r.placement="topLeft"),(0,c.jsx)(j.Z,n()({popupMatchSelectWidth:!m.width,style:m.width?{width:m.width}:{},onChange:function(u){if(Array.isArray(u)){var P=u.map(function(k){return v[k]});m.onChangeList&&m.onChangeList(P)}else m.onChange&&m.onChange(v[u])},placeholder:T.format("nameEmpty"),options:v.map(function(o,u){return{value:u,label:o.title+"("+o.serverAddress+")"}}),allowClear:!0},r))}},78451:function(Q,R,e){e.d(R,{Z:function(){return I}});var C=e(67294),n=e(85893);function I(s){var d;return(0,n.jsx)("span",{style:{width:s.width?s.width:"auto",wordBreak:"break-word"},children:(d=s.content)!==null&&d!==void 0?d:s.children})}},51100:function(Q,R,e){e.d(R,{Z:function(){return d}});var C=e(4813),n=e(91604),I=e(1677),s=e(85893);function d(i){return i.showDragger?(0,s.jsx)(n.Z,{max:i.max?i.max:1,title:i.title,label:i.label,required:i.required,rules:[{required:i.required}],fieldProps:{multiple:!!(i.max&&i.max>1),name:"file",accept:i.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(p){return new Promise(function(c){var g;(0,C._)({path:(g=p.response.data.path)!==null&&g!==void 0?g:""}).then(function(m){c(!0)})})},onChange:function(p){p.file.status=="done"&&i.onFinish&&i.onFinish(p.fileList)}},name:i.name}):(0,s.jsx)(I.Z,{max:i.max?i.max:1,title:i.title,label:i.label,required:i.required,rules:[{required:i.required}],fieldProps:{multiple:!!(i.max&&i.max>1),name:"file",accept:i.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(p){return new Promise(function(c){var g;(0,C._)({path:(g=p.response.data.path)!==null&&g!==void 0?g:""}).then(function(m){c(!0)})})},onChange:function(p){p.file.status=="done"&&i.onFinish&&i.onFinish(p.fileList)}},name:i.name})}},12323:function(Q,R,e){e.d(R,{X:function(){return C},n:function(){return n}});var C={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},n=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},65913:function(Q,R,e){var C=e(5574),n=e.n(C),I=e(74330),s=e(67294),d=e(85893),i=(0,s.forwardRef)(function(j,p){(0,s.useImperativeHandle)(p,function(){return{show:function(){_(!0)},destroy:function(){_(!1)}}});var c=(0,s.useState)(!1),g=n()(c,2),m=g[0],_=g[1];return(0,d.jsx)(I.Z,{spinning:m,size:"default",children:j.children})});R.Z=i},99430:function(Q,R,e){e.r(R),e.d(R,{default:function(){return we}});var C=e(15009),n=e.n(C),I=e(97857),s=e.n(I),d=e(99289),i=e.n(d),j=e(74453),p=e(25593),c=e(42075),g=e(96074),m=e(83062),_=e(97841),D=e(94359),v=e(86548),a=e(87740),T=e(82061),r=e(80821),o=e(67294),u=e(5574),P=e.n(u),k=e(38345),ne=e(82346),X=e(75544),h=e(3616),E=e(36146),f=e(85265),y=e(74330),W=e(38703),t=e(85893),ie=(0,o.forwardRef)(function(F,he){var b=(0,ne.useModel)("subscriber"),ee=(0,o.useRef)(),te=(0,o.useState)(!1),B=P()(te,2),O=B[0],N=B[1],se=(0,o.useState)(""),$=P()(se,2),U=$[0],Z=$[1],V=(0,o.useState)(0),A=P()(V,2),l=A[0],M=A[1];return(0,o.useImperativeHandle)(he,function(){return{start:function(){for(var w=arguments.length,z=new Array(w),K=0;K<w;K++)z[K]=arguments[K];var _e=z.join(":");N(!0),M(0),Z(_e),b.addDataHandler("image:"+_e,function(L){var le;if(L.data.includes("Step")){var ae=Array.from(L.data.matchAll(/Step\s+(\d+)\/(\d+)/g));if(ae.length>0){var de=ae[ae.length-1],pe=parseInt(de[1],10),oe=parseInt(de[2],10);if(oe>0&&pe>=1&&pe<=oe){var Ee=pe/oe*100;M(Math.round(Ee))}}}(le=ee.current)===null||le===void 0||le.write(L.data)})},close:function(){var w;(w=ee.current)===null||w===void 0||w.clear(),N(!1)},show:function(w){N(!0),setTimeout(function(){var z,K;(z=ee.current)===null||z===void 0||z.clear(),(K=ee.current)===null||K===void 0||K.write(w)},500)}}}),(0,t.jsx)(f.Z,{width:h.ob,destroyOnHidden:!0,title:E.FD.format("listLog"),afterOpenChange:function(w){if(w){var z,K;(z=ee.current)===null||z===void 0||z.clear(),(K=ee.current)===null||K===void 0||K.fit()}},onClose:function(){b.progress.close("image:"+U),N(!1),M(0),Z(""),F.onFinish&&F.onFinish()},open:O,children:(0,t.jsx)(k.Z,{ghost:!0,children:(0,t.jsxs)(y.Z,{spinning:l==0,children:[(0,t.jsx)(W.Z,{strokeLinecap:"butt",percent:l,size:["100%",10],percentPosition:{align:"center",type:"inner"},format:function(){return null}}),(0,t.jsx)(X.Z,{style:{fontSize:12},height:"85vh",ref:ee})]})})})}),ce=ie,re=e(19632),me=e.n(re),Y=e(91058),J=e(11106),S=e(62370),H=e(12491);function ge(F){var he=new E.Uo("image");return(0,t.jsx)(S.Z,{shouldUpdate:!0,children:function(ee){var te=ee.getFieldValue,B=ee.setFieldValue;return[(0,t.jsx)(S.Z,{name:F.name,hidden:!0},"input"),(0,t.jsx)(H.Z,{title:he.format("formBuildDockerfileContent"),onImport:function(N){return B(F.name,N),!0},onLoad:function(N){if(N.indexOf("FROM ")<0)throw new Error(E.FD.format("commonFileIncorrectFormat",{name:"Dockerfile"}));return!0}},"importFile"),(0,t.jsx)(J.ZP,{value:te("buildDockerfileContent"),onChange:function(N){B(F.name,N)},height:"600px",theme:"dark",style:{marginBottom:"20px"}},"codeMirror")]}})}var fe=e(51100),ve=e(75870),q=e(5966),je=e(24739),Ce=e(64317),ye=e(86615),Ie=e(97462),Te=e(90672),Ue=e(83622),Ae=e(27166),Le=e(22390),We=e(73813),Be=e(68297),xe=e(24963),Ze=(0,o.forwardRef)(function(F,he){var b=new E.Uo("image"),ee=(0,o.useContext)(xe.Z),te=ee.message,B=(0,o.useRef)(),O=(0,o.useRef)(),N=(0,o.useState)(!1),se=P()(N,2),$=se[0],U=se[1],Z=(0,o.useRef)();return(0,o.useImperativeHandle)(he,function(){return{show:function(A){return i()(n()().mark(function l(){var M,G,w,z,K,_e,L,le,ae,de,pe,oe,Ee,x,ue,Re,Pe,De,be;return n()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return U(!0),(M=Z.current)===null||M===void 0||M.loading(),Oe.next=4,(0,_.Xr)({id:A}).finally(function(){var Me;(Me=Z.current)===null||Me===void 0||Me.finish()});case 4:x=Oe.sent,(G=x.data.detail.setting)!==null&&G!==void 0&&G.buildGit&&(De=x.data.detail.setting.buildGit,De.includes("#")?(be=(0,Le.Z)(De,"#"),ue=De.slice(0,be),Re=De.slice(be+1)):ue=De,ue.includes("@")&&(Pe=new URL(ue),Pe&&(ue="".concat(Pe.origin).concat(Pe.pathname)))),(w=O.current)===null||w===void 0||w.setFieldsValue({id:x.data.detail.id,title:x.data.detail.title,imageTag:(z=x.data.detail.setting)===null||z===void 0?void 0:z.tag,imageRegistry:(K=x.data.detail.setting)===null||K===void 0?void 0:K.registry,buildType:(_e=x.data.detail.setting)===null||_e===void 0?void 0:_e.buildType,buildDockerfileRoot:(L=x.data.detail.setting)===null||L===void 0?void 0:L.buildDockerfileRoot,buildDockerfileContent:(le=x.data.detail.setting)===null||le===void 0?void 0:le.buildDockerfileContent,buildDockerfileName:(ae=x.data.detail.setting)===null||ae===void 0?void 0:ae.buildDockerfileName,buildGit:ue,buildGitBranch:Re,buildGitUsername:(de=Pe)===null||de===void 0?void 0:de.username,buildGitPassword:(pe=Pe)===null||pe===void 0?void 0:pe.password,buildArgs:(oe=x.data.detail.setting)===null||oe===void 0?void 0:oe.buildArgs,platform:(Ee=x.data.detail.setting)===null||Ee===void 0?void 0:Ee.platform});case 7:case"end":return Oe.stop()}},l)}))()}}}),(0,t.jsx)(Ae.Z,{drawerProps:{width:h.R_},ref:Z,title:E.Ob.format("image.create"),open:$,onOpenChange:function(A){if(U(A),!A){var l;(l=O.current)===null||l===void 0||l.resetFields(),F.onFinish&&F.onFinish()}},trigger:(0,t.jsx)(Ue.ZP,{type:"primary",children:E.Ob.format("image.create")},"create"),onFinish:function(){var V=i()(n()().mark(function A(l){var M,G,w,z,K,_e,L,le,ae,de,pe,oe;return n()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(G=(M=l.buildType)!==null&&M!==void 0?M:"dockerfile",G!="containerTar"){x.next=7;break}return x.next=4,(0,We.Ck)({tag:l.imageTag,registry:l.imageRegistry,tar:(w=l.containerTar[0].response.data.path)!==null&&w!==void 0?w:"",cmd:l.cmd,workDir:l.workDir,expose:l.expose?l.expose.split(`
`):[],env:l.env?l.env.split(`
`):[],volume:l.volume?l.volume.split(`
`):[]});case 4:return x.abrupt("return",!0);case 7:return _e={name:"",arch:""},Be.ii.map(function(ue){ue.name==l.platform&&(_e=ue)}),L={id:l.id?parseInt(l.id):0,tag:l.imageTag,title:l.title,registry:l.imageRegistry,buildDockerfileContent:l.buildDockerfileContent,buildDockerfileRoot:l.buildDockerfileRoot,buildDockerfileName:l.buildDockerfileName,buildZip:"",buildGit:l.buildGit,buildType:l.buildType,buildArgs:l.buildArgs},l.buildZip&&l.buildZip.length>0&&(L.buildZip=(le=l.buildZip[0].response.data.path)!==null&&le!==void 0?le:""),G=="git"&&(L.buildGit=L.buildGit+"#"+(l.buildGitBranch||"master"),l.buildDockerfileRoot&&l.buildDockerfileRoot!=""&&(L.buildGit="".concat(L.buildGit,":").concat(l.buildDockerfileRoot)),l.buildGitUsername&&l.buildGitPassword&&(ae="https://",L.buildGit.includes("http://")&&(ae="http://"),L.buildGit="".concat(L.buildGit.replace(ae,"".concat(ae).concat(l.buildGitUsername,":").concat(l.buildGitPassword,"@"))))),(z=B.current)===null||z===void 0||z.start("build",((K=L.id)!==null&&K!==void 0?K:0).toString()),x.prev=13,x.next=16,(0,_.l9)(L);case 16:return pe=x.sent,te.success(E.FD.format("finish")),x.next=20,new Promise(function(ue){setTimeout(function(){ue(!0)},1e3)});case 20:return(de=B.current)===null||de===void 0||de.close(),x.abrupt("return",!0);case 24:x.prev=24,x.t0=x.catch(13),(oe=B.current)===null||oe===void 0||oe.close();case 27:case"end":return x.stop()}},A,null,[[13,24]])}));return function(A){return V.apply(this,arguments)}}(),formRef:O,children:(0,t.jsxs)(k.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsxs)(k.Z,{ghost:!0,children:[(0,t.jsx)(S.Z,{name:"id",hidden:!0}),(0,t.jsx)(q.Z,{width:"lg",label:b.format("formTitle"),name:"title"}),(0,t.jsxs)(je.UW,{children:[(0,t.jsx)(Ce.Z,{width:"lg",label:b.format("formImageRegistry"),tooltip:b.format("formImageRegistryTip"),name:"imageRegistry",request:i()(n()().mark(function V(){var A;return n()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,ve.Ot)();case 2:return A=M.sent,M.abrupt("return",A.data.list.map(function(G){return{value:G.serverAddress,label:G.title+"("+G.serverAddress+")"}}));case 4:case"end":return M.stop()}},V)}))}),(0,t.jsx)(q.Z,{rules:[{required:!0}],width:"lg",required:!0,tooltip:b.format("formImageTagTip"),placeholder:b.format("formImageTagEmpty"),label:b.format("formImageTag"),name:"imageTag"})]}),(0,t.jsx)(ye.Z.Group,{name:"buildType",initialValue:"dockerfile",label:b.format("formBuildType"),options:b.option("formBuildTypeOption",["dockerfile","zip","git","containerTar"]).map(function(V){return{label:(0,t.jsx)(m.Z,{title:b.format("formBuildTypeTipOption."+V.value),children:V.label}),value:V.value}})}),(0,t.jsx)(Ie.Z,{name:["buildType"],children:function(A){var l=A.buildType,M=[];return l=="containerTar"?M=[(0,t.jsx)(q.Z,{tooltip:b.format("formWorkDirTip"),label:b.format("formWorkDir"),name:"workDir",placeholder:b.format("formWorkDirEmpty")},"workDir"),(0,t.jsx)(q.Z,{required:!0,tooltip:b.format("formCmdTip"),rules:[{required:!0}],label:"CMD",name:"cmd"},"cmd"),(0,t.jsx)(Te.Z,{tooltip:b.format("formExposeTip"),label:b.format("formExpose"),name:"expose",placeholder:`80 
9000`},"expose"),(0,t.jsx)(Te.Z,{tooltip:b.format("formEnvTip"),label:b.format("formEnv"),name:"env",placeholder:`TEST_VALUE=123 
TEST_NO_VALUE=`},"env"),(0,t.jsx)(Te.Z,{tooltip:b.format("formVolumeTip"),label:b.format("formVolume"),name:"volume",placeholder:`/app 
/home`},"volume")]:(l=="zip"||l=="git")&&(M=[(0,t.jsxs)(je.UW,{children:[(0,t.jsx)(q.Z,{width:"lg",name:"buildDockerfileRoot",label:b.format("formBuildDockerfileRoot"),fieldProps:{addonBefore:"/"},placeholder:b.format("formBuildDockerfileRootEmpty")},"buildDockerfileRoot"),(0,t.jsx)(q.Z,{width:"lg",name:"buildDockerfileName",label:b.format("formBuildDockerfileName"),placeholder:b.format("formBuildDockerfileNameEmpty")},"dockerfileName")]},"buildRoot"),(0,t.jsx)(Y.Z,{drawerProps:{ghost:!0},name:"buildArgs",showAddButton:!0,showCodeMode:!0,listLabel:b.format("formBuildArgs")},"env")]),l=="zip"&&(M=[].concat(me()(M),[(0,t.jsx)(fe.Z,{required:!0,label:b.format("formBuildZip"),name:"buildZip",accept:".zip"},"buildZip")])),l=="containerTar"&&(M=[].concat(me()(M),[(0,t.jsx)(fe.Z,{required:!0,label:b.format("formBuildContainerTar"),name:"containerTar",accept:".tar"},"containerTar")])),l=="git"&&(M=[].concat(me()(M),[(0,t.jsxs)(je.UW,{children:[(0,t.jsxs)(c.Z.Compact,{block:!0,children:[(0,t.jsx)(q.Z,{width:"md",label:b.format("formBuildGitUsername"),name:"buildGitUsername",placeholder:b.format("formBuildGitUsernameEmpty")}),(0,t.jsx)(q.Z,{width:"md",label:b.format("formBuildGitPassword"),name:"buildGitPassword"})]}),(0,t.jsxs)(c.Z.Compact,{block:!0,children:[(0,t.jsx)(q.Z,{label:b.format("formBuildGitBranch"),width:"md",name:"buildGitBranch"}),(0,t.jsx)(q.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],width:"lg",required:!0,placeholder:b.format("formBuildGitEmpty"),label:b.format("formBuildGit"),name:"buildGit"})]})]},"buildGit")])),l=="dockerfile"&&(M=[].concat(me()(M),[(0,t.jsx)(ge,{name:"buildDockerfileContent"},"buildDockerfileContent")])),M}})]}),(0,t.jsx)(ce,{onFinish:function(){U(!1),F.onFinish&&F.onFinish()},ref:B})]})})}),Ke=Ze,Se=e(98510),$e=e(78914);function we(){var F=(0,o.useRef)(),he=(0,o.useRef)(),b=(0,o.useRef)(),ee=(0,o.useRef)();return(0,t.jsxs)(j._z,{header:{extra:[(0,t.jsx)(Ke,{ref:b,onFinish:function(){var B;!((B=F.current)===null||B===void 0)&&B.reloadAndRest&&F.current.reloadAndRest()}},"create")]},children:[(0,t.jsx)($e.Z,{ref:ee}),(0,t.jsx)(Se.C,{actionRef:F,rowKey:"id",columns:[{title:E.FD.format("listTitle"),render:function(B,O,N,se){return O.title}},{title:E.FD.format("listImageName"),dataIndex:"tag",search:!1,render:function(B,O,N,se){var $,U,Z;return(0,t.jsx)(p.Z.Link,{type:!(($=O.setting)!==null&&$!==void 0&&$.imageId)||O.setting.imageId==""?"secondary":void 0,onClick:function(){var A,l,M;!((A=O.setting)===null||A===void 0)&&A.imageId&&((l=ee.current)===null||l===void 0||l.show((M=O.setting)===null||M===void 0?void 0:M.imageId))},children:(U=(Z=O.setting)===null||Z===void 0?void 0:Z.tag)!==null&&U!==void 0?U:O.tag})}},{title:E.FD.format("listStatus"),width:150,ellipsis:!0,search:!1,render:function(B,O,N,se){var $;return($=O.setting)!==null&&$!==void 0&&$.imageId||(O.status=0),[(0,t.jsx)("div",{children:(0,t.jsx)(D.Z,{status:"status.".concat(O.status)},O.id)},O.id)]}},{title:E.FD.format("listManage"),valueType:"option",key:"option",width:100,fixed:"right",render:function(B,O,N,se){return(0,t.jsxs)(c.Z,{split:(0,t.jsx)(g.Z,{type:"vertical"}),children:[(0,t.jsx)(p.Z.Link,{onClick:function(){var U;O.id&&((U=b.current)===null||U===void 0||U.show(O.id))},children:(0,t.jsx)(m.Z,{title:E.FD.format("listManageEdit"),children:(0,t.jsx)(v.Z,{})})},"rebuild"),(0,t.jsx)(p.Z.Link,{onClick:i()(n()().mark(function $(){var U,Z,V,A,l,M,G,w,z,K;return n()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return(U=he.current)===null||U===void 0||U.start("build",((Z=O.id)!==null&&Z!==void 0?Z:0).toString()),L.prev=1,L.next=4,(0,_.l9)(s()(s()({id:O.id,title:O.title},O.setting),{},{buildDockerfileContent:((V=O.setting)===null||V===void 0?void 0:V.buildDockerfileContent)||((A=O.setting)===null||A===void 0?void 0:A.buildDockerfile),buildDockerfileRoot:((l=O.setting)===null||l===void 0?void 0:l.buildDockerfileRoot)||((M=O.setting)===null||M===void 0?void 0:M.buildRoot),buildType:((G=O.setting)===null||G===void 0?void 0:G.buildType)||O.buildType,tag:((w=O.setting)===null||w===void 0?void 0:w.tag)||O.tag}));case 4:return z=L.sent,L.abrupt("return",!0);case 8:L.prev=8,L.t0=L.catch(1),(K=he.current)===null||K===void 0||K.close();case 11:case"end":return L.stop()}},$,null,[[1,8]])})),children:(0,t.jsx)(m.Z,{title:E.FD.format("listManageBuild"),children:(0,t.jsx)(a.Z,{})})},"logs")]})}}],request:function(){var te=i()(n()().mark(function B(O,N,se){var $,U,Z;return n()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,_.bJ)({page:($=O.current)!==null&&$!==void 0?$:1,pageSize:(U=O.pageSize)!==null&&U!==void 0?U:10});case 2:return Z=A.sent,A.abrupt("return",{data:Z.data.list,success:!0,total:Z.data.list.length});case 4:case"end":return A.stop()}},B)}));return function(B,O,N){return te.apply(this,arguments)}}(),quickToolbarRender:function(B){var O=B.selectedRows,N=B.finish,se=B.loading;return(0,t.jsx)(c.Z,{size:16,children:(0,t.jsx)(r.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,t.jsx)(T.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return se(),(0,_.hf)({id:O.map(function(U){return U.id})}).finally(function(){N(!0)})},onSuccess:function(){var U,Z;return!((U=F.current)===null||U===void 0)&&U.reloadAndRest&&((Z=F.current)===null||Z===void 0||Z.reloadAndRest()),!0},onError:function(){var U,Z;return!((U=F.current)===null||U===void 0)&&U.reset&&((Z=F.current)===null||Z===void 0||Z.reset()),!0},children:E.FD.format("listManageDeleteBatch")})})}}),(0,t.jsx)(ce,{onFinish:function(){var B;!((B=F.current)===null||B===void 0)&&B.reloadAndRest&&F.current.reloadAndRest()},ref:he})]})}},4813:function(Q,R,e){e.d(R,{_:function(){return i}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(p){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function p(c){return n()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,d.request)("/api/common/attach/delete",{method:"POST",data:c});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},p)})),j.apply(this,arguments)}},97841:function(Q,R,e){e.d(R,{Xr:function(){return _},bJ:function(){return g},c5:function(){return v},hf:function(){return i},l9:function(){return p}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(T){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,d.request)("/api/app/image-build/delete",{method:"POST",data:r});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},T)})),j.apply(this,arguments)}function p(T){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/app/image-build/create",{method:"POST",data:r}));case 1:case"end":return u.stop()}},T)})),c.apply(this,arguments)}function g(T){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/app/image-build/get-list",{method:"POST",data:r}));case 1:case"end":return u.stop()}},T)})),m.apply(this,arguments)}function _(T){return D.apply(this,arguments)}function D(){return D=s()(n()().mark(function T(r){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,d.request)("/api/app/image-build/get-detail",{method:"POST",data:r});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},T)})),D.apply(this,arguments)}function v(){return a.apply(this,arguments)}function a(){return a=s()(n()().mark(function T(){return n()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,d.request)("/api/app/image-build/prune",{method:"POST"});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},T)})),a.apply(this,arguments)}},73813:function(Q,R,e){e.d(R,{Ck:function(){return i},Fj:function(){return T},GH:function(){return p},KG:function(){return _},Rb:function(){return P},Xz:function(){return g},YU:function(){return o},ZQ:function(){return ne},ao:function(){return v},cD:function(){return h}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(f){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/import-by-container-tar",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),j.apply(this,arguments)}function p(f){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/import-by-image-tar",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),c.apply(this,arguments)}function g(f){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/prune",{method:"POST"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),m.apply(this,arguments)}function _(f){return D.apply(this,arguments)}function D(){return D=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/get-list",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),D.apply(this,arguments)}function v(f){return a.apply(this,arguments)}function a(){return a=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/delete",{method:"POST",data:y});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),a.apply(this,arguments)}function T(f){return r.apply(this,arguments)}function r(){return r=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.request)("/api/app/image/update-title",{method:"POST",data:y});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},f)})),r.apply(this,arguments)}function o(f){return u.apply(this,arguments)}function u(){return u=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/get-detail",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),u.apply(this,arguments)}function P(f){return k.apply(this,arguments)}function k(){return k=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!y.enableExportToPath){t.next=2;break}return t.abrupt("return",(0,d.request)("/api/app/image/export",{method:"POST",data:y}));case 2:return t.abrupt("return",new Promise(function(ie,ce){var re,me=localStorage.getItem("token"),Y=new URLSearchParams;Y.append("token",me||""),y.md5&&y.md5.forEach(function(H){Y.append("md5",H)}),Y.append("enableExportToPath",String((re=y.enableExportToPath)!==null&&re!==void 0?re:!1));var J="/api/app/image/export?".concat(Y.toString()),S=document.createElement("iframe");S.style.display="none",S.src=J,document.body.appendChild(S),ie({code:200,data:"success",error:""})}));case 3:case"end":return t.stop()}},f)})),k.apply(this,arguments)}function ne(f){return X.apply(this,arguments)}function X(){return X=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/app/image/check-upgrade",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),X.apply(this,arguments)}function h(f){return E.apply(this,arguments)}function E(){return E=s()(n()().mark(function f(y){return n()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,d.request)("/api/pro/image/get-rootfs",{method:"POST",data:y}));case 1:case"end":return t.stop()}},f)})),E.apply(this,arguments)}},75870:function(Q,R,e){e.d(R,{Ot:function(){return i},ZH:function(){return p},ix:function(){return g},t1:function(){return _}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346);function i(v){return j.apply(this,arguments)}function j(){return j=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/get-list",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),j.apply(this,arguments)}function p(v){return c.apply(this,arguments)}function c(){return c=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/create",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),c.apply(this,arguments)}function g(v){return m.apply(this,arguments)}function m(){return m=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/delete",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),m.apply(this,arguments)}function _(v){return D.apply(this,arguments)}function D(){return D=s()(n()().mark(function v(a){return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.request)("/api/common/registry/get-detail",{method:"POST",data:a}));case 1:case"end":return r.stop()}},v)})),D.apply(this,arguments)}},68297:function(Q,R,e){e.d(R,{Qd:function(){return c},Ze:function(){return j},aw:function(){return a},cV:function(){return m},fy:function(){return D},ii:function(){return i}});var C=e(15009),n=e.n(C),I=e(99289),s=e.n(I),d=e(82346),i=[{name:"amd64",arch:"amd64",search:["amd64","x86_64","86_64"]},{name:"arm64",arch:"arm64",search:["arm64","arrch64"]},{name:"i386",arch:"386",search:[]},{name:"arm/v6",arch:"arm",search:[]},{name:"arm/v7",arch:"arm",search:[]},{name:"arm/v8",arch:"arm64",search:[]},{name:"ppc64le",arch:"ppc64le",search:[]},{name:"riscv64",arch:"riscv64",search:[]}];function j(r){return p.apply(this,arguments)}function p(){return p=s()(n()().mark(function r(o){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,d.request)("/api/app/image/tag-sync",{method:"POST",data:o}));case 1:case"end":return P.stop()}},r)})),p.apply(this,arguments)}function c(r){return g.apply(this,arguments)}function g(){return g=s()(n()().mark(function r(o){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,d.request)("/api/app/image/tag-add",{method:"POST",data:o}));case 1:case"end":return P.stop()}},r)})),g.apply(this,arguments)}function m(r){return _.apply(this,arguments)}function _(){return _=s()(n()().mark(function r(o){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,d.request)("/api/app/image/tag-delete",{method:"POST",data:o}));case 1:case"end":return P.stop()}},r)})),_.apply(this,arguments)}function D(r){return v.apply(this,arguments)}function v(){return v=s()(n()().mark(function r(o){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,d.request)("/api/app/image/tag-push-batch",{method:"POST",data:o}));case 1:case"end":return P.stop()}},r)})),v.apply(this,arguments)}function a(r){return T.apply(this,arguments)}function T(){return T=s()(n()().mark(function r(o){return n()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,d.request)("/api/pro/image/get-remote-tag",{method:"POST",data:o}));case 1:case"end":return P.stop()}},r)})),T.apply(this,arguments)}}}]);
