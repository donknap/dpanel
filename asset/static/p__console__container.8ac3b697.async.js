(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(w,f,t){"use strict";var i=t(5574),d=t.n(i),b=t(12323),r=t(52626),C=t(87662),_=t(78267),o=t.n(_),y=t(4244),M=t.n(y),T=t(24078),h=t(67294),j=t(85893),a,g,u,D,O=(0,h.forwardRef)(function(L,W){var I,A=(0,h.useState)(),R=d()(A,2),S=R[0],B=R[1],U=(0,h.useState)(""),n=d()(U,2),s=n[0],p=n[1];function e(){D&&(a.reset(),g.fit(),a.focus(),D.dispose()),u&&(u.close(),u=null)}return(0,h.useImperativeHandle)(W,function(){return{start:function(c,l){e(),g.fit(),l.width=a.cols,l.height=a.rows;var P=l?Object.keys(l).filter(function(E){return l&&l[E]}).map(function(E){return l&&l[E]?"".concat(E,"=").concat(l[E]):""}):[];u=new WebSocket((0,r.R)(c+"?"+P.join("&"))),u.addEventListener("message",function(E){var v=JSON.parse(E.data),K=v.type;if(K===c&&(a.write(v.data),v.data.indexOf("exec failed")!==-1)){e();return}}),D=a.onData(function(E){var v={content:{command:E},type:c};u&&u.send(JSON.stringify(v))}),p(c),B(l)},close:function(){e()},fit:function(){return g.fit(),{width:a.cols,height:a.rows}},run:function(c){S&&(c==null||c.forEach(function(l){var P={content:{command:l+`
`},type:s};u&&u.send(JSON.stringify(P))}))}}}),(0,h.useEffect)(function(){return a=new y.Terminal(b.X),g=new _.FitAddon,a.loadAddon(g),a.open(document.getElementById("terminal-container-console")),g.fit(),a.onKey(function(m){var c=m.domEvent;if(c.ctrlKey&&c.key==="c"){var l=a.getSelection();if(l){navigator.clipboard.writeText(l).then(function(){a.clearSelection()}),c.preventDefault();return}}c.ctrlKey&&c.key==="v"&&(navigator.clipboard.readText().then(function(P){P&&a.input(P)}),c.preventDefault())}),(0,C.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(m){m.data&&m.data.fontSize&&Object.assign(a.options,m.data)}),function(){e()}},[]),(0,h.useEffect)(function(){window.addEventListener("resize",function(){g.fit();var m={size:{width:a.cols,height:a.rows},type:s};s&&u&&u.send(JSON.stringify(m))})},[s]),(0,j.jsx)("div",{style:{height:(I=L.height)!==null&&I!==void 0?I:"100vh"},id:"terminal-container-console"})});f.Z=O},12323:function(w,f,t){"use strict";t.d(f,{X:function(){return i},n:function(){return d}});var i={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},d=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},15563:function(w,f,t){"use strict";t.r(f),t.d(f,{default:function(){return M}});var i=t(5574),d=t.n(i),b=t(49610),r=t(13822),C=t(5251),_=t(63713),o=t(67294),y=t(85893);function M(){var T=(0,_.useParams)(),h=(0,_.useSearchParams)(),j=d()(h,2),a=j[0],g=j[1],u=(0,o.useRef)();return(0,o.useEffect)(function(){T.id&&(0,r.jV)({md5:T.id}).then(function(D){var O;window.document.title="".concat((0,C.fi)(D.data.info.Name,"/")," - console"),T.id&&((O=u.current)===null||O===void 0||O.start("/console/container/".concat(D.data.info.Id),{cmd:a.get("cmd"),workDir:a.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,y.jsx)(b.Z,{ref:u})}},13822:function(w,f,t){"use strict";t.d(f,{IE:function(){return T},IW:function(){return y},KK:function(){return D},LJ:function(){return L},RF:function(){return R},Re:function(){return I},aF:function(){return B},eE:function(){return g},jV:function(){return j}});var i=t(5574),d=t.n(i),b=t(15009),r=t.n(b),C=t(99289),_=t.n(C),o=t(63713);function y(n){return M.apply(this,arguments)}function M(){return M=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/status",{method:"POST",data:s}));case 1:case"end":return e.stop()}},n)})),M.apply(this,arguments)}function T(n){return h.apply(this,arguments)}function h(){return h=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-list",{data:s,method:"POST"}));case 1:case"end":return e.stop()}},n)})),h.apply(this,arguments)}function j(n){return a.apply(this,arguments)}function a(){return a=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-detail",{data:s,method:"POST"}));case 1:case"end":return e.stop()}},n)})),a.apply(this,arguments)}function g(n){return u.apply(this,arguments)}function u(){return u=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/update",{data:s,method:"POST"}));case 1:case"end":return e.stop()}},n)})),u.apply(this,arguments)}function D(){return O.apply(this,arguments)}function O(){return O=_()(r()().mark(function n(){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,o.request)("/dpanel/api/app/container/prune",{method:"POST"}));case 1:case"end":return p.stop()}},n)})),O.apply(this,arguments)}function L(n){return W.apply(this,arguments)}function W(){return W=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.enableExportToPath){e.next=2;break}return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/export",{method:"GET",params:s}));case 2:return e.abrupt("return",new Promise(function(m,c){var l=localStorage.getItem("token"),P=new URLSearchParams;P.append("token",l||""),Object.entries(s).forEach(function(K){var x=d()(K,2),k=x[0],N=x[1];P.append(k,String(N))});var E="/dpanel/api/app/container/export?".concat(P.toString()),v=document.createElement("iframe");v.style.display="none",v.src=E,document.body.appendChild(v),setTimeout(function(){v.parentElement&&document.body.removeChild(v)},5e3),m({code:200,data:"success",error:""})}));case 3:case"end":return e.stop()}},n)})),W.apply(this,arguments)}function I(n){return A.apply(this,arguments)}function A(){return A=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/commit",{method:"POST",data:s}));case 1:case"end":return e.stop()}},n)})),A.apply(this,arguments)}function R(n){return S.apply(this,arguments)}function S(){return S=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/upgrade",{method:"POST",data:s}));case 1:case"end":return e.stop()}},n)})),S.apply(this,arguments)}function B(n){return U.apply(this,arguments)}function U(){return U=_()(r()().mark(function n(s){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/copy",{method:"POST",data:s}));case 1:case"end":return e.stop()}},n)})),U.apply(this,arguments)}},24078:function(){"use strict"},78267:function(w){(function(f,t){w.exports=t()})(self,()=>(()=>{"use strict";var f={};return(()=>{var t=f;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(i){this._terminal=i}dispose(){}fit(){const i=this.proposeDimensions();if(!i||!this._terminal||isNaN(i.cols)||isNaN(i.rows))return;const d=this._terminal._core;this._terminal.rows===i.rows&&this._terminal.cols===i.cols||(d._renderService.clear(),this._terminal.resize(i.cols,i.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const i=this._terminal._core,d=i._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;const b=this._terminal.options.scrollback===0?0:i.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),C=parseInt(r.getPropertyValue("height")),_=Math.max(0,parseInt(r.getPropertyValue("width"))),o=window.getComputedStyle(this._terminal.element),y=C-(parseInt(o.getPropertyValue("padding-top"))+parseInt(o.getPropertyValue("padding-bottom"))),M=_-(parseInt(o.getPropertyValue("padding-right"))+parseInt(o.getPropertyValue("padding-left")))-b;return{cols:Math.max(2,Math.floor(M/d.css.cell.width)),rows:Math.max(1,Math.floor(y/d.css.cell.height))}}}})(),f})())}}]);
