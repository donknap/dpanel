"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5841],{12119:function(Ie,Ee,e){e.d(Ee,{Z:function(){return N}});var Pe=e(87462),q=e(67294),we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},a=we,Re=e(84089),E=function(T,ee){return q.createElement(Re.Z,(0,Pe.Z)({},T,{ref:ee,icon:a}))},he=q.forwardRef(E),N=he},99922:function(Ie,Ee,e){var Pe=e(97857),q=e.n(Pe),we=e(15009),a=e.n(we),Re=e(99289),E=e.n(Re),he=e(5574),N=e.n(he),u=e(67294),T=e(85265),ee=e(23345),Oe=e(83622),j=e(49610),G=e(3616),z=e(69033),ne=e(90581),Ce=e(5251),J=e(36146),De=e(95591),de=e(24963),re=e(85893),pe=new J.Uo("components.console"),xe=(0,u.forwardRef)(function(ve,M){var ae,A,ce,_e=(0,u.useRef)(),b=(0,u.useRef)(),L=(0,u.useState)(!1),F=N()(L,2),H=F[0],W=F[1],oe=(0,u.useState)(),Q=N()(oe,2),h=Q[0],te=Q[1],Te=(0,u.useContext)(de.Z),ie=Te.message,ye=(0,u.useRef)();return(0,u.useImperativeHandle)(M,function(){return{show:function(S){return E()(a()().mark(function se(){var Le;return a()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:te(S),W(!0),(Le=_e.current)===null||Le===void 0||Le.resetFields();case 3:case"end":return be.stop()}},se)}))()}}}),(0,u.useEffect)(function(){return setTimeout(function(){var Y;h&&((Y=b.current)===null||Y===void 0||Y.start(h.url,{cmd:h&&h.cmd,workDir:h&&h.workDir}))},1e3),function(){var Y;(Y=b.current)===null||Y===void 0||Y.close()}},[h,H]),(0,re.jsxs)(T.Z,{forceRender:!0,width:G.FK,open:H,onClose:function(){var S;W(!1),!((S=ye.current)===null||S===void 0)&&S.reset&&ye.current.reset()},title:pe.format("drawerTitle",{name:(0,Ce.fi)((ae=h==null?void 0:h.title)!==null&&ae!==void 0?ae:"","/")}),children:[(0,re.jsxs)(ee.Z,{style:{marginBottom:20},children:[ve.showFileExplorer&&(0,re.jsx)(z.Z,{trigger:(0,re.jsx)(Oe.ZP,{icon:(0,re.jsx)(De.Z,{}),type:"primary",children:J.FD.format("listManageFilePath")}),type:"container",title:(0,Ce.fi)((A=h==null?void 0:h.title)!==null&&A!==void 0?A:"","/"),name:h&&h.url&&(ce=h.url.split("/").pop())!==null&&ce!==void 0?ce:""}),(0,re.jsx)(ne.Z,{ref:ye,onChangeShell:function(S){var se;if(!h)return!1;(se=b.current)===null||se===void 0||se.close(),te(q()(q()({},h),{cmd:S!=null?S:h==null?void 0:h.cmd})),ie.success(J.FD.format("finish"))},onOpenNewWindow:function(S){return h?(S.workDir=h&&h.workDir?h.workDir:"","".concat(h.url,"?").concat(Object.keys(S).map(function(se){return"".concat(se,"=").concat(encodeURIComponent(S[se]))}).join("&"))):""},onOpenNewWindowFinish:function(){var S;(S=b.current)===null||S===void 0||S.close(),W(!1)},onBatchCommandFinish:function(S){b.current&&b.current.run(S)}})]}),H&&(0,re.jsx)(j.Z,{height:"80vh",ref:b})]})});Ee.Z=xe},69033:function(Ie,Ee,e){e.d(Ee,{Z:function(){return Dn}});var Pe=e(97857),q=e.n(Pe),we=e(15009),a=e.n(we),Re=e(99289),E=e.n(Re),he=e(5574),N=e.n(he),u=e(67294),T=e(63713);function ee(r,l){return Oe.apply(this,arguments)}function Oe(){return Oe=E()(a()().mark(function r(l,s){var O;return a()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return O="/dpanel/api/".concat(l,"/explorer/get-path-list"),K.next=3,(0,T.request)(O,{data:s,method:"POST"});case 3:return K.abrupt("return",K.sent);case 4:case"end":return K.stop()}},r)})),Oe.apply(this,arguments)}function j(r,l){return G.apply(this,arguments)}function G(){return G=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/export"),{data:s,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),G.apply(this,arguments)}function z(r,l){return ne.apply(this,arguments)}function ne(){return ne=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/import"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ne.apply(this,arguments)}function Ce(r,l){return J.apply(this,arguments)}function J(){return J=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/delete"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),J.apply(this,arguments)}function De(r,l){return de.apply(this,arguments)}function de(){return de=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/unzip"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),de.apply(this,arguments)}function re(r,l){return pe.apply(this,arguments)}function pe(){return pe=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/get-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),pe.apply(this,arguments)}function xe(r,l){return ve.apply(this,arguments)}function ve(){return ve=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/import-file-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ve.apply(this,arguments)}function M(r,l){return ae.apply(this,arguments)}function ae(){return ae=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/mkdir"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ae.apply(this,arguments)}function A(r,l){return ce.apply(this,arguments)}function ce(){return ce=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/chmod"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ce.apply(this,arguments)}function _e(r,l){return b.apply(this,arguments)}function b(){return b=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/get-user-list"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),b.apply(this,arguments)}function L(r,l){return F.apply(this,arguments)}function F(){return F=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/get-file-stat"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),F.apply(this,arguments)}function H(r,l){return W.apply(this,arguments)}function W(){return W=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/attach-volume"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),W.apply(this,arguments)}function oe(r){return Q.apply(this,arguments)}function Q(){return Q=E()(a()().mark(function r(l){return a()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/destroy-proxy-container"),{data:{},method:"POST"});case 2:return O.abrupt("return",O.sent);case 3:case"end":return O.stop()}},r)})),Q.apply(this,arguments)}function h(r,l){return te.apply(this,arguments)}function te(){return te=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.request)("/dpanel/api/".concat(l,"/explorer/copy"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),te.apply(this,arguments)}var Te=e(97269),ie=e(5966),ye=e(31112),Y=e(92237),S=e(86615),se=e(62370),Le=e(97462),Ke=e(11106),be=e(24963),Ze=e(5251),Me=e(36146),Ve=e(27166),i=e(85893),me=new Me.Uo("components.explorer"),He=(0,u.forwardRef)(function(r,l){var s,O,n=(0,u.useContext)(be.Z),K=n.notice,I=(0,u.useContext)(ye.Z),Z=I.currentPath,k=I.refresh,B=I.name,U=I.apiPrefix,_=(0,u.useRef)(),le=(0,u.useState)(!1),$=N()(le,2),y=$[0],g=$[1],f=(0,u.useRef)();return(0,u.useImperativeHandle)(l,function(){return{newFile:function(){var w;g(!0),(w=_.current)===null||w===void 0||w.setFieldValue("type","newFile")},editFile:function(w,D,fe){return E()(a()().mark(function v(){var ue,je,R,t,o,c;return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return g(!0),(ue=f.current)===null||ue===void 0||ue.loading(),d.prev=2,d.next=5,re(U,{name:B,file:D}).finally(function(){var x;(x=f.current)===null||x===void 0||x.finish()});case 5:if(c=d.sent,!(c.data.content==""&&fe!="0")){d.next=10;break}return K.error(me.format("editFileMessageNotSupport")),g(!1),d.abrupt("return");case 10:(je=_.current)===null||je===void 0||je.setFieldValue("newValue",c.data.content),(R=_.current)===null||R===void 0||R.setFieldValue("newName",w),(t=_.current)===null||t===void 0||t.setFieldValue("type","editFile"),(o=_.current)===null||o===void 0||o.setFieldValue("fileMode",c.data.fileMode),d.next=19;break;case 16:d.prev=16,d.t0=d.catch(2),g(!1);case 19:return d.abrupt("return");case 20:case"end":return d.stop()}},v,null,[[2,16]])}))()}}}),(0,i.jsxs)(Ve.Z,{drawerProps:{width:"50vw",forceRender:!0},onFinish:function(){var P=E()(a()().mark(function w(D){return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(D.type!="newDir"){v.next=13;break}return v.prev=1,v.next=4,M(U,{name:B,destPath:"".concat(Z,"/").concat((0,Ze.fi)(D.newPath,"/"))});case 4:return k(),g(!1),v.abrupt("return",!0);case 9:v.prev=9,v.t0=v.catch(1);case 11:v.next=23;break;case 13:return v.prev=13,v.next=16,xe(U,{destPath:Z,file:D.newName,content:D.newValue,name:B,fileMode:D.fileMode});case 16:return k(),g(!1),v.abrupt("return",!0);case 21:v.prev=21,v.t1=v.catch(13);case 23:return v.abrupt("return",!1);case 24:case"end":return v.stop()}},w,null,[[1,9],[13,21]])}));return function(w){return P.apply(this,arguments)}}(),ref:f,title:me.format("editFileTypeEditFile"),open:y,onOpenChange:function(w){if(g(w),!w){var D;(D=_.current)===null||D===void 0||D.resetFields(),r.onFinish&&r.onFinish()}},formRef:_,children:[(0,i.jsx)(S.Z.Group,{name:"type",options:[{label:me.format("editFileTypeEditFile"),value:"editFile",disabled:((s=_.current)===null||s===void 0?void 0:s.getFieldValue("type"))!="editFile"},{label:me.format("editFileTypeNewFile"),value:"newFile"},{label:me.format("editFileTypeNewDir"),value:"newDir"}],disabled:((O=_.current)===null||O===void 0?void 0:O.getFieldValue("type"))=="editFile"}),(0,i.jsx)(se.Z,{name:"fileMode",hidden:!0}),(0,i.jsx)(Le.Z,{name:["type"],children:function(w){var D=w.type;return D!="newDir"?[(0,i.jsx)(ie.Z,{label:me.format("editFileNewName"),tooltip:me.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(Z,"/")},placeholder:me.format("editFileNewNameEmpty"),disabled:D=="editFile"},"fileName"),(0,i.jsx)(se.Z,{label:me.format("editFileNewValue"),name:"newValue",children:(0,i.jsx)(Ke.ZP,{theme:"dark",height:"58vh",onChange:function(v){var ue;(ue=_.current)===null||ue===void 0||ue.setFieldValue("newValue",v)}})},"fileContent")]:(0,i.jsx)(ie.Z,{name:"newPath",label:me.format("editFileNewPath"),placeholder:me.format("editFileNewPathEmpty")})}})]})}),ke=He,Ue=e(15836),Ae=e(83622),Ge=e(83062),Je=e(66309),Qe=e(55681),Ye=e(51042),Xe=e(86548),qe=e(12119),$e=e(87462),en={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M957.6 507.4L603.2 158.2a7.9 7.9 0 00-11.2 0L353.3 393.4a8.03 8.03 0 00-.1 11.3l.1.1 40 39.4-117.2 115.3a8.03 8.03 0 00-.1 11.3l.1.1 39.5 38.9-189.1 187H72.1c-4.4 0-8.1 3.6-8.1 8V860c0 4.4 3.6 8 8 8h344.9c2.1 0 4.1-.8 5.6-2.3l76.1-75.6 40.4 39.8a7.9 7.9 0 0011.2 0l117.1-115.6 40.1 39.5a7.9 7.9 0 0011.2 0l238.7-235.2c3.4-3 3.4-8 .3-11.2zM389.8 796.2H229.6l134.4-133 80.1 78.9-54.3 54.1zm154.8-62.1L373.2 565.2l68.6-67.6 171.4 168.9-68.6 67.6zM713.1 658L450.3 399.1 597.6 254l262.8 259-147.3 145z"}}]},name:"highlight",theme:"outlined"},nn=en,Ne=e(84089),rn=function(l,s){return u.createElement(Ne.Z,(0,$e.Z)({},l,{ref:s,icon:nn}))},tn=u.forwardRef(rn),an=tn,on={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 392h64v64h-64zm0 190v160h128V582h-64v-62h-64v62zm80 48v64h-32v-64h32zm-16-302h64v64h-64zm-64-64h64v64h-64zm64 192h64v64h-64zm0-256h64v64h-64zm494.6 88.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h64v64h64v-64h174v216a42 42 0 0042 42h216v494z"}}]},name:"file-zip",theme:"outlined"},sn=on,ln=function(l,s){return u.createElement(Ne.Z,(0,$e.Z)({},l,{ref:s,icon:sn}))},un=u.forwardRef(ln),dn=un,cn=e(23430),mn=e(58638),fn=e(93162),hn=e(88484),ze=e(37476),pn=e(91604),Se=e(3616),vn=e(4813);function _n(){var r=(0,u.useRef)(),l=(0,u.useContext)(ye.Z),s=l.refresh,O=l.name,n=l.apiPrefix,K=l.currentPath,I=new Me.Uo("components.explorer");return(0,i.jsx)(ze.Y,{modalProps:{width:Se.ob},formRef:r,trigger:(0,i.jsx)(Ae.ZP,{icon:(0,i.jsx)(hn.Z,{}),children:I.format("toolbarUploadButton")}),title:I.format("toolbarUploadModalTitle"),onFinish:function(){var Z=E()(a()().mark(function k(B){var U,_;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return _=[],B.importFileList&&B.importFileList.map(function(y){_.push({name:y.name,path:y.response.data.path})}),z(n,{fileList:_,name:O,destPath:K}),(U=r.current)===null||U===void 0||U.resetFields(),s(),$.abrupt("return",!0);case 6:case"end":return $.stop()}},k)}));return function(k){return Z.apply(this,arguments)}}(),children:(0,i.jsx)(pn.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(k){return new Promise(function(B){var U;(0,vn._)({path:(U=k.response.data.path)!==null&&U!==void 0?U:""}).then(function(_){B(!0)})})}}})})}var We=e(38345),ge=e(63434),gn=e(23345),En=(0,u.forwardRef)(function(r,l){var s=(0,u.useRef)(),O=(0,u.useContext)(ye.Z),n=O.refresh,K=O.name,I=O.apiPrefix,Z=(0,u.useState)(!1),k=N()(Z,2),B=k[0],U=k[1],_=new Me.Uo("components.explorer");(0,u.useImperativeHandle)(l,function(){return{show:function(g){var f;U(!0),g.length==1&&$(le(g[0].modStr)),(f=s.current)===null||f===void 0||f.setFieldValue("fileList",g.map(function(P){return P.path}))}}});function le(y){var g=y.split(""),f=0,P=0,w=0;return g[1]=="r"&&(f+=4),g[2]=="w"&&(f+=2),g[3]=="x"&&(f+=1),g[4]=="r"&&(P+=4),g[5]=="w"&&(P+=2),g[6]=="x"&&(P+=1),g[7]=="r"&&(w+=4),g[8]=="w"&&(w+=2),g[9]=="x"&&(w+=1),"".concat(f).concat(P).concat(w)}function $(y){var g;if((g=s.current)===null||g===void 0||g.setFieldValue("permission",y),y.length>=1){var f;(f=s.current)===null||f===void 0||f.setFieldsValue({ownerRead:Number(y[0])&4,ownerWrite:Number(y[0])&2,ownerExec:Number(y[0])&1})}if(y.length>=2){var P;(P=s.current)===null||P===void 0||P.setFieldsValue({groupRead:Number(y[1])&4,groupWrite:Number(y[1])&2,groupExec:Number(y[1])&1})}if(y.length>=3){var w;(w=s.current)===null||w===void 0||w.setFieldsValue({everyoneRead:Number(y[2])&4,everyoneWrite:Number(y[2])&2,everyoneExec:Number(y[2])&1})}}return(0,i.jsxs)(ze.Y,{modalProps:{forceRender:!0,width:Se.ob},title:_.format("toolbarPermissionModalTitle"),layout:"horizontal",open:B,onOpenChange:function(g){if(U(g),!g){var f;(f=s.current)===null||f===void 0||f.resetFields()}},formRef:s,onValuesChange:function(g,f){if(g.permission)$(g.permission);else{var P=["-",f.ownerRead?"r":"-",f.ownerWrite?"w":"-",f.ownerExec?"x":"-",f.groupRead?"r":"-",f.groupWrite?"w":"-",f.groupExec?"x":"-",f.everyoneRead?"r":"-",f.everyoneWrite?"w":"-",f.everyoneExec?"x":"-"];$(le(P.join("")))}},onFinish:function(){var y=E()(a()().mark(function g(f){var P,w,D;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,A(I,{name:K,fileList:f.fileList,mod:(P=f.permission)!==null&&P!==void 0?P:"600",hasChildren:(w=f.hasChildren)!==null&&w!==void 0?w:!0,user:f.user});case 2:return D=v.sent,n(),v.abrupt("return",!0);case 5:case"end":return v.stop()}},g)}));return function(g){return y.apply(this,arguments)}}(),children:[(0,i.jsxs)(We.Z,{ghost:!0,split:"vertical",bordered:!0,children:[(0,i.jsx)(se.Z,{name:"fileList",hidden:!0}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionRead"),name:"ownerRead"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionRead"),name:"groupRead"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,i.jsxs)(We.Z,{bordered:!0,style:{marginTop:10},children:[(0,i.jsx)(ie.Z,{label:_.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},labelCol:{span:2}}),(0,i.jsxs)(gn.Z.Compact,{children:[(0,i.jsx)(ie.Z,{width:"sm",placeholder:_.format("toolbarPermissionOwnerEmpty"),label:_.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,i.jsx)(ie.Z,{width:"sm",placeholder:_.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,i.jsx)(ge.Z,{label:_.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})]})}),Pn=En,xn=null,V=new Me.Uo("components.explorer"),wn=(0,u.forwardRef)(function(r,l){(0,u.useImperativeHandle)(l,function(){return{close:function(){$([]),v("")}}});var s=r.type=="host"?"common":"app",O=(0,u.useContext)(be.Z),n=O.message,K=(0,u.useRef)(),I=(0,u.useRef)(),Z=(0,u.useRef)(),k=(0,u.useRef)(),B=(0,u.useRef)(),U=(0,T.useSearchParams)(),_=N()(U,2),le=_[0],$=_[1],y=(0,u.useState)(),g=N()(y,2),f=g[0],P=g[1],w=(0,u.useState)(""),D=N()(w,2),fe=D[0],v=D[1];(0,u.useEffect)(function(){var R;n.info(V.format("commonMessageCreateExplorerPlugin")),v((R=r.workDir)!==null&&R!==void 0?R:"")},[]);function ue(R,t){return je.apply(this,arguments)}function je(){return je=E()(a()().mark(function R(t,o){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:(c=K.current)===null||c===void 0||c.addHistory(t,o),v(o),!((p=Z.current)===null||p===void 0)&&p.reloadAndRest&&((d=Z.current)===null||d===void 0||d.reloadAndRest()),o=="/"?$([]):(le.set("path",o),$(le));case 4:case"end":return m.stop()}},R)})),je.apply(this,arguments)}return r&&(0,i.jsxs)(ye.Z.Provider,{value:{name:r.name,apiPrefix:s,currentPath:fe,showPath:ue,redirectPath:function(t){var o;if(v(t),Z.current&&(o=Z.current)!==null&&o!==void 0&&o.reloadAndRest){var c;(c=Z.current)===null||c===void 0||c.reloadAndRest()}t=="/"?$([]):(le.set("path",t),$(le))},refresh:function(){var t;if(Z&&typeof((t=Z.current)===null||t===void 0?void 0:t.reloadAndRest)=="function"){var o;(o=Z.current)===null||o===void 0||o.reloadAndRest()}}},children:[(0,i.jsx)(Qe.Co,{sticky:!1,quickToolbar:{offsetTop:10,target:function(){return document.querySelector(".file-explorer .ant-drawer-body")},render:function(t){var o=t.selectedRows,c=o.map(function(p){return p.path});return[r.onConsole?(0,i.jsx)(Ae.ZP,{onClick:function(){r.onConsole&&r.onConsole(fe)},children:"Console"},"fileConsole"):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(_n,{},"upload"),(0,i.jsx)(Ae.ZP,{icon:(0,i.jsx)(Ye.Z,{}),onClick:function(){I.current&&I.current.newFile()},type:"primary",children:V.format("toolbarNewButton")},"newfile")]}},headerTitle:(0,i.jsx)(Y.Z,{ref:K}),actionRef:Z,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:E()(a()().mark(function R(){var t,o,c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,ee(s,{name:r.name,path:fe});case 2:if(o=m.sent,fe==""&&o.data.currentPath!=""&&v(o.data.currentPath),c=[],(t=K.current)===null||t===void 0||t.initHistory(o.data.currentPath.split("/").filter(function(C){return C!=""}).map(function(C){return c.push(C),{title:C,path:"/".concat(c.join("/"))}}),o.data.rootDirs),p=f,p){m.next=13;break}return m.next=10,_e(s,{name:r.name});case 10:d=m.sent,P(d.data),p=d.data;case 13:return m.abrupt("return",{data:o.data.list.map(function(C){if(p){var X,Be;C.group=(X=(Be=p.group.find(function(Fe){return Fe.gid==C.group}))===null||Be===void 0?void 0:Be.name)!==null&&X!==void 0?X:C.group}return C}),success:!0,total:o.data.list.length});case 14:case"end":return m.stop()}},R)})),columns:[{title:V.format("listName"),dataIndex:"name",key:"name",render:function(x,o,c,p,d){var x;return o.isDir?x=(0,i.jsx)(Ue.Z,{isDir:!0,onClick:function(){return ue(o.name,o.path)},showName:o.name}):o.isSymlink?x=(0,i.jsx)(Ue.Z,{isLink:!0,showName:"".concat(o.name," -> ").concat(o.linkName),onClick:E()(a()().mark(function m(){var C,X;return a()().wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,L(s,{name:r.name,path:o.path});case 2:C=Fe.sent,C.data.info.isDir?ue(o.name,C.data.info.target):(X=I.current)===null||X===void 0||X.editFile(C.data.info.name,C.data.info.target,o.size);case 4:case"end":return Fe.stop()}},m)}))}):x=(0,i.jsx)(Ue.Z,{showName:o.name,onClick:function(){var C;(C=I.current)===null||C===void 0||C.editFile(o.name,o.path,o.size)}}),x}},{title:V.format("listStatus"),key:"status",width:110,render:function(t,o,c,p,d){return o.change>-1&&(0,i.jsx)(Ge.Z,{title:V.format("listStatusTipOption.".concat(o.change)),children:(0,i.jsx)(Je.Z,{color:V.format("listStatusColorOption.".concat(o.change)),children:V.format("listStatusOption.".concat(o.change))})})}},{title:V.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:V.format("listUser"),dataIndex:"user"},{title:V.format("listGroup"),dataIndex:"group"},{title:V.format("listSize"),dataIndex:"size",key:"size",render:function(t,o,c,p,d){return(0,Ze.FI)(o.size)}},{title:V.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(t,o){return new Date(t.modTime).getTime()-new Date(o.modTime).getTime()},render:function(t,o,c,p,d){return(0,Ze.NF)(o.modTime)}}],cardProps:{ghost:!0},actions:[{key:"edit",label:Me.FD.format("listManageEdit"),showInContext:"manage",buttonProps:{icon:(0,i.jsx)(Xe.Z,{})},action:function(t){return E()(a()().mark(function o(){var c,p,d,x,m;return a()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRow,c(),X.next=4,L(s,{name:r.name,path:d.path}).finally(function(){p(!0)});case 4:x=X.sent,x.data.info.isDir?ue(d.name,x.data.info.target):(m=I.current)===null||m===void 0||m.editFile(x.data.info.name,x.data.info.target,d.size);case 6:case"end":return X.stop()}},o)}))()},disable:function(t){return t.isMultiple()||t.selectedRow&&t.selectedRow.isDir||t.selectedRows.length==0}},{key:"permission",label:V.format("toolbarPermissionButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(qe.Z,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:p=t.finish,d=t.selectedRows,p(!0),(c=k.current)===null||c===void 0||c.show(d);case 3:case"end":return m.stop()}},o)}))()}},{key:"rename",label:V.format("toolbarRenameButton"),showInContext:"manage",buttonProps:{icon:(0,i.jsx)(an,{})},confirmProps:function(t){var o=t.finish;return{onOpenChange:function(p,d){var x;(x=B.current)===null||x===void 0||x.resetFields(),p&&o()},getPopupContainer:function(p){return document.querySelector(".file-explorer .ant-pro-table")},zIndex:9999,description:(0,i.jsx)(Te.A,{submitter:!1,style:{width:300,paddingTop:10,paddingRight:10},formRef:B,children:(0,i.jsx)(ie.Z,{name:"targetFile"})})}},action:function(t){return E()(a()().mark(function o(){var c,p,d,x;return a()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return p=t.loading,d=t.finish,x=t.selectedRow,p(),C.abrupt("return",h(s,{name:r.name,sourceFile:x.path,targetFile:"./".concat((c=B.current)===null||c===void 0?void 0:c.getFieldValue("targetFile")),isMove:!0}).finally(function(){d(!0)}));case 3:case"end":return C.stop()}},o)}))()},disable:function(t){return t.isMultiple()||t.selectedRows.length==0}},{key:"unzip",label:V.format("toolbarUnzipButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(dn,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",De(s,{name:r.name,file:d.map(function(C){return C.path}),path:fe}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()},addDivider:!0},{key:"download",label:V.format("toolbarDownloadButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(cn.Z,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.selectedRows,p=t.loading,d=t.finish,p(),m.abrupt("return",j(s,{name:r.name,fileList:c.map(function(C){return C.path})}).then(function(C){var X=new Blob([C],{type:"application/zip"});(0,fn.saveAs)(X,"export.zip")}).finally(function(){d(!0)}));case 3:case"end":return m.stop()}},o)}))()}},{key:"export",label:V.format("toolbarExportButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(mn.Z,{})},disable:function(t){return r.type=="host"||t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",j(s,{name:r.name,fileList:d.map(function(C){return C.path}),enableExportToPath:!0}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()}},{key:"delete",showInContext:!0,action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",Ce(s,{name:r.name,fileList:d.map(function(C){return C.path})}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()}}]},"explorer-list"),(0,i.jsx)(ke,{onFinish:function(){var t;!((t=Z.current)===null||t===void 0)&&t.reset&&Z.current.reset()},ref:I}),(0,i.jsx)(Pn,{ref:k},"chmod")]})}),Rn=wn,On=e(85265),Cn=e(99922),yn=(0,u.forwardRef)(function(r,l){var s,O=(0,u.useState)(!1),n=N()(O,2),K=n[0],I=n[1],Z=(0,u.useState)(),k=N()(Z,2),B=k[0],U=k[1],_=(0,u.useRef)(),le=new Me.Uo("components.explorer"),$=(0,u.useContext)(be.Z),y=$.loading,g=(0,u.useRef)();return(0,u.useImperativeHandle)(l,function(){return{showContainer:function(P,w){U({name:(0,Ze.fi)(P,"/"),type:"container",workDir:w!=null?w:void 0}),I(!0)},showHost:function(P,w){U({name:P,type:"host",workDir:w}),I(!0)},showVolume:function(P){return E()(a()().mark(function w(){var D;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return y.show(),v.next=3,H("app",{name:P}).finally(function(){y.destroy()});case 3:D=v.sent,U({name:D.data.containerName,type:"container",workDir:D.data.path}),I(!0);case 6:case"end":return v.stop()}},w)}))()}}}),(0,i.jsxs)(i.Fragment,{children:[r.trigger?u.cloneElement(r.trigger,{onClick:function(){r.name&&r.type&&(U(r),I(!0))}}):null,(0,i.jsxs)(On.Z,{destroyOnHidden:!0,width:Se.R_,title:le.format("drawerTitle",{name:(s=r.title)!==null&&s!==void 0?s:B==null?void 0:B.name}),onClose:E()(a()().mark(function f(){var P;return a()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(y.show(),I(!1),(P=_.current)===null||P===void 0||P.close(),U(void 0),!r.onCloseDestroy){D.next=7;break}return D.next=7,oe("app");case 7:y.destroy();case 8:case"end":return D.stop()}},f)})),rootClassName:"file-explorer",open:K,children:[r.showConsole&&(0,i.jsx)(Cn.Z,{showFileExplorer:!1,ref:g}),K&&B&&(0,i.jsx)(Rn,q()(q()({ref:_},B),{},{onConsole:r.showConsole?function(f){var P;(P=g.current)===null||P===void 0||P.show({url:"/console/container/".concat(B.name),title:B.name,workDir:f})}:void 0}))]})]})}),Dn=yn},90581:function(Ie,Ee,e){var Pe=e(15009),q=e.n(Pe),we=e(99289),a=e.n(we),Re=e(5574),E=e.n(Re),he=e(3616),N=e(97269),u=e(38345),T=e(64317),ee=e(37476),Oe=e(62370),j=e(97462),G=e(11106),z=e(23345),ne=e(83622),Ce=e(83062),J=e(67294),De=e(1883),de=e(33160),re=e(58638),pe=e(63713),xe=e(75520),ve=e(36146),M=e(85893),ae=(0,J.forwardRef)(function(A,ce){var _e=(0,J.useState)(!1),b=E()(_e,2),L=b[0],F=b[1],H=(0,J.useRef)(),W=new ve.Uo("components.console"),oe=(0,J.useRef)();return(0,J.useImperativeHandle)(ce,function(){return{reset:function(){var h;(h=oe.current)===null||h===void 0||h.resetFields()}}}),(0,M.jsx)(N.A,{layout:"inline",submitter:!1,formRef:oe,children:(0,M.jsx)(u.Z,{ghost:!0,children:(0,M.jsxs)(z.Z,{children:[(0,M.jsx)(T.Z,{width:"sm",name:"entryCmd",placeholder:W.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(h){A.onChangeShell&&A.onChangeShell(h)}}),(0,M.jsx)(ee.Y,{modalProps:{width:he.ob,height:he.Ed},title:W.format("toolbarBatchCommandTitle"),name:"batchCommand",open:L,trigger:(0,M.jsx)(ne.ZP,{icon:(0,M.jsx)(De.Z,{}),children:W.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:H,isKeyPressSubmit:!0,onFinish:function(){var Q=a()(q()().mark(function h(te){return q()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:A.onBatchCommandFinish&&A.onBatchCommandFinish(te.shell.split(`
`)),F(!1);case 2:case"end":return ie.stop()}},h)}));return function(h){return Q.apply(this,arguments)}}(),onOpenChange:function(h){F(h),h&&H.current&&H.current.resetFields()},children:(0,M.jsx)(Oe.Z,{name:"shell",children:(0,M.jsx)(G.ZP,{theme:"dark",height:he.Ed})})}),(0,M.jsx)(ne.ZP,{onClick:function(){A.onChangeShell&&A.onChangeShell()},icon:(0,M.jsx)(de.Z,{}),type:"primary",children:ve.FD.format("listManageRefresh")}),(0,M.jsx)(j.Z,{name:["entryCmd"],children:function(h){var te=h.entryCmd;return(!te||te=="")&&(te="/bin/sh"),A.onOpenNewWindow&&(0,M.jsx)(pe.Link,{onClick:function(){A.onOpenNewWindowFinish&&A.onOpenNewWindowFinish()},target:"_blank",to:A.onOpenNewWindow({cmd:te}),children:(0,M.jsx)(Ce.Z,{title:W.format("toolbarOpenInNewWindowTip"),children:(0,M.jsx)(ne.ZP,{type:"dashed",icon:(0,M.jsx)(re.Z,{})})})})}}),(0,M.jsx)(xe.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})});Ee.Z=ae},49610:function(Ie,Ee,e){var Pe=e(5574),q=e.n(Pe),we=e(12323),a=e(52626),Re=e(87662),E=e(78267),he=e.n(E),N=e(4244),u=e.n(N),T=e(24078),ee=e(67294),Oe=e(85893),j,G,z,ne,Ce=(0,ee.forwardRef)(function(J,De){var de,re=(0,ee.useState)(),pe=q()(re,2),xe=pe[0],ve=pe[1],M=(0,ee.useState)(""),ae=q()(M,2),A=ae[0],ce=ae[1];function _e(){ne&&(j.reset(),G.fit(),j.focus(),ne.dispose()),z&&(z.close(),z=null)}return(0,ee.useImperativeHandle)(De,function(){return{start:function(L,F){_e(),G.fit(),F.width=j.cols,F.height=j.rows;var H=F?Object.keys(F).filter(function(W){return F&&F[W]}).map(function(W){return F&&F[W]?"".concat(W,"=").concat(F[W]):""}):[];z=new WebSocket((0,a.R)(L+"?"+H.join("&"))),z.addEventListener("message",function(W){var oe=JSON.parse(W.data),Q=oe.type;if(Q===L&&(j.write(oe.data),oe.data.indexOf("exec failed")!==-1)){_e();return}}),ne=j.onData(function(W){var oe={content:{command:W},type:L};z&&z.send(JSON.stringify(oe))}),ce(L),ve(F)},close:function(){_e()},fit:function(){return G.fit(),{width:j.cols,height:j.rows}},run:function(L){xe&&(L==null||L.forEach(function(F){var H={content:{command:F+`
`},type:A};z&&z.send(JSON.stringify(H))}))}}}),(0,ee.useEffect)(function(){return j=new N.Terminal(we.X),G=new E.FitAddon,j.loadAddon(G),j.open(document.getElementById("terminal-container-console")),G.fit(),j.onKey(function(b){var L=b.domEvent;if(L.ctrlKey&&L.key==="c"){var F=j.getSelection();if(F){navigator.clipboard.writeText(F).then(function(){j.clearSelection()}),L.preventDefault();return}}L.ctrlKey&&L.key==="v"&&(navigator.clipboard.readText().then(function(H){H&&j.input(H)}),L.preventDefault())}),(0,Re.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(b){b.data&&b.data.fontSize&&Object.assign(j.options,b.data)}),function(){_e()}},[]),(0,ee.useEffect)(function(){window.addEventListener("resize",function(){G.fit();var b={size:{width:j.cols,height:j.rows},type:A};A&&z&&z.send(JSON.stringify(b))})},[A]),(0,Oe.jsx)("div",{style:{height:(de=J.height)!==null&&de!==void 0?de:"100vh"},id:"terminal-container-console"})});Ee.Z=Ce}}]);
