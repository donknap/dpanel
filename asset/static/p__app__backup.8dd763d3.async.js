"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[550],{94359:function(N,b,e){e.d(b,{Z:function(){return H}});var T=e(5574),s=e.n(T),C=e(3089),m=e(98165),j=e(18429),l=e(8751),R=e(66212),E=e(14313),y=e(30159),f=e(87740),x=e(50888),P=e(66309),B=e(83062),W=e(36146),u=e(85893);function H(c){var n,M,A=new W.Uo("components.containerStatus"),i=c.status.split("."),F=s()(i,2),ee=F[0],_=F[1],g="";g=A.format(c.status,(n=c.statusValue)!==null&&n!==void 0?n:{});var D=(0,u.jsx)(u.Fragment,{});return _=="0"&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(C.Z,{}),color:"default",children:g})),_=="10"&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(m.Z,{spin:!0}),color:"processing",children:g})),_=="20"&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(j.Z,{}),color:"error",children:g})),_=="30"&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(l.Z,{}),color:"success",children:g})),_=="new"&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(R.Z,{}),children:g})),(_=="running"||_=="healthy"||_=="active"||_=="ready")&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(E.Z,{}),color:"success",children:g})),(_=="paused"||_=="pause"||_=="rollback_paused")&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(y.Z,{}),color:"warning",children:g})),(_=="waiting"||_=="starting"||_=="accepted")&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(f.Z,{}),children:g})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(_)&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(x.Z,{}),color:"processing",children:g})),(_=="error"||_=="down"||_=="failed")&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(j.Z,{}),color:"error",children:g})),["complete","completed","rollback_completed"].includes(_)&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(l.Z,{}),color:"success",children:g})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(_)&&(D=(0,u.jsx)(P.Z,{icon:(0,u.jsx)(j.Z,{}),color:"warning",children:g})),(0,u.jsx)(B.Z,{placement:"top",title:(M=c.tip)!==null&&M!==void 0?M:"",children:D})}},76428:function(N,b,e){e.d(b,{Z:function(){return m}});var T=e(25593),s=e(67294),C=e(85893);function m(j){return(0,C.jsx)(T.Z.Text,{copyable:!0,children:j.title})}},51100:function(N,b,e){e.d(b,{Z:function(){return j}});var T=e(4813),s=e(91604),C=e(1677),m=e(85893);function j(l){return l.showDragger?(0,m.jsx)(s.Z,{max:l.max?l.max:1,title:l.title,label:l.label,required:l.required,rules:[{required:l.required}],fieldProps:{multiple:!!(l.max&&l.max>1),name:"file",accept:l.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(E){return new Promise(function(y){var f;(0,T._)({path:(f=E.response.data.path)!==null&&f!==void 0?f:""}).then(function(x){y(!0)})})},onChange:function(E){E.file.status=="done"&&l.onFinish&&l.onFinish(E.fileList)}},name:l.name}):(0,m.jsx)(C.Z,{max:l.max?l.max:1,title:l.title,label:l.label,required:l.required,rules:[{required:l.required}],fieldProps:{multiple:!!(l.max&&l.max>1),name:"file",accept:l.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(E){return new Promise(function(y){var f;(0,T._)({path:(f=E.response.data.path)!==null&&f!==void 0?f:""}).then(function(x){y(!0)})})},onChange:function(E){E.file.status=="done"&&l.onFinish&&l.onFinish(E.fileList)}},name:l.name})}},65913:function(N,b,e){var T=e(5574),s=e.n(T),C=e(74330),m=e(67294),j=e(85893),l=(0,m.forwardRef)(function(R,E){(0,m.useImperativeHandle)(E,function(){return{show:function(){P(!0)},destroy:function(){P(!1)}}});var y=(0,m.useState)(!1),f=s()(y,2),x=f[0],P=f[1];return(0,j.jsx)(C.Z,{spinning:x,size:"default",children:R.children})});b.Z=l},6091:function(N,b,e){e.r(b),e.d(b,{default:function(){return ge}});var T=e(15009),s=e.n(T),C=e(99289),m=e.n(C),j=e(37476),l=e(86615),R=e(97462),E=e(5966),y=e(83622),f=e(67294),x=e(1699),P=e(82346);function B(L){return W.apply(this,arguments)}function W(){return W=m()(s()().mark(function L(k){return s()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,P.request)("/dpanel/api/pro/container-backup/import",{data:k,method:"POST"});case 2:return I.abrupt("return",I.sent);case 3:case"end":return I.stop()}},L)})),W.apply(this,arguments)}var u=e(3616),H=e(51100),c=e(36146),n=e(85893),M=(0,f.forwardRef)(function(L,k){(0,f.useImperativeHandle)(k,function(){return{}});var U=(0,f.useRef)(),I=new c.Uo("components.appDetail");return(0,n.jsx)(x.u,{showProTips:!0,access:["canSeeEnableCe","canSeeEnableDockerEnvLocal"],children:function(K){var z=K.canSeeEnableCe,O=K.canSeeEnableDockerEnvLocal;return O&&(0,n.jsxs)(j.Y,{modalProps:{width:u.ob},onFinish:function(){var r=m()(s()().mark(function a(o){var v,t,d;return s()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return v=o.tarFilePath,o.tarFileUpload&&o.tarFileUpload.length>0&&(v=(t=o.tarFileUpload[0].response.data.path)!==null&&t!==void 0?t:""),Z.next=4,B({type:o.type,tarFilePath:v});case 4:return d=Z.sent,L.onFinish&&L.onFinish(),Z.abrupt("return",!0);case 7:case"end":return Z.stop()}},a)}));return function(a){return r.apply(this,arguments)}}(),title:I.format("backupImportTitle"),formRef:U,trigger:(0,n.jsx)(y.ZP,{disabled:z,type:"primary",children:I.format("backupImportTitle")}),onOpenChange:function(){var a;(a=U.current)===null||a===void 0||a.resetFields()},children:[(0,n.jsx)(l.Z.Group,{label:I.format("backupImportType"),name:"type",initialValue:"upload",options:I.option("backupImportTypeOption",["upload"])}),(0,n.jsx)(R.Z,{name:["type"],children:function(a){var o=a.type;if(o=="upload")return(0,n.jsx)(H.Z,{required:!0,label:I.format("backupImportTarFileUpload"),name:"tarFileUpload",accept:".snapshot"});if(o=="serverPath")return(0,n.jsx)(E.Z,{required:!0,rules:[{required:!0}],name:"tarFilePath",label:I.format("backupImportTarFilePath")})}})]})}})}),A=M,i=e(5574),F=e.n(i),ee=e(65913),_=e(85265),g=e(26412),D=e(42075),ne=e(96074),S=e(25593),te=e(66309),V=e(2487),Q=e(70146),Y=e(5251),ie=e(45605),oe=e(58638),le=e(38345),ue=e(76428),ce=(0,f.forwardRef)(function(L,k){(0,f.useImperativeHandle)(k,function(){return{show:function(d){return m()(s()().mark(function p(){var Z;return s()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,Q.iD)({id:d});case 2:Z=h.sent,z(Z.data.detail),o(!0);case 5:case"end":return h.stop()}},p)}))()}}});var U=(0,f.useRef)(),I=(0,f.useState)(),$=F()(I,2),K=$[0],z=$[1],O=(0,f.useState)(!1),r=F()(O,2),a=r[0],o=r[1],v=new c.Uo("components.appDetail");return(0,n.jsx)(_.Z,{title:v.format("titleBackup"),open:a,onClose:function(){o(!1)},width:u.R_,children:(0,n.jsx)(ee.Z,{ref:U,children:K&&K.map(function(t){var d,p,Z=[],J=[];return t.NetworkSettings&&t.NetworkSettings.Ports&&Object.entries(t.NetworkSettings.Ports).map(function(h){var w=F()(h,2),G=w[0],X=w[1],je=X!=null?X:[{HostPort:null,HostIp:""}],Ee=G.split("/"),re=F()(Ee,2),ae=re[0],se=re[1];je.map(function(q){q.HostPort?Z.push({PrivatePort:ae,Type:se,IP:q.HostIp,PublicPort:q.HostPort}):J.push({PrivatePort:ae,Type:se,IP:"",PublicPort:""})})}),(0,n.jsx)(le.Z,{title:(0,n.jsx)(ie.Z,{}),subTitle:v.format("titleBasic"),ghost:!0,children:(0,n.jsxs)(g.Z,{column:1,bordered:!0,children:[(0,n.jsx)(g.Z.Item,{label:c.FD.format("listName"),children:(0,n.jsx)(D.Z,{split:(0,n.jsx)(ne.Z,{type:"vertical"}),children:(0,n.jsx)(S.Z.Text,{children:(0,Y.fi)(t.Name,"/")})})}),(0,n.jsx)(g.Z.Item,{label:c.FD.format("listImageName"),children:(0,n.jsxs)(D.Z,{split:(0,n.jsx)(ne.Z,{type:"vertical"}),children:[(0,n.jsx)(S.Z.Text,{copyable:!0,children:t.Config.Image}),(0,n.jsx)(te.Z,{color:"blue",children:t.EnableImage?c.FD.format("listHas"):c.FD.format("listHasNot")})]})}),(0,n.jsx)(g.Z.Item,{label:c.FD.format("listPort"),children:(0,n.jsx)(D.Z,{size:"large",wrap:!0,children:[].concat(Z,J).map(function(h,w){return(0,n.jsx)(te.Z,{color:h.PublicPort?"#2db7f5":"warning",icon:h.PublicPort?(0,n.jsx)(oe.Z,{}):"",style:{marginBottom:10,marginRight:15,width:210},children:h.PublicPort?"".concat(h.PublicPort?h.IP+":"+h.PublicPort+" -> ":"").concat(h.PrivatePort,"/").concat(h.Type):"".concat(h.PrivatePort,"/").concat(h.Type)},w)})},"space")}),t.State.Running&&t.NetworkSettings.Networks&&Object.keys(t.NetworkSettings.Networks).map(function(h,w){return(0,n.jsx)(g.Z.Item,{label:h,children:h=="host"?c.FD.format("listNetworkUseHost"):(0,n.jsxs)(D.Z,{direction:"vertical",children:[(0,n.jsx)(ue.Z,{title:t.NetworkSettings.Networks[h].IPAddress}),t.NetworkSettings.Networks[h].Gateway,t.NetworkSettings.Networks[h].MacAddress]})},w)}),(0,n.jsx)(g.Z.Item,{label:c.FD.format("listEnv"),children:(0,n.jsx)(V.Z,{dataSource:(d=t.Config.Env)!==null&&d!==void 0?d:[],renderItem:function(w){var G=w.split("=");return(0,n.jsxs)(V.Z.Item,{children:[(0,n.jsx)(S.Z.Text,{code:!0,children:G[0]})," = ",(0,n.jsx)(S.Z.Text,{copyable:!0,children:G.slice(1).join("=")})]},G[0])}})}),t.Mounts&&t.Mounts.length>0&&(0,n.jsx)(g.Z.Item,{label:c.FD.format("listHostPath"),children:(0,n.jsx)(V.Z,{dataSource:(p=t.Mounts)!==null&&p!==void 0?p:[],renderItem:function(w){return(0,n.jsxs)(V.Z.Item,{children:[(0,n.jsx)(S.Z.Text,{code:!0,children:w.Source})," : ",(0,n.jsx)(S.Z.Text,{children:w.Destination})]},w.Source)}})})]})},t.Name)})})})}),de=ce,pe=e(94359),me=e(55681),fe=e(24963),he=e(99611),_e=e(87740),ve=e(87784),Pe=e(74453);function ge(){var L=new c.Uo("app"),k=(0,P.useAccess)(),U=(0,f.useRef)(),I=(0,P.useModel)("subscriber"),$=(0,f.useRef)(),K=(0,f.useContext)(fe.Z),z=K.message;return(0,n.jsxs)(Pe._z,{children:[(0,n.jsx)(de,{ref:$}),(0,n.jsx)(me.Co,{rowKey:"id",columns:[{title:c.FD.format("listContainerName"),dataIndex:"containerId",width:150,render:function(r,a,o,v,t){return(0,n.jsx)(S.Z.Link,{onClick:function(){var p;(p=$.current)===null||p===void 0||p.show(a.id)},children:(0,Y.fi)(a.containerId,"/")})}},{title:c.FD.format("listFilePath"),search:!1,width:300,render:function(r,a,o,v,t){var d=a.setting.backupTar;return(0,n.jsx)("span",{style:{wordBreak:"break-word"},children:d.substring(d.lastIndexOf("/",d.lastIndexOf("/")-1))})}},{title:c.FD.format("listSize"),search:!1,width:100,render:function(r,a,o,v,t){return a.setting.size?(0,n.jsx)(S.Z.Text,{children:(0,Y.FI)(a.setting.size)}):"-"}},{title:c.FD.format("listContainerVolume"),search:!1,minWidth:100,render:function(r,a,o,v,t){return(0,n.jsx)(D.Z,{wrap:!0,children:a.setting.volumePathList.map(function(d){return d})})}},{title:c.FD.format("listStatus"),search:!1,width:80,render:function(r,a,o,v,t){var d,p;return(0,n.jsx)(pe.Z,{tip:(d=a.setting.error)!==null&&d!==void 0?d:"",status:"status.".concat((p=a.setting.status)!==null&&p!==void 0?p:"30")},a.id)}},{title:c.FD.format("listCreatedAt"),search:!1,width:200,render:function(r,a,o,v,t){return new Date(a.createdAt).toLocaleString()}}],request:function(){var O=m()(s()().mark(function r(a,o,v){var t;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,Q.Zy)({containerId:a.containerId,page:a.current,pageSize:a.pageSize});case 2:return t=p.sent,p.abrupt("return",{data:t.data.list,success:!0,total:t.data.total});case 4:case"end":return p.stop()}},r)}));return function(r,a,o){return O.apply(this,arguments)}}(),rowSelection:k.canSeeContainerBackupManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:U,quickToolbar:{render:function(r){return(0,n.jsx)(D.Z,{children:(0,n.jsx)(A,{onFinish:function(){var o;!((o=U.current)===null||o===void 0)&&o.reloadAndRest&&U.current.reloadAndRest()}},"backup-import")})}},actions:[{key:"view",label:c.FD.format("listManageView"),showInContext:"manage",showInOperator:!0,buttonProps:{icon:(0,n.jsx)(he.Z,{})},disable:function(r){return r.isMultiple()||r.selectedRow&&r.selectedRow.setting.status!="30"},action:function(r){return m()(s()().mark(function a(){var o,v,t;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:v=r.finish,t=r.selectedRow,v(!0),(o=$.current)===null||o===void 0||o.show(t.id);case 3:case"end":return p.stop()}},a)}))()}},{key:"recover",label:c.FD.format("listManageUnpause"),showInContext:"manage",showInOperator:!0,buttonProps:{icon:(0,n.jsx)(_e.Z,{})},confirmProps:{description:L.format("recycleRestoreConfirm")},action:function(r){return m()(s()().mark(function a(){var o,v;return s()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=r.finish,v=r.selectedRow,o(!0),d.abrupt("return",(0,Q.SR)({id:v.id,enableForce:!1}).then(function(){z.success(c.FD.format("finish"))}).finally(function(){o()}));case 3:case"end":return d.stop()}},a)}))()},disable:function(r){return r.isMultiple()||r.selectedRow&&r.selectedRow.setting.status!="30"}},{key:"stop",label:c.FD.format("listManageStop"),showInContext:"manage",showInOperator:!0,buttonProps:{icon:(0,n.jsx)(ve.Z,{})},disable:function(r){return r.isMultiple()||r.selectedRow&&r.selectedRow.setting.status!="10"},action:function(r){return m()(s()().mark(function a(){var o;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.selectedRow,I.progress.close("container:backup:".concat(o.id)),setTimeout(function(){var d;!((d=U.current)===null||d===void 0)&&d.reloadAndRest&&U.current.reloadAndRest()},500),t.abrupt("return",!1);case 4:case"end":return t.stop()}},a)}))()}},{key:"delete",action:function(r){return m()(s()().mark(function a(){var o,v,t;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=r.loading,v=r.finish,t=r.selectedRows,o(),p.abrupt("return",(0,Q.VE)({id:t.map(function(Z){return Z.id})}).finally(function(){v(!0)}));case 3:case"end":return p.stop()}},a)}))()}}]})]})}},70146:function(N,b,e){e.d(b,{SR:function(){return P},VE:function(){return f},Zy:function(){return E},iD:function(){return W},vG:function(){return H},yB:function(){return l}});var T=e(15009),s=e.n(T),C=e(99289),m=e.n(C),j=e(82346);function l(n){return R.apply(this,arguments)}function R(){return R=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,j.request)("/dpanel/api/app/container-backup/create",{data:M,method:"POST"});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},n)})),R.apply(this,arguments)}function E(n){return y.apply(this,arguments)}function y(){return y=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,j.request)("/dpanel/api/app/container-backup/get-list",{method:"POST",data:M}));case 1:case"end":return i.stop()}},n)})),y.apply(this,arguments)}function f(n){return x.apply(this,arguments)}function x(){return x=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,j.request)("/dpanel/api/app/container-backup/delete",{method:"POST",data:M}));case 1:case"end":return i.stop()}},n)})),x.apply(this,arguments)}function P(n){return B.apply(this,arguments)}function B(){return B=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,j.request)("/dpanel/api/app/container-backup/restore",{method:"POST",data:M}));case 1:case"end":return i.stop()}},n)})),B.apply(this,arguments)}function W(n){return u.apply(this,arguments)}function u(){return u=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,j.request)("/dpanel/api/app/container-backup/get-detail",{method:"POST",data:M}));case 1:case"end":return i.stop()}},n)})),u.apply(this,arguments)}function H(n){return c.apply(this,arguments)}function c(){return c=m()(s()().mark(function n(M){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,j.request)("/dpanel/api/app/site/restore",{data:M,method:"POST"});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},n)})),c.apply(this,arguments)}},4813:function(N,b,e){e.d(b,{_:function(){return l}});var T=e(15009),s=e.n(T),C=e(99289),m=e.n(C),j=e(82346);function l(E){return R.apply(this,arguments)}function R(){return R=m()(s()().mark(function E(y){return s()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,j.request)("/dpanel/api/common/attach/delete",{method:"POST",data:y});case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},E)})),R.apply(this,arguments)}}}]);
