"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{94359:function(w,V,e){e.d(V,{Z:function(){return U}});var z=e(5574),T=e.n(z),Y=e(3089),y=e(98165),S=e(18429),F=e(8751),J=e(66212),W=e(14313),Q=e(30159),N=e(87740),I=e(50888),i=e(66309),g=e(83062),d=e(36146),t=e(85893);function U(B){var R,_,c=new d.Uo("components.containerStatus"),p=B.status.split("."),a=T()(p,2),E=a[0],n=a[1],o="";o=c.format(B.status,(R=B.statusValue)!==null&&R!==void 0?R:{});var r=(0,t.jsx)(t.Fragment,{});return n=="0"&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(Y.Z,{}),color:"default",children:o})),n=="10"&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(y.Z,{spin:!0}),color:"processing",children:o})),n=="20"&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(S.Z,{}),color:"error",children:o})),n=="30"&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(F.Z,{}),color:"success",children:o})),n=="new"&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(J.Z,{}),children:o})),(n=="running"||n=="healthy"||n=="active"||n=="ready")&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(W.Z,{}),color:"success",children:o})),(n=="paused"||n=="pause"||n=="rollback_paused")&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(Q.Z,{}),color:"warning",children:o})),(n=="waiting"||n=="starting"||n=="accepted")&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(N.Z,{}),children:o})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(n)&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(I.Z,{}),color:"processing",children:o})),(n=="error"||n=="down"||n=="failed")&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(S.Z,{}),color:"error",children:o})),["complete","completed","rollback_completed"].includes(n)&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(F.Z,{}),color:"success",children:o})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(n)&&(r=(0,t.jsx)(i.Z,{icon:(0,t.jsx)(S.Z,{}),color:"warning",children:o})),(0,t.jsx)(g.Z,{placement:"top",title:(_=B.tip)!==null&&_!==void 0?_:"",children:r})}},44349:function(w,V,e){var z=e(97857),T=e.n(z),Y=e(15009),y=e.n(Y),S=e(99289),F=e.n(S),J=e(74763),W=e(17186),Q=e(5966),N=e(86250),I=e(67294),i=e(85893),g=(0,I.forwardRef)(function(d,t){var U=(0,I.useRef)();(0,I.useImperativeHandle)(t,function(){return{addItem:function(R){function _(c,p,a){return R.apply(this,arguments)}return _.toString=function(){return R.toString()},_}(function(R,_,c){var p,a=(p=U.current)===null||p===void 0?void 0:p.getList(),E;if(a==null||a.forEach(function(r,$){r[R]==_[R]&&(E=$)}),!(0,J.k)(E)&&c){var n;(n=U.current)===null||n===void 0||n.remove(E),E=void 0}if(!E){var o;(o=U.current)===null||o===void 0||o.add(_)}}),removeItemByKey:function(_,c){return F()(y()().mark(function p(){var a,E;return y()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return E=(a=U.current)===null||a===void 0?void 0:a.getList(),E==null||E.forEach(function(r,$){if(r[_]==c){var G;(G=U.current)===null||G===void 0||G.remove($);return}}),o.abrupt("return");case 3:case"end":return o.stop()}},p)}))()},clear:function(_){if(!_){var c;_=(c=U.current)===null||c===void 0||(c=c.getList())===null||c===void 0?void 0:c.map(function(a,E){return E})}if(_){var p;(p=U.current)===null||p===void 0||p.remove(_)}},getList:function(){var _;return(_=U.current)===null||_===void 0?void 0:_.getList()}}});var B={};return d.hideCopyButton===!0&&(B.copyIconProps=!1),d.hideDeleteButton===!0&&(B.deleteIconProps=!1),(0,i.jsx)(W.u,T()(T()({initialValue:d.initialValue,label:d.label,name:d.name,actionRef:U,creatorButtonProps:d.showAddButton?{creatorButtonText:d.label?d.label:d.showAddButtonLabel?d.showAddButtonLabel:d.name}:!1,min:d.min?d.min:0},B),{},{children:function(_,c,p){return(0,i.jsx)(N.Z,{justify:d.justify,gap:d.gap,children:d.items.map(function(a){return a.render?(0,i.jsx)("div",{children:a.render&&a.render(_,c,p)},"".concat(d.name,"-").concat(a.name,"-").concat(_.key)):(0,i.jsx)(Q.Z,{width:a.width,name:a.name,label:a.label,required:a.required,rules:[{required:a.required}],disabled:a.disabled,placeholder:a.placeholder},"".concat(d.name,"-").concat(a.name,"-").concat(_.key))})})}}))});V.Z=g},36435:function(w,V,e){var z=e(15009),T=e.n(z),Y=e(64599),y=e.n(Y),S=e(99289),F=e.n(S),J=e(9783),W=e.n(J),Q=e(5574),N=e.n(Q),I=e(67294),i=e(184),g=e(38345),d=e(97269),t=e(97321),U=e(97462),B=e(64317),R=e(5966),_=e(86615),c=e(68602),p=e(83622),a=e(83403),E=e(24963),n=e(1699),o=e(29177),r=e(1883),$=e(43425),G=e(44349),q=e(3616),k=e(36146),v=e(85893),ee=(0,I.forwardRef)(function(K,ne){var ae=(0,I.useState)(!1),L=N()(ae,2),P=L[0],m=L[1],l=(0,I.useRef)(),H=(0,I.useContext)(E.Z),A=H.message,M=(0,I.useState)([]),s=N()(M,2),X=s[0],te=s[1],b=new k.Uo("components.permissionButton"),_e=W()(W()(W()(W()(W()({},a.W6.CONTAINER,"Id"),a.W6.APPSTORE,"name"),a.W6.COMPOSE,"name"),a.W6.REGISTRY,"serverAddress"),a.W6.DOCKER_ENV,"name"),oe=W()(W()(W()(W()(W()({},a.W6.CONTAINER,"name"),a.W6.APPSTORE,"name"),a.W6.COMPOSE,"name"),a.W6.REGISTRY,"title"),a.W6.DOCKER_ENV,"title"),re=_e[K.type],le=oe[K.type],ie=K.selected.map(function(f){return f[_e[K.type]]});return I.useEffect(function(){if(P){if(!K.selected||K.selected.length==0){A.error(k.FD.format("title.noDataSelect")),m(!1);return}(0,c.dP)({permission:{uri:K.type,key:re,value:ie}}).then(function(f){var u;(u=l.current)===null||u===void 0||u.setFieldValue("list",Object.keys(f.data.list).map(function(D){return{name:D,type:f.data.list[D].type,users:f.data.list[D].users}}))}),(0,c.lE)().then(function(f){var u,D=(u=f.data)===null||u===void 0||(u=u.list)===null||u===void 0?void 0:u.map(function(O){return{label:O.username,value:O.username}});te(D)})}},[P]),(0,v.jsx)(n.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,v.jsxs)(i.a,{name:"create",title:b.format("drawerTitle"),open:P,onOpenChange:function(u){if(!u){var D;(D=l.current)===null||D===void 0||D.resetFields()}m(u)},drawerProps:{forceRender:!0,width:q.R_},formRef:l,trigger:(0,v.jsx)(p.ZP,{icon:(0,v.jsx)(o.Z,{}),children:b.format("drawerTriggerButton")}),onFinish:function(){var f=F()(T()().mark(function u(D){var O,C,h;return T()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:O=y()(D.list),j.prev=1,O.s();case 3:if((C=O.n()).done){j.next=9;break}return h=C.value,j.next=7,(0,c.Db)({usernames:h.users,permissionType:h.type,permission:{uri:K.type,key:re,showKey:le,value:[h.name]}});case 7:j.next=3;break;case 9:j.next=14;break;case 11:j.prev=11,j.t0=j.catch(1),O.e(j.t0);case 14:return j.prev=14,O.f(),j.finish(14);case 17:A.success(k.FD.format("finish")),m(!1),K.onSuccess();case 20:case"end":return j.stop()}},u,null,[[1,11,14,17]])}));return function(u){return f.apply(this,arguments)}}(),children:[(0,v.jsxs)(g.Z,{ghost:!0,title:(0,v.jsx)(r.Z,{}),subTitle:b.format("batchTitle"),children:[(0,v.jsx)(d.A.Item,{name:"type",style:{marginBottom:0},children:(0,v.jsx)(t.Z.Group,{defaultValue:"admin",onChange:function(u){var D,O,C=(D=l.current)===null||D===void 0?void 0:D.getFieldValue("list");C.forEach(function(h){h.type=u,h.users=[]}),(O=l.current)===null||O===void 0||O.setFieldValue("list",C)},children:["admin","restricted","public"].map(function(f){return(0,v.jsx)(t.Z,{style:{width:240},title:b.format("dataTypeOption.".concat(f)),description:b.format("dataTypeDescOption.".concat(f)),value:f},f)})})}),(0,v.jsx)(U.Z,{name:["type"],children:function(u){var D=u.type;if(D==="restricted")return(0,v.jsx)(B.Z,{mode:"multiple",name:"usernames",label:b.format("formUsernames"),onChange:function(C){var h,x,j=(h=l.current)===null||h===void 0?void 0:h.getFieldValue("list");j.forEach(function(Z){Z.users=C}),(x=l.current)===null||x===void 0||x.setFieldValue("list",j)},rules:[{required:!0}],request:F()(T()().mark(function O(){var C,h,x;return T()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!(X.length>0)){Z.next=2;break}return Z.abrupt("return",X);case 2:return Z.next=4,(0,c.lE)();case 4:return h=Z.sent,x=(C=h.data)===null||C===void 0||(C=C.list)===null||C===void 0?void 0:C.map(function(se){return{label:se.username,value:se.username}}),te(x),Z.abrupt("return",x);case 8:case"end":return Z.stop()}},O)}))})}})]}),(0,v.jsx)(g.Z,{ghost:!0,title:(0,v.jsx)($.Z,{}),subTitle:b.format("dataTitle"),children:(0,v.jsx)(G.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:b.format("dataName"),render:function(u,D,O){var C=O.getCurrentRowData();return(0,v.jsx)(R.Z,{disabled:!0,label:b.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:b.format("dataType"),render:function(u,D,O){var C=O.getCurrentRowData();return(0,v.jsx)(_.Z.Group,{label:b.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(h){return{label:b.format("dataTypeOption.".concat(h)),value:h}})})}},{name:"users",label:b.format("dataUsers"),render:function(u,D,O){return(0,v.jsx)(U.Z,{name:["type"],children:function(h){var x=h.type;if(x=="restricted")return(0,v.jsx)(B.Z,{width:"sm",mode:"tags",name:"users",label:b.format("dataUsers"),options:X})}})}}]})})]})})});V.Z=ee},98163:function(w,V,e){e.r(V),e.d(V,{default:function(){return o}});var z=e(15009),T=e.n(z),Y=e(99289),y=e.n(Y),S=e(80821),F=e(94359),J=e(77273),W=e(36435),Q=e(98510),N=e(83403),I=e(24963),i=e(87662),g=e(36146),d=e(86548),t=e(82061),U=e(74453),B=e(82346),R=e(83622),_=e(42075),c=e(96074),p=e(25593),a=e(83062),E=e(67294),n=e(85893);function o(){var r=(0,E.useRef)(),$=(0,E.useRef)(),G=(0,B.useModel)("@@initialState"),q=G.refresh,k=G.initialState,v=(0,E.useContext)(I.Z),ee=v.message,K=(0,B.useLocation)(),ne=(0,B.useNavigate)(),ae=new g.Uo("system.env");return(0,E.useEffect)(function(){var L=K.state;L&&(ne(".",{replace:!0}),L&&L.name&&(0,i.Kg)({enableCertContent:!0}).then(function(P){var m,l=P.data.list.find(function(H){return H.name==L.name});l&&((m=$.current)===null||m===void 0||m.edit(l))}))},[K.state]),(0,n.jsx)(U._z,{header:{extra:[(0,n.jsx)(J.Z,{trigger:(0,n.jsx)(R.ZP,{type:"primary",children:ae.format("createButton")}),ref:$,onFinish:y()(T()().mark(function L(){var P,m,l;return T()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(l=K.state,!(l&&l.name)){A.next=6;break}return A.next=4,(0,i.vC)({name:l.name});case 4:return ne(K.pathname,{replace:!0,state:null}),A.abrupt("return");case 6:q(),!((P=r.current)===null||P===void 0)&&P.reloadAndRest&&((m=r.current)===null||m===void 0||m.reloadAndRest());case 8:case"end":return A.stop()}},L)}))},"dockerEnvCreate")]},children:(0,n.jsx)(Q.C,{rowKey:"name",columns:[{title:g.FD.format("listName"),dataIndex:"name"},{title:g.FD.format("listTitle"),dataIndex:"title"},{title:g.FD.format("listStatus"),render:function(P,m,l,H,A){var M,s;return(0,n.jsx)(F.Z,{status:"swarm.".concat((M=m.dockerStatus)!==null&&M!==void 0&&M.available?"active":"down"),tip:"".concat((s=m.dockerStatus)===null||s===void 0?void 0:s.message)})}},{title:g.FD.format("listTargetAddress"),dataIndex:"address"},{title:g.FD.format("listManage"),width:50,search:!1,render:function(P,m,l,H,A){return(0,n.jsx)(_.Z,{split:(0,n.jsx)(c.Z,{type:"vertical"}),children:(0,n.jsx)(p.Z.Link,{onClick:function(){var s;(s=$.current)===null||s===void 0||s.edit(m)},children:(0,n.jsx)(a.Z,{title:g.FD.format("listManageEdit"),children:(0,n.jsx)(d.Z,{})})},m.name)})}}],pagination:!1,request:y()(T()().mark(function L(){var P;return T()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,i.Kg)({enableCertContent:!0});case 2:return P=l.sent,l.abrupt("return",{data:P.data.list,total:P.data.list.length});case 4:case"end":return l.stop()}},L)})),search:!1,actionRef:r,quickToolbarRender:function(P){var m=P.selectedRows,l=P.finish,H=P.loading;return(0,n.jsxs)(_.Z,{size:16,children:[(0,n.jsx)(W.Z,{type:N.W6.DOCKER_ENV,selected:m,onSuccess:function(){var M,s;return!((M=r.current)===null||M===void 0)&&M.reloadAndRest&&((s=r.current)===null||s===void 0||s.reloadAndRest()),!0}},"permissionButton"),(0,n.jsx)(S.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,n.jsx)(t.Z,{})},action:y()(T()().mark(function A(){return T()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!m.find(function(X){return X.default})){s.next=3;break}return ee.warning(g.FD.format("systemEnvDefaultCannotDelete")),s.abrupt("return",!1);case 3:return H(),s.abrupt("return",(0,i._g)({name:m.map(function(X){return X.name})}).finally(function(){l(!0)}));case 5:case"end":return s.stop()}},A)})),onSuccess:function(){var M,s;return!((M=r.current)===null||M===void 0)&&M.reloadAndRest&&((s=r.current)===null||s===void 0||s.reloadAndRest()),!0},onError:function(){var M,s;return!((M=r.current)===null||M===void 0)&&M.reset&&((s=r.current)===null||s===void 0||s.reset()),!0},confirmProps:{showCommonConfirm:!0},children:g.FD.format("listManageDeleteBatch")})]})}})})}}}]);
