"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(Q,U,e){var W=e(9783),l=e.n(W),j=e(19632),p=e.n(j),d=e(97857),m=e.n(d),S=e(5574),I=e.n(S),B=e(89035),O=e(45605),b=e(64317),Y=e(31199),g=e(5966),h=e(38345),x=e(17186),f=e(24739),R=e(42075),F=e(83622),A=e(83062),T=e(85576),C=e(67294),H=e(11106),Z=e(12491),P=e(62597),D=e(79245),o=e(3616),s=e(36146),a=e(85893),n="docker-image",$=(0,C.forwardRef)(function(_,q){var G=(0,C.useState)(n),ee=I()(G,2),z=ee[0],K=ee[1],E=(0,C.useRef)(),J=(0,C.useState)(""),ne=I()(J,2),ae=ne[0],oe=ne[1],L=new s.Uo("components.appForm");(0,C.useImperativeHandle)(q,function(){return{addEnvItem:function(t){var i,c=(i=E.current)===null||i===void 0?void 0:i.getList(),u=!1;if(c==null||c.map(function(M){if(M.name==t.name){u=!0;return}}),!u){var v;(v=E.current)===null||v===void 0||v.add(t)}},addEnvNameValue:function(t,i){this.addEnvItem({name:t,value:i})},clear:function(){var t;(t=E.current)===null||t===void 0||(t=t.getList())===null||t===void 0||t.map(function(i,c){var u;(u=E.current)===null||u===void 0||u.remove(c)})}}});function re(r){try{var t,i;r==""&&(r=te());for(var c=(t=(i=E.current)===null||i===void 0||(i=i.getList())===null||i===void 0?void 0:i.length)!==null&&t!==void 0?t:0,u=c;u>=0;u--){var v,M,w=(v=E.current)===null||v===void 0?void 0:v.get(u);c-=1,(M=E.current)===null||M===void 0||M.remove(u)}var V=r.split(`
`),X=c+1;V.map(function(k){var y,N=k.split("=");N.length<2||((y=E.current)===null||y===void 0||y.add({name:N[0],value:N.slice(1).join("=")},X),X++)})}catch(k){console.log(k)}}function _e(){z!="code"?K("code"):K(n)}function te(){if(E&&E.current&&E.current.getList){var r,t=(r=E.current)===null||r===void 0?void 0:r.getList();if(t){var i=[];return t.forEach(function(c){i.push("".concat(c.name,"=").concat(c.value))}),i.join(`
`)}else return""}else return""}function ue(r){var t,i,c,u,v,M,w={},V={help:(0,D.y)((t=r.rule)===null||t===void 0?void 0:t.kind,P.fp.EnvValueTypeOnePanel)?L.formatOnePanel(r.name):L.formatUser(r.labels),name:"value",label:L.format("createEnvFormValue"),rules:[{required:_.requireValue?!0:(0,D.y)((i=r.rule)===null||i===void 0?void 0:i.kind,P.fp.EnvValueRuleRequired)}],addonAfter:!0,disabled:_.showDisableValue||(0,D.y)((c=r.rule)===null||c===void 0?void 0:c.kind,P.fp.EnvValueRuleDisabled),placeholder:r.label};if((0,D.y)((u=r.rule)===null||u===void 0?void 0:u.kind,P.fp.EnvValueTypeSelect)){var X;return(0,a.jsx)(b.Z,m()(m()({fieldProps:w},V),{},{initialValue:r.value,width:_.showInDrawer?"sm":"md",options:((X=r.rule)===null||X===void 0?void 0:X.option)&&r.rule.option.map(function(y){return{label:y.name,value:y.value}})}),r.name)}else if((0,D.y)((v=r.rule)===null||v===void 0?void 0:v.kind,P.fp.EnvValueTypeSelectMultiple)){var k;return(0,a.jsx)(b.Z,m()(m()({mode:"tags"},V),{},{fieldProps:w,convertValue:function(N){return Array.isArray(N)?N:N.split(",")},width:_.showInDrawer?"sm":"md",options:((k=r.rule)===null||k===void 0?void 0:k.option)&&r.rule.option.map(function(y){return{label:y.name,value:y.value}})}),r.name)}else return(0,D.y)((M=r.rule)===null||M===void 0?void 0:M.kind,P.fp.EnvValueTypeNumber)?(0,a.jsx)(Y.Z,m()(m()({fieldProps:w},V),{},{width:_.showInDrawer?"sm":"md",rules:[].concat(p()(V.rules),[{pattern:new RegExp("^[0-9]*$")}])}),r.name):(0,a.jsx)(g.Z,m()(m()({fieldProps:w},V),{},{width:_.showInDrawer?"sm":"md"}),r.name)}return(0,a.jsxs)(h.Z,m()(m()({headerBordered:!0,extra:(_.showCodeMode||_.showImportButton)&&(0,a.jsxs)(R.Z,{children:[_.showImportButton&&(0,a.jsx)("div",{style:{marginBottom:"-25px"},children:(0,a.jsx)(Z.Z,{title:L.format("createEnvFormEnvImport"),onImport:function(t){return re(t),!0},onLoad:function(t){if(t.indexOf("=")<0)throw new Error(s.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),_.showCodeMode?(0,a.jsx)(F.ZP,{icon:(0,a.jsx)(B.Z,{}),type:z=="code"?"primary":"default",onClick:_e,children:L.format("createEnvFormEnvCode")},"code"):""]})},_.drawerProps),{},{children:[(0,a.jsx)(x.u,{style:{marginTop:10},name:_.name?_.name:"environment",actionRef:E,creatorButtonProps:_.showAddButton?{creatorButtonText:_.addButtonLabel?_.addButtonLabel:L.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:_.showDeleteButton,actionRender:function(t,i,c,u){var v,M,w=(v=E.current)===null||v===void 0?void 0:v.get(t.key);return w&&(0,D.y)((M=w.rule)===null||M===void 0?void 0:M.kind,P.fp.EnvValueRuleInEnvFile)?[(0,a.jsx)(A.Z,{title:L.format("createEnvFormListInEnvFile"),children:(0,a.jsx)(F.ZP,{type:"text",icon:(0,a.jsx)(O.Z,{})})},"inEnvFile")]:[c[0]]},min:100,label:_.listLabel,transform:function(t,i,c){return l()({},i,t.map(function(u){return Array.isArray(u.value)?u.value=u.value.filter(function(v){return v!=""}).join(","):u.value=u.value.toString(),u}))},children:function(t,i,c){var u,v=c.getCurrentRowData();return(0,a.jsxs)(f.UW,{style:{marginBottom:"5px"},children:[(0,a.jsx)(g.Z,{width:_.showInDrawer?"sm":"md",name:"name",label:L.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:_.showDisableName||(0,D.y)((u=v.rule)===null||u===void 0?void 0:u.kind,P.fp.EnvValueRuleInEnvFile),placeholder:L.format("createEnvFormName")},i),ue(v)]})}}),_.showCodeMode&&(0,a.jsx)(T.Z,{width:o.ob,open:z=="code",onCancel:function(){return K("docker-image")},onOk:function(){re(ae),K("docker-image")},children:(0,a.jsx)(H.ZP,{onChange:function(t){return oe(t)},value:te(),height:o.Ed,theme:"dark"})})]}))});U.Z=$},12491:function(Q,U,e){e.d(U,{Z:function(){return x}});var W=e(5574),l=e.n(W),j=e(3616),p=e(24963),d=e(36146),m=e(88484),S=e(57546),I=e(62370),B=e(11106),O=e(42075),b=e(83622),Y=e(85576),g=e(67294),h=e(85893);function x(f){var R=(0,g.useContext)(p.Z),F=R.message,A=R.notice,T=(0,g.useRef)(null),C=(0,g.useState)(!1),H=l()(C,2),Z=H[0],P=H[1],D=(0,g.useState)(""),o=l()(D,2),s=o[0],a=o[1];(0,g.useEffect)(function(){f.data&&a(f.data)},[f.data]);var n=function(){T.current&&(T.current.click(),T.current.onchange=function(_){if(!_||!_.target)return"";var q=new FileReader;q.onload=function(z){var K,E,J=(K=z.target)===null||K===void 0?void 0:K.result;if(f.onLoad)try{f.onLoad&&f.onLoad(J)}catch(ne){A.error(ne);return}a(J),typeof f.onImport=="function"&&(F.success(d.FD.format("finish")),f.onImport(J)),(E=T.current)!==null&&E!==void 0&&E.value&&(T.current.value="")};var G=_.target;if(G.files&&G.files[0]){var ee=G.files[0];try{q.readAsText(ee)}catch(z){A.error(d.FD.format("commonContentIncorrectFormat",{name:G.files[0].name}))}}})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(I.Z,{children:(0,h.jsxs)(O.Z.Compact,{block:!0,children:[(0,h.jsx)(b.ZP,{icon:(0,h.jsx)(m.Z,{}),block:!0,onClick:n,children:f.title}),f.showPaset&&(0,h.jsx)(b.ZP,{icon:(0,h.jsx)(S.Z,{}),onClick:function(){P(!0)}})]})}),(0,h.jsx)("input",{style:{display:"none"},type:"file",ref:T,name:"importFileInput"}),(0,h.jsx)(Y.Z,{width:j.ob,open:Z,onCancel:function(){P(!1)},onOk:function(){typeof f.onImport=="function"&&(F.success(d.FD.format("finish")),f.onImport(s)),P(!1)},children:(0,h.jsx)(B.ZP,{height:j.Ed,theme:"dark",value:s,onChange:function(_){a(_)}})})]})}},3616:function(Q,U,e){e.d(U,{Ed:function(){return p},FK:function(){return l},R_:function(){return W},ob:function(){return j}});var W=window.innerWidth<=1024?"90vw":"65vw",l="90vw",j="60vw",p="50vh"},62597:function(Q,U,e){e.d(U,{$G:function(){return B},Ct:function(){return T},Tb:function(){return h},XH:function(){return f},cl:function(){return Y},fp:function(){return b},fu:function(){return S},iE:function(){return F},nL:function(){return I},xb:function(){return H},ze:function(){return P}});var W=e(15009),l=e.n(W),j=e(99289),p=e.n(j),d=e(82346),m="com.dpanel.container.description",S="com.dpanel.container.title",I={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function B(o){return O.apply(this,arguments)}function O(){return O=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,d.request)("/dpanel/api/app/site/create-by-image",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),O.apply(this,arguments)}var b={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleInEnvFile:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192,EnvValueTypeOnePanel:16384};function Y(o){return g.apply(this,arguments)}function g(){return g=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,d.request)("/dpanel/api/app/site/get-list",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),g.apply(this,arguments)}function h(o){return x.apply(this,arguments)}function x(){return x=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.download=!1,n.next=3,(0,d.request)("/dpanel/api/app/log/run",{method:"POST",data:s});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),x.apply(this,arguments)}function f(o){return R.apply(this,arguments)}function R(){return R=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.download=!0,n.next=3,(0,d.request)("/dpanel/api/app/log/run",{method:"POST",data:s,responseType:"blob"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),R.apply(this,arguments)}function F(o){return A.apply(this,arguments)}function A(){return A=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s.id=String(s.id),n.next=3,(0,d.request)("/dpanel/api/app/site/get-detail",{data:s,method:"POST"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},o)})),A.apply(this,arguments)}function T(o){return C.apply(this,arguments)}function C(){return C=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,d.request)("/dpanel/api/app/container/delete",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),C.apply(this,arguments)}function H(o){return Z.apply(this,arguments)}function Z(){return Z=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,d.request)("/dpanel/api/app/site/delete",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),Z.apply(this,arguments)}function P(o){return D.apply(this,arguments)}function D(){return D=p()(l()().mark(function o(s){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,d.request)("/dpanel/api/app/container/ignore",{method:"POST",data:s}));case 1:case"end":return n.stop()}},o)})),D.apply(this,arguments)}},79245:function(Q,U,e){e.d(U,{m:function(){return j},y:function(){return p}});var W=e(64599),l=e.n(W);function j(d){var m=[];if(!d||d=="")return m;var S=d.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),I=l()(S),B;try{for(I.s();!(B=I.n()).done;){var O=B.value;m.push({name:O[1],value:O[2]?O[2].indexOf("-")==0?O[2].substring(1):O[2]:""})}}catch(b){I.e(b)}finally{I.f()}return m}function p(d,m){return!d||!m?!1:(d&m)!==0}}}]);
