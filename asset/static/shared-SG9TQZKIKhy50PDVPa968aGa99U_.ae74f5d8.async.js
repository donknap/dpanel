"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2952],{31199:function(V,D,e){var l=e(1413),P=e(45987),x=e(67294),S=e(40284),L=e(85893),M=["fieldProps","min","proFieldProps","max"],A=function(C,R){var g=C.fieldProps,O=C.min,u=C.proFieldProps,G=C.max,X=(0,P.Z)(C,M);return(0,L.jsx)(S.Z,(0,l.Z)({valueType:"digit",fieldProps:(0,l.Z)({min:O,max:G},g),ref:R,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:u},X))},f=x.forwardRef(A);D.Z=f},52688:function(V,D,e){var l=e(1413),P=e(45987),x=e(67294),S=e(40284),L=e(85893),M=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],A=x.forwardRef(function(f,T){var C=f.fieldProps,R=f.unCheckedChildren,g=f.checkedChildren,O=f.proFieldProps,u=(0,P.Z)(f,M);return(0,L.jsx)(S.Z,(0,l.Z)({valueType:"switch",fieldProps:(0,l.Z)({unCheckedChildren:R,checkedChildren:g},C),ref:T,valuePropName:"checked",proFieldProps:O,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},u))});D.Z=A},90672:function(V,D,e){var l=e(1413),P=e(45987),x=e(67294),S=e(40284),L=e(85893),M=["fieldProps","proFieldProps"],A=function(T,C){var R=T.fieldProps,g=T.proFieldProps,O=(0,P.Z)(T,M);return(0,L.jsx)(S.Z,(0,l.Z)({ref:C,valueType:"textarea",fieldProps:R,proFieldProps:g},O))};D.Z=x.forwardRef(A)},75293:function(V,D,e){e.d(D,{Z:function(){return x}});var l=e(25593),P=e(85893);function x(S){return(0,P.jsx)(l.Z.Text,{copyable:!0,style:{padding:10,display:S.block?"block":"",background:"#24292f",color:"#ffffff"},children:S.content})}},77273:function(V,D,e){var l=e(15009),P=e.n(l),x=e(99289),S=e.n(x),L=e(5574),M=e.n(L),A=e(184),f=e(5966),T=e(86615),C=e(97462),R=e(64317),g=e(52688),O=e(62370),u=e(38345),G=e(31199),X=e(90672),$=e(71230),F=e(15746),oe=e(42075),te=e(86250),k=e(40056),B=e(67294),J=e(87662),w=e(12491),se=e(89035),q=e(36146),ce=e(3616),ee=e(75293),ae=e(2831),r=e(85893),re=(0,B.forwardRef)(function(Q,le){var Y;(0,B.useImperativeHandle)(le,function(){return{edit:function(s){var t,_=s.address.split("://"),E=M()(_,2),p=E[0],y=E[1];(t=a.current)===null||t===void 0||t.setFieldsValue({name:s.name,title:s.title,addressType:"".concat(p=="ssh"?"tcp":p,"://"),address:y,serverUrl:s.serverUrl,enableTLS:s.enableTLS,tlsCa:s.tlsCa,tlsCert:s.tlsCert,tlsKey:s.tlsKey,enableComposePath:s.enableComposePath,enableSSH:s.enableSSH,sshServerInfo:s.sshServerInfo,remoteType:s.remoteType?s.remoteType:"docker"}),c(!0),W(s.name)}}}),(0,B.useEffect)(function(){(0,ae.aF)().then(function(v){v.data.rsa.public&&ne(v.data.rsa.public)})},[]);var ie=(0,B.useState)(),de=M()(ie,2),N=de[0],ne=de[1],i=new q.Uo("components.dockerEnvCreate"),n=(0,B.useState)(!1),o=M()(n,2),d=o[0],c=o[1],a=(0,B.useRef)(),I=(0,B.useState)(""),b=M()(I,2),U=b[0],W=b[1];return(0,r.jsxs)(A.a,{drawerProps:{forceRender:!0,width:ce.R_},onOpenChange:function(s){if(!s){var t;W(""),(t=a.current)===null||t===void 0||t.resetFields()}c(s)},open:d,width:800,trigger:Q.trigger,formRef:a,title:i.format((Y=a.current)!==null&&Y!==void 0&&Y.getFieldValue&&a.current.getFieldValue("name")=="local"?"drawerTitleDefault":"drawerTitle"),onFinish:function(){var v=S()(P()().mark(function s(t){var _,E,p,y;return P()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return E="",t.remoteType&&t.remoteType=="ssh"?E="ssh://":E=(p=t.addressType)!==null&&p!==void 0?p:"unix://",m.next=4,(0,J.ad)({name:t.name,title:t.title,address:"".concat(E).concat((_=t.address)!==null&&_!==void 0?_:t.sshServerInfo.address),serverUrl:t.serverUrl,enableTLS:t.enableTLS,tlsCa:t.tlsCa,tlsCert:t.tlsCert,tlsKey:t.tlsKey,enableComposePath:t.enableComposePath,composePath:t.enableComposePath?t.composePath:"",enableSSH:t.enableSSH||t.remoteType=="ssh",sshServerInfo:t.sshServerInfo,remoteType:t.remoteType});case 4:return y=m.sent,Q.onFinish&&Q.onFinish(),m.abrupt("return",!0);case 7:case"end":return m.stop()}},s)}));return function(s){return v.apply(this,arguments)}}(),children:[(0,r.jsx)(f.Z,{label:i.format("formTitle"),name:"title",required:!0,rules:[{required:!0}],fieldProps:{id:"envTitle"}},"envTitle"),(0,r.jsx)(f.Z,{label:i.format("formName"),name:"name",required:!0,disabled:U!="",rules:[{required:!0}],placeholder:i.format("formNameEmpty")}),(0,r.jsx)(f.Z,{tooltip:i.format("formServerUrlTip"),label:i.format("formServerUrl"),name:"serverUrl",placeholder:i.format("formServerUrlEmpty")}),(0,r.jsx)(T.Z.Group,{label:i.format("formRemoteType"),name:"remoteType",options:[{label:"DockerApi",value:"docker"},{label:"SSH",value:"ssh"}]}),(0,r.jsx)(C.Z,{name:["remoteType","name"],children:function(s){var t=s.remoteType,_=s.name;return(0,r.jsxs)(r.Fragment,{children:[t=="docker"&&(0,r.jsx)($.Z,{children:(0,r.jsx)(F.Z,{span:24,children:(0,r.jsxs)(oe.Z.Compact,{children:[(0,r.jsx)(R.Z,{name:"addressType",label:i.format("formAddressType"),valueEnum:{"unix://":"unix://","tcp://":"tcp://"},initialValue:"tcp://",fieldProps:{defaultValue:"tcp://"},width:"sm",tooltip:i.format("formAddressTypeTip")}),(0,r.jsx)(f.Z,{label:" ",name:"address",required:!0,width:"xl",rules:[{required:!0}],placeholder:i.format("formAddressEmpty")})]})})}),(0,r.jsxs)($.Z,{gutter:[15,0],children:[t=="docker"&&(0,r.jsx)(F.Z,{children:(0,r.jsx)(g.Z,{label:i.format("formEnableTLS"),name:"enableTLS",tooltip:i.format("formEnableTLSTip")})}),_!="local"&&typeof t!="undefined"&&(0,r.jsx)(F.Z,{children:(0,r.jsx)(g.Z,{label:i.format("formEnableComposePath"),name:"enableComposePath",tooltip:i.format("formEnableComposePathTip")})}),t=="docker"&&(0,r.jsx)(F.Z,{children:(0,r.jsx)(g.Z,{label:i.format("formEnableSSH"),name:"enableSSH"})})]})]})}}),(0,r.jsx)(C.Z,{name:["enableTLS","remoteType"],children:function(s){var t=s.enableTLS,_=s.remoteType;if(t&&_=="docker"){var E,p,y;return(0,r.jsxs)(te.Z,{gap:10,justify:"start",children:[(0,r.jsx)(O.Z,{name:"tlsCa",label:i.format("formTlsCa"),children:(0,r.jsx)(w.Z,{showPaset:!0,data:(E=a.current)===null||E===void 0?void 0:E.getFieldValue("tlsCa"),title:"ca.pem",onImport:function(m){var Z;return(Z=a.current)===null||Z===void 0||Z.setFieldValue("tlsCa",m),!0},onLoad:function(m){if(m.indexOf("CERTIFICATE")<0)throw new Error(i.format("formEnableTLSMessageUploadError",{name:"ca.pem"}));return!0}})}),(0,r.jsx)(O.Z,{name:"tlsCert",label:" ",children:(0,r.jsx)(w.Z,{showPaset:!0,data:(p=a.current)===null||p===void 0?void 0:p.getFieldValue("tlsCert"),title:"cert.pem",onImport:function(m){var Z;return(Z=a.current)===null||Z===void 0||Z.setFieldValue("tlsCert",m),!0},onLoad:function(m){if(m.indexOf("CERTIFICATE")<0)throw new Error(i.format("formEnableTLSMessageUploadError",{name:"cert.pem"}));return!0}})}),(0,r.jsx)(O.Z,{label:" ",name:"tlsKey",children:(0,r.jsx)(w.Z,{showPaset:!0,data:(y=a.current)===null||y===void 0?void 0:y.getFieldValue("tlsKey"),title:"key.pem",onImport:function(m){var Z;return(Z=a.current)===null||Z===void 0||Z.setFieldValue("tlsKey",m),!0},onLoad:function(m){if(m.indexOf("PRIVATE")<0)throw new Error(i.format("formEnableTLSMessageUploadError",{name:"key.pem"}));return!0}})})]})}}}),(0,r.jsx)(C.Z,{name:["enableComposePath","name"],children:function(s){var t=s.enableComposePath,_=s.name;if(t)return(0,r.jsx)(f.Z,{label:i.format("formComposePath"),name:"composePath",disabled:!0,fieldProps:{value:"/dpanel/compose/compose-".concat(_!=null?_:"")}})}}),(0,r.jsx)(C.Z,{name:["enableSSH","sshServerInfo","remoteType","address"],children:function(s){var t=s.enableSSH,_=s.sshServerInfo,E=s.remoteType,p=s.address;return(t||E=="ssh")&&[(0,r.jsxs)(u.Z,{title:(0,r.jsx)(se.Z,{}),subTitle:i.format("formEnableSSHTitle"),ghost:!0,children:[(0,r.jsxs)(r.Fragment,{children:[E=="ssh"&&(0,r.jsx)(O.Z,{children:(0,r.jsx)(k.Z,{message:(0,r.jsxs)(r.Fragment,{children:[i.format("formEnableSSHAlert")," \xA0",(0,r.jsx)("a",{href:"https://dpanel.cc/manual/system-env#ssh",target:"_blank",children:q.FD.format("help")})]})})}),(0,r.jsx)(f.Z,{label:i.format("formSshServerInfoAddress"),placeholder:i.format("formSshServerInfoAddressEmpty"),name:["sshServerInfo","address"],required:!0,rules:[{required:!0}]})]}),(0,r.jsxs)($.Z,{children:[(0,r.jsx)(F.Z,{children:(0,r.jsx)(G.Z,{initialValue:22,label:i.format("formSshServerInfoPort"),name:["sshServerInfo","port"]})}),(0,r.jsx)(F.Z,{offset:2,children:(0,r.jsx)(f.Z,{width:"lg",label:i.format("formSshServerInfoUsername"),name:["sshServerInfo","username"],required:!0,rules:[{required:!0}]})})]}),(0,r.jsx)(T.Z.Group,{label:i.format("formSshServerInfoAuthType"),name:["sshServerInfo","authType"],options:i.option("formSshServerInfoAuthTypeOption",["basic","pem","pemDefault"]),fieldProps:{onChange:function(){var h;(h=a.current)===null||h===void 0||h.setFieldValue(["sshServerInfo","password"],"")}},required:!0,rules:[{required:!0}]}),_&&_.authType=="basic"&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(f.Z.Password,{label:i.format("formSshServerInfoPassword"),name:["sshServerInfo","password"],required:!0,rules:[{required:!0}]})}),_&&_.authType=="pem"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{title:i.format("formSshServerInfoPrivateKeyImport"),onImport:function(h){var m;return(m=a.current)===null||m===void 0||m.setFieldValue(["sshServerInfo","privateKey"],h),!0},onLoad:function(h){if(!h.includes("PRIVATE KEY"))throw new Error(i.format("formEnableTLSMessageUploadError",{name:"private.key"}));return!0}}),(0,r.jsx)(X.Z,{name:["sshServerInfo","privateKey"],label:i.format("formSshServerInfoPrivateKey"),required:!0,rules:[{required:!0}]}),(0,r.jsx)(f.Z.Password,{name:["sshServerInfo","password"],label:i.format("formSshServerInfoPrivateKeyPassword")})]}),_&&_.authType=="pemDefault"&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(C.Z,{name:["sshServerInfo"],children:function(h){var m=h.sshServerInfo;if(!(!m||!m.username))return[(0,r.jsx)(k.Z,{message:i.format("formSshServerInfoAddPublicKey",{user:m.username}),style:{marginBottom:15}},"message"),N&&(0,r.jsx)(ee.Z,{content:'mkdir -p ~/.ssh && chmod 700 ~/.ssh && ! grep -q "'.concat(N.substring(N.length/2,N.length/2+18),`" ~/.ssh/authorized_keys 2>/dev/null && echo "
`).concat(N,'" >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys'),block:!0},"copycode")]}})})]},"sshSetting")]}})]})});D.Z=re},2831:function(V,D,e){e.d(D,{Ll:function(){return C},aF:function(){return M},u5:function(){return f}});var l=e(15009),P=e.n(l),x=e(99289),S=e.n(x),L=e(63713);function M(){return A.apply(this,arguments)}function A(){return A=S()(P()().mark(function g(){return P()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,L.request)("/dpanel/api/common/home/info",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),A.apply(this,arguments)}function f(){return T.apply(this,arguments)}function T(){return T=S()(P()().mark(function g(){return P()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,L.request)("/dpanel/api/common/home/check-new-version",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),T.apply(this,arguments)}function C(){return R.apply(this,arguments)}function R(){return R=S()(P()().mark(function g(){return P()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,L.request)("/dpanel/api/common/home/usage",{method:"POST"});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},g)})),R.apply(this,arguments)}},40056:function(V,D,e){e.d(D,{Z:function(){return i}});var l=e(67294),P=e(89739),x=e(4340),S=e(97937),L=e(21640),M=e(78860),A=e(93967),f=e.n(A),T=e(29372),C=e(64217),R=e(42550),g=e(96159),O=e(53124),u=e(11568),G=e(14747),X=e(83559);const $=(n,o,d,c,a)=>({background:n,border:`${(0,u.bf)(c.lineWidth)} ${c.lineType} ${o}`,[`${a}-icon`]:{color:d}}),F=n=>{const{componentCls:o,motionDurationSlow:d,marginXS:c,marginSM:a,fontSize:I,fontSizeLG:b,lineHeight:U,borderRadiusLG:W,motionEaseInOutCirc:v,withDescriptionIconSize:s,colorText:t,colorTextHeading:_,withDescriptionPadding:E,defaultPadding:p}=n;return{[o]:Object.assign(Object.assign({},(0,G.Wf)(n)),{position:"relative",display:"flex",alignItems:"center",padding:p,wordWrap:"break-word",borderRadius:W,[`&${o}-rtl`]:{direction:"rtl"},[`${o}-content`]:{flex:1,minWidth:0},[`${o}-icon`]:{marginInlineEnd:c,lineHeight:0},"&-description":{display:"none",fontSize:I,lineHeight:U},"&-message":{color:_},[`&${o}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${d} ${v}, opacity ${d} ${v},
        padding-top ${d} ${v}, padding-bottom ${d} ${v},
        margin-bottom ${d} ${v}`},[`&${o}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${o}-with-description`]:{alignItems:"flex-start",padding:E,[`${o}-icon`]:{marginInlineEnd:a,fontSize:s,lineHeight:0},[`${o}-message`]:{display:"block",marginBottom:c,color:_,fontSize:b},[`${o}-description`]:{display:"block",color:t}},[`${o}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},oe=n=>{const{componentCls:o,colorSuccess:d,colorSuccessBorder:c,colorSuccessBg:a,colorWarning:I,colorWarningBorder:b,colorWarningBg:U,colorError:W,colorErrorBorder:v,colorErrorBg:s,colorInfo:t,colorInfoBorder:_,colorInfoBg:E}=n;return{[o]:{"&-success":$(a,c,d,n,o),"&-info":$(E,_,t,n,o),"&-warning":$(U,b,I,n,o),"&-error":Object.assign(Object.assign({},$(s,v,W,n,o)),{[`${o}-description > pre`]:{margin:0,padding:0}})}}},te=n=>{const{componentCls:o,iconCls:d,motionDurationMid:c,marginXS:a,fontSizeIcon:I,colorIcon:b,colorIconHover:U}=n;return{[o]:{"&-action":{marginInlineStart:a},[`${o}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:I,lineHeight:(0,u.bf)(I),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${d}-close`]:{color:b,transition:`color ${c}`,"&:hover":{color:U}}},"&-close-text":{color:b,transition:`color ${c}`,"&:hover":{color:U}}}}},k=n=>({withDescriptionIconSize:n.fontSizeHeading3,defaultPadding:`${n.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${n.paddingMD}px ${n.paddingContentHorizontalLG}px`});var B=(0,X.I$)("Alert",n=>[F(n),oe(n),te(n)],k),J=function(n,o){var d={};for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&o.indexOf(c)<0&&(d[c]=n[c]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,c=Object.getOwnPropertySymbols(n);a<c.length;a++)o.indexOf(c[a])<0&&Object.prototype.propertyIsEnumerable.call(n,c[a])&&(d[c[a]]=n[c[a]]);return d};const w={success:P.Z,info:M.Z,error:x.Z,warning:L.Z},se=n=>{const{icon:o,prefixCls:d,type:c}=n,a=w[c]||null;return o?(0,g.wm)(o,l.createElement("span",{className:`${d}-icon`},o),()=>({className:f()(`${d}-icon`,o.props.className)})):l.createElement(a,{className:`${d}-icon`})},q=n=>{const{isClosable:o,prefixCls:d,closeIcon:c,handleClose:a,ariaProps:I}=n,b=c===!0||c===void 0?l.createElement(S.Z,null):c;return o?l.createElement("button",Object.assign({type:"button",onClick:a,className:`${d}-close-icon`,tabIndex:0},I),b):null};var ee=l.forwardRef((n,o)=>{const{description:d,prefixCls:c,message:a,banner:I,className:b,rootClassName:U,style:W,onMouseEnter:v,onMouseLeave:s,onClick:t,afterClose:_,showIcon:E,closable:p,closeText:y,closeIcon:h,action:m,id:Z}=n,ve=J(n,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[ue,Ee]=l.useState(!1),me=l.useRef(null);l.useImperativeHandle(o,()=>({nativeElement:me.current}));const{getPrefixCls:Pe,direction:Ce,closable:H,closeIcon:_e,className:ge,style:Ie}=(0,O.dj)("alert"),j=Pe("alert",c),[ye,Se,Te]=B(j),Oe=K=>{var z;Ee(!0),(z=n.onClose)===null||z===void 0||z.call(n,K)},pe=l.useMemo(()=>n.type!==void 0?n.type:I?"warning":"info",[n.type,I]),be=l.useMemo(()=>typeof p=="object"&&p.closeIcon||y?!0:typeof p=="boolean"?p:h!==!1&&h!==null&&h!==void 0?!0:!!H,[y,h,p,H]),fe=I&&E===void 0?!0:E,Me=f()(j,`${j}-${pe}`,{[`${j}-with-description`]:!!d,[`${j}-no-icon`]:!fe,[`${j}-banner`]:!!I,[`${j}-rtl`]:Ce==="rtl"},ge,b,U,Te,Se),je=(0,C.Z)(ve,{aria:!0,data:!0}),De=l.useMemo(()=>typeof p=="object"&&p.closeIcon?p.closeIcon:y||(h!==void 0?h:typeof H=="object"&&H.closeIcon?H.closeIcon:_e),[h,p,y,_e]),xe=l.useMemo(()=>{const K=p!=null?p:H;if(typeof K=="object"){const{closeIcon:z}=K;return J(K,["closeIcon"])}return{}},[p,H]);return ye(l.createElement(T.ZP,{visible:!ue,motionName:`${j}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:K=>({maxHeight:K.offsetHeight}),onLeaveEnd:_},({className:K,style:z},he)=>l.createElement("div",Object.assign({id:Z,ref:(0,R.sQ)(me,he),"data-show":!ue,className:f()(Me,K),style:Object.assign(Object.assign(Object.assign({},Ie),W),z),onMouseEnter:v,onMouseLeave:s,onClick:t,role:"alert"},je),fe?l.createElement(se,{description:d,icon:n.icon,prefixCls:j,type:pe}):null,l.createElement("div",{className:`${j}-content`},a?l.createElement("div",{className:`${j}-message`},a):null,d?l.createElement("div",{className:`${j}-description`},d):null),m?l.createElement("div",{className:`${j}-action`},m):null,l.createElement(q,{isClosable:be,prefixCls:j,closeIcon:De,handleClose:Oe,ariaProps:xe}))))}),ae=e(15671),r=e(43144),re=e(61120),Q=e(78814),le=e(82963);function Y(n,o,d){return o=(0,re.Z)(o),(0,le.Z)(n,(0,Q.Z)()?Reflect.construct(o,d||[],(0,re.Z)(n).constructor):o.apply(n,d))}var ie=e(60136),N=function(n){function o(){var d;return(0,ae.Z)(this,o),d=Y(this,o,arguments),d.state={error:void 0,info:{componentStack:""}},d}return(0,ie.Z)(o,n),(0,r.Z)(o,[{key:"componentDidCatch",value:function(c,a){this.setState({error:c,info:a})}},{key:"render",value:function(){const{message:c,description:a,id:I,children:b}=this.props,{error:U,info:W}=this.state,v=(W==null?void 0:W.componentStack)||null,s=typeof c=="undefined"?(U||"").toString():c,t=typeof a=="undefined"?v:a;return U?l.createElement(ee,{id:I,type:"error",message:s,description:l.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},t)}):b}}])}(l.Component);const ne=ee;ne.ErrorBoundary=N;var i=ne}}]);
