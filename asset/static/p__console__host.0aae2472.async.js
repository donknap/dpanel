(self.webpackChunk=self.webpackChunk||[]).push([[6856],{49610:function(M,a,e){"use strict";var t=e(5574),r=e.n(t),i=e(67294),E=e(52626),d=e(78267),v=e.n(d),u=e(12323),g=e(87662),m=e(4244),I=e.n(m),y=e(24078),O=e(85893),n,_,s,f,W=(0,i.forwardRef)(function(R,S){var A,B=(0,i.useState)(),T=r()(B,2),U=T[0],j=T[1],w=(0,i.useState)(""),b=r()(w,2),p=b[0],L=b[1];(0,i.useImperativeHandle)(S,function(){return{start:function(h,o){D(),_.fit(),o.width=n.cols,o.height=n.rows;var C=o?Object.keys(o).filter(function(c){return o&&o[c]}).map(function(c){if(o&&o[c])return"".concat(c,"=").concat(o[c])}):[];s=new WebSocket((0,E.R)(h+"?"+C.join("&"))),s.addEventListener("message",function(c){var P=JSON.parse(c.data),K=P.type;if(K==h&&(n.write(P.data),P.data.indexOf("exec failed")!=-1)){D();return}}),f=n.onData(function(c){var P={content:{command:c},type:h};s&&s.send(JSON.stringify(P))}),L(h),j(o)},close:function(){D()},fit:function(){return _.fit(),{width:n.cols,height:n.rows}},run:function(h){U&&h&&h.forEach(function(o){var C={content:{command:o+`
`},type:p};s&&s.send(JSON.stringify(C))})}}}),(0,i.useEffect)(function(){return n=new m.Terminal(u.X),_=new d.FitAddon,n.loadAddon(_),n.open(document.getElementById("terminal-container-console")),_.fit(),(0,g.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(l){l.data&&l.data.fontSize&&Object.assign(n.options,l.data)}),function(){D()}},[]),(0,i.useEffect)(function(){window.addEventListener("resize",function(){_.fit();var l={size:{width:n.cols,height:n.rows},type:p};p&&s&&s.send(JSON.stringify(l))})},[p]);function D(){f&&(n.reset(),_.fit(),n.focus(),f.dispose()),s&&(s.close(),s=null)}return(0,O.jsx)("div",{style:{height:(A=R.height)!==null&&A!==void 0?A:"100vh"},id:"terminal-container-console"})});a.Z=W},12323:function(M,a,e){"use strict";e.d(a,{X:function(){return t},n:function(){return r}});var t={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},r=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},67359:function(M,a,e){"use strict";e.r(a),e.d(a,{default:function(){return g}});var t=e(5574),r=e.n(t),i=e(49610),E=e(87662),d=e(63713),v=e(67294),u=e(85893);function g(){var m=(0,d.useParams)(),I=(0,d.useSearchParams)(),y=r()(I,2),O=y[0],n=y[1],_=(0,v.useRef)();return(0,v.useEffect)(function(){m.id&&(0,E.K3)({name:m.id}).then(function(s){var f;window.document.title="".concat(s.data.name," - console"),(f=_.current)===null||f===void 0||f.start("/console/host/".concat(s.data.name),{cmd:O.get("cmd"),workDir:O.get("workDir")})}),document.body.style.overflow="hidden"},[]),(0,u.jsx)(i.Z,{ref:_})}},24078:function(){"use strict"},78267:function(M){(function(a,e){M.exports=e()})(self,()=>(()=>{"use strict";var a={};return(()=>{var e=a;Object.defineProperty(e,"__esModule",{value:!0}),e.FitAddon=void 0,e.FitAddon=class{activate(t){this._terminal=t}dispose(){}fit(){const t=this.proposeDimensions();if(!t||!this._terminal||isNaN(t.cols)||isNaN(t.rows))return;const r=this._terminal._core;this._terminal.rows===t.rows&&this._terminal.cols===t.cols||(r._renderService.clear(),this._terminal.resize(t.cols,t.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const t=this._terminal._core,r=t._renderService.dimensions;if(r.css.cell.width===0||r.css.cell.height===0)return;const i=this._terminal.options.scrollback===0?0:t.viewport.scrollBarWidth,E=window.getComputedStyle(this._terminal.element.parentElement),d=parseInt(E.getPropertyValue("height")),v=Math.max(0,parseInt(E.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),g=d-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),m=v-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-i;return{cols:Math.max(2,Math.floor(m/r.css.cell.width)),rows:Math.max(1,Math.floor(g/r.css.cell.height))}}}})(),a})())}}]);
