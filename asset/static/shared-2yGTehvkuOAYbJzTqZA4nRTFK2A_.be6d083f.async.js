"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5841],{12119:function(Ie,Ee,e){e.d(Ee,{Z:function(){return z}});var we=e(87462),Y=e(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},a=X,pe=e(84089),E=function(b,Oe){return Y.createElement(pe.Z,(0,we.Z)({},b,{ref:Oe,icon:a}))},de=Y.forwardRef(E),z=de},99922:function(Ie,Ee,e){var we=e(97857),Y=e.n(we),X=e(15009),a=e.n(X),pe=e(99289),E=e.n(pe),de=e(5574),z=e.n(de),u=e(67294),b=e(85265),Oe=e(42075),Re=e(83622),B=e(49610),H=e(3616),$=e(69033),ee=e(90581),Ce=e(5251),k=e(36146),xe=e(95591),ce=e(24963),ne=e(85893),ve=new k.Uo("components.console"),De=(0,u.forwardRef)(function(_e,F){var ae,U,me,ge=(0,u.useRef)(),j=(0,u.useRef)(),q=(0,u.useState)(!1),M=z()(q,2),re=M[0],T=M[1],oe=(0,u.useState)(),G=z()(oe,2),h=G[0],te=G[1],Te=(0,u.useContext)(ce.Z),ie=Te.message,ye=(0,u.useRef)();return(0,u.useImperativeHandle)(F,function(){return{show:function(A){return E()(a()().mark(function se(){var Le;return a()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:te(A),T(!0),(Le=ge.current)===null||Le===void 0||Le.resetFields();case 3:case"end":return je.stop()}},se)}))()}}}),(0,u.useEffect)(function(){return setTimeout(function(){var J;h&&((J=j.current)===null||J===void 0||J.start(h.url,{cmd:h&&h.cmd,workDir:h&&h.workDir}))},1e3),function(){var J;(J=j.current)===null||J===void 0||J.close()}},[h,re]),(0,ne.jsxs)(b.Z,{forceRender:!0,width:H.FK,open:re,onClose:function(){var A;T(!1),!((A=ye.current)===null||A===void 0)&&A.reset&&ye.current.reset()},title:ve.format("drawerTitle",{name:(0,Ce.fi)((ae=h==null?void 0:h.title)!==null&&ae!==void 0?ae:"","/")}),children:[(0,ne.jsxs)(Oe.Z,{style:{marginBottom:20},children:[_e.showFileExplorer&&(0,ne.jsx)($.Z,{trigger:(0,ne.jsx)(Re.ZP,{icon:(0,ne.jsx)(xe.Z,{}),type:"primary",children:k.FD.format("listManageFilePath")}),type:"container",title:(0,Ce.fi)((U=h==null?void 0:h.title)!==null&&U!==void 0?U:"","/"),name:h&&h.url&&(me=h.url.split("/").pop())!==null&&me!==void 0?me:""}),(0,ne.jsx)(ee.Z,{ref:ye,onChangeShell:function(A){var se;if(!h)return!1;(se=j.current)===null||se===void 0||se.close(),te(Y()(Y()({},h),{cmd:A!=null?A:h==null?void 0:h.cmd})),ie.success(k.FD.format("finish"))},onOpenNewWindow:function(A){return h?(A.workDir=h&&h.workDir?h.workDir:"","".concat(h.url,"?").concat(Object.keys(A).map(function(se){return"".concat(se,"=").concat(encodeURIComponent(A[se]))}).join("&"))):""},onOpenNewWindowFinish:function(){var A;(A=j.current)===null||A===void 0||A.close(),T(!1)},onBatchCommandFinish:function(A){j.current&&j.current.run(A)}})]}),re&&(0,ne.jsx)(B.Z,{height:"80vh",ref:j})]})});Ee.Z=De},69033:function(Ie,Ee,e){e.d(Ee,{Z:function(){return xn}});var we=e(97857),Y=e.n(we),X=e(15009),a=e.n(X),pe=e(99289),E=e.n(pe),de=e(5574),z=e.n(de),u=e(67294),b=e(63713);function Oe(r,l){return Re.apply(this,arguments)}function Re(){return Re=E()(a()().mark(function r(l,s){var R;return a()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return R="/dpanel/api/".concat(l,"/explorer/get-path-list"),S.next=3,(0,b.request)(R,{data:s,method:"POST"});case 3:return S.abrupt("return",S.sent);case 4:case"end":return S.stop()}},r)})),Re.apply(this,arguments)}function B(r,l){return H.apply(this,arguments)}function H(){return H=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/export"),{data:s,method:"POST",responseType:"blob"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),H.apply(this,arguments)}function $(r,l){return ee.apply(this,arguments)}function ee(){return ee=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/import"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ee.apply(this,arguments)}function Ce(r,l){return k.apply(this,arguments)}function k(){return k=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/delete"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),k.apply(this,arguments)}function xe(r,l){return ce.apply(this,arguments)}function ce(){return ce=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/unzip"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ce.apply(this,arguments)}function ne(r,l){return ve.apply(this,arguments)}function ve(){return ve=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/get-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ve.apply(this,arguments)}function De(r,l){return _e.apply(this,arguments)}function _e(){return _e=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/import-file-content"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),_e.apply(this,arguments)}function F(r,l){return ae.apply(this,arguments)}function ae(){return ae=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/mkdir"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),ae.apply(this,arguments)}function U(r,l){return me.apply(this,arguments)}function me(){return me=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/chmod"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),me.apply(this,arguments)}function ge(r,l){return j.apply(this,arguments)}function j(){return j=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/get-user-list"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),j.apply(this,arguments)}function q(r,l){return M.apply(this,arguments)}function M(){return M=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/get-file-stat"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),M.apply(this,arguments)}function re(r,l){return T.apply(this,arguments)}function T(){return T=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/attach-volume"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),T.apply(this,arguments)}function oe(r){return G.apply(this,arguments)}function G(){return G=E()(a()().mark(function r(l){return a()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/destroy-proxy-container"),{data:{},method:"POST"});case 2:return R.abrupt("return",R.sent);case 3:case"end":return R.stop()}},r)})),G.apply(this,arguments)}function h(r,l){return te.apply(this,arguments)}function te(){return te=E()(a()().mark(function r(l,s){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.request)("/dpanel/api/".concat(l,"/explorer/copy"),{data:s,method:"POST"});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},r)})),te.apply(this,arguments)}var Te=e(97269),ie=e(5966),ye=e(31112),J=e(92237),A=e(86615),se=e(62370),Le=e(97462),Ke=e(11106),je=e(24963),Ze=e(5251),Me=e(36146),Ve=e(27166),i=e(85893),fe=new Me.Uo("components.explorer"),He=(0,u.forwardRef)(function(r,l){var s,R,n=(0,u.useContext)(je.Z),S=n.notice,L=(0,u.useContext)(ye.Z),W=L.currentPath,V=L.refresh,I=L.name,Z=L.apiPrefix,_=(0,u.useRef)(),le=(0,u.useState)(!1),K=z()(le,2),y=K[0],g=K[1],f=(0,u.useRef)();return(0,u.useImperativeHandle)(l,function(){return{newFile:function(){var O;g(!0),(O=_.current)===null||O===void 0||O.setFieldValue("type","newFile")},editFile:function(O,x,he){return E()(a()().mark(function v(){var ue,Fe,w,t,o,c;return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return g(!0),(ue=f.current)===null||ue===void 0||ue.loading(),d.prev=2,d.next=5,ne(Z,{name:I,file:x}).finally(function(){var D;(D=f.current)===null||D===void 0||D.finish()});case 5:if(c=d.sent,!(c.data.content==""&&he!="0")){d.next=10;break}return S.error(fe.format("editFileMessageNotSupport")),g(!1),d.abrupt("return");case 10:(Fe=_.current)===null||Fe===void 0||Fe.setFieldValue("newValue",c.data.content),(w=_.current)===null||w===void 0||w.setFieldValue("newName",O),(t=_.current)===null||t===void 0||t.setFieldValue("type","editFile"),(o=_.current)===null||o===void 0||o.setFieldValue("fileMode",c.data.fileMode),d.next=19;break;case 16:d.prev=16,d.t0=d.catch(2),g(!1);case 19:return d.abrupt("return");case 20:case"end":return d.stop()}},v,null,[[2,16]])}))()}}}),(0,i.jsxs)(Ve.Z,{drawerProps:{width:"50vw",forceRender:!0},onFinish:function(){var P=E()(a()().mark(function O(x){return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(x.type!="newDir"){v.next=13;break}return v.prev=1,v.next=4,F(Z,{name:I,destPath:"".concat(W,"/").concat((0,Ze.fi)(x.newPath,"/"))});case 4:return V(),g(!1),v.abrupt("return",!0);case 9:v.prev=9,v.t0=v.catch(1);case 11:v.next=23;break;case 13:return v.prev=13,v.next=16,De(Z,{destPath:W,file:x.newName,content:x.newValue,name:I,fileMode:x.fileMode});case 16:return V(),g(!1),v.abrupt("return",!0);case 21:v.prev=21,v.t1=v.catch(13);case 23:return v.abrupt("return",!1);case 24:case"end":return v.stop()}},O,null,[[1,9],[13,21]])}));return function(O){return P.apply(this,arguments)}}(),ref:f,title:fe.format("editFileTypeEditFile"),open:y,onOpenChange:function(O){if(g(O),!O){var x;(x=_.current)===null||x===void 0||x.resetFields(),r.onFinish&&r.onFinish()}},formRef:_,children:[(0,i.jsx)(A.Z.Group,{name:"type",options:[{label:fe.format("editFileTypeEditFile"),value:"editFile",disabled:((s=_.current)===null||s===void 0?void 0:s.getFieldValue("type"))!="editFile"},{label:fe.format("editFileTypeNewFile"),value:"newFile"},{label:fe.format("editFileTypeNewDir"),value:"newDir"}],disabled:((R=_.current)===null||R===void 0?void 0:R.getFieldValue("type"))=="editFile"}),(0,i.jsx)(se.Z,{name:"fileMode",hidden:!0}),(0,i.jsx)(Le.Z,{name:["type"],children:function(O){var x=O.type;return x!="newDir"?[(0,i.jsx)(ie.Z,{label:fe.format("editFileNewName"),tooltip:fe.format("editFileNewNameTip"),name:"newName",fieldProps:{addonBefore:"".concat(W,"/")},placeholder:fe.format("editFileNewNameEmpty"),disabled:x=="editFile"},"fileName"),(0,i.jsx)(se.Z,{label:fe.format("editFileNewValue"),name:"newValue",children:(0,i.jsx)(Ke.ZP,{theme:"dark",height:"58vh",onChange:function(v){var ue;(ue=_.current)===null||ue===void 0||ue.setFieldValue("newValue",v)}})},"fileContent")]:(0,i.jsx)(ie.Z,{name:"newPath",label:fe.format("editFileNewPath"),placeholder:fe.format("editFileNewPathEmpty")})}})]})}),ke=He,Ue=e(15836),Ae=e(83622),Ge=e(83062),Je=e(66309),Qe=e(55681),Ye=e(51042),Xe=e(86548),qe=e(12119),$e=e(87462),en={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M957.6 507.4L603.2 158.2a7.9 7.9 0 00-11.2 0L353.3 393.4a8.03 8.03 0 00-.1 11.3l.1.1 40 39.4-117.2 115.3a8.03 8.03 0 00-.1 11.3l.1.1 39.5 38.9-189.1 187H72.1c-4.4 0-8.1 3.6-8.1 8V860c0 4.4 3.6 8 8 8h344.9c2.1 0 4.1-.8 5.6-2.3l76.1-75.6 40.4 39.8a7.9 7.9 0 0011.2 0l117.1-115.6 40.1 39.5a7.9 7.9 0 0011.2 0l238.7-235.2c3.4-3 3.4-8 .3-11.2zM389.8 796.2H229.6l134.4-133 80.1 78.9-54.3 54.1zm154.8-62.1L373.2 565.2l68.6-67.6 171.4 168.9-68.6 67.6zM713.1 658L450.3 399.1 597.6 254l262.8 259-147.3 145z"}}]},name:"highlight",theme:"outlined"},nn=en,Ne=e(84089),rn=function(l,s){return u.createElement(Ne.Z,(0,$e.Z)({},l,{ref:s,icon:nn}))},tn=u.forwardRef(rn),an=tn,on={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 392h64v64h-64zm0 190v160h128V582h-64v-62h-64v62zm80 48v64h-32v-64h32zm-16-302h64v64h-64zm-64-64h64v64h-64zm64 192h64v64h-64zm0-256h64v64h-64zm494.6 88.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h64v64h64v-64h174v216a42 42 0 0042 42h216v494z"}}]},name:"file-zip",theme:"outlined"},sn=on,ln=function(l,s){return u.createElement(Ne.Z,(0,$e.Z)({},l,{ref:s,icon:sn}))},un=u.forwardRef(ln),dn=un,cn=e(23430),mn=e(58638),fn=e(93162),hn=e(88484),ze=e(37476),pn=e(91604),Se=e(3616),vn=e(4813);function _n(){var r=(0,u.useRef)(),l=(0,u.useContext)(ye.Z),s=l.refresh,R=l.name,n=l.apiPrefix,S=l.currentPath,L=new Me.Uo("components.explorer");return(0,i.jsx)(ze.Y,{modalProps:{width:Se.ob},formRef:r,trigger:(0,i.jsx)(Ae.ZP,{icon:(0,i.jsx)(hn.Z,{}),children:L.format("toolbarUploadButton")}),title:L.format("toolbarUploadModalTitle"),onFinish:function(){var W=E()(a()().mark(function V(I){var Z,_;return a()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return _=[],I.importFileList&&I.importFileList.map(function(y){_.push({name:y.name,path:y.response.data.path})}),$(n,{fileList:_,name:R,destPath:S}),(Z=r.current)===null||Z===void 0||Z.resetFields(),s(),K.abrupt("return",!0);case 6:case"end":return K.stop()}},V)}));return function(V){return W.apply(this,arguments)}}(),children:(0,i.jsx)(pn.Z,{name:"importFileList",fieldProps:{multiple:!0,name:"file",action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(V){return new Promise(function(I){var Z;(0,vn._)({path:(Z=V.response.data.path)!==null&&Z!==void 0?Z:""}).then(function(_){I(!0)})})}}})})}var We=e(38345),Pe=e(63434),gn=e(42075),Pn=(0,u.forwardRef)(function(r,l){var s=(0,u.useRef)(),R=(0,u.useContext)(ye.Z),n=R.refresh,S=R.name,L=R.apiPrefix,W=(0,u.useState)(!1),V=z()(W,2),I=V[0],Z=V[1],_=new Me.Uo("components.explorer");(0,u.useImperativeHandle)(l,function(){return{show:function(g){var f;Z(!0),g.length==1&&K(le(g[0].modStr)),(f=s.current)===null||f===void 0||f.setFieldValue("fileList",g.map(function(P){return P.path}))}}});function le(y){var g=y.split(""),f=0,P=0,O=0;return g[1]=="r"&&(f+=4),g[2]=="w"&&(f+=2),g[3]=="x"&&(f+=1),g[4]=="r"&&(P+=4),g[5]=="w"&&(P+=2),g[6]=="x"&&(P+=1),g[7]=="r"&&(O+=4),g[8]=="w"&&(O+=2),g[9]=="x"&&(O+=1),"".concat(f).concat(P).concat(O)}function K(y){var g;if((g=s.current)===null||g===void 0||g.setFieldValue("permission",y),y.length>=1){var f;(f=s.current)===null||f===void 0||f.setFieldsValue({ownerRead:Number(y[0])&4,ownerWrite:Number(y[0])&2,ownerExec:Number(y[0])&1})}if(y.length>=2){var P;(P=s.current)===null||P===void 0||P.setFieldsValue({groupRead:Number(y[1])&4,groupWrite:Number(y[1])&2,groupExec:Number(y[1])&1})}if(y.length>=3){var O;(O=s.current)===null||O===void 0||O.setFieldsValue({everyoneRead:Number(y[2])&4,everyoneWrite:Number(y[2])&2,everyoneExec:Number(y[2])&1})}}return(0,i.jsxs)(ze.Y,{modalProps:{forceRender:!0,width:Se.ob},title:_.format("toolbarPermissionModalTitle"),layout:"horizontal",open:I,onOpenChange:function(g){if(Z(g),!g){var f;(f=s.current)===null||f===void 0||f.resetFields()}},formRef:s,onValuesChange:function(g,f){if(g.permission)K(g.permission);else{var P=["-",f.ownerRead?"r":"-",f.ownerWrite?"w":"-",f.ownerExec?"x":"-",f.groupRead?"r":"-",f.groupWrite?"w":"-",f.groupExec?"x":"-",f.everyoneRead?"r":"-",f.everyoneWrite?"w":"-",f.everyoneExec?"x":"-"];K(le(P.join("")))}},onFinish:function(){var y=E()(a()().mark(function g(f){var P,O,x;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,U(L,{name:S,fileList:f.fileList,mod:(P=f.permission)!==null&&P!==void 0?P:"600",hasChildren:(O=f.hasChildren)!==null&&O!==void 0?O:!0,user:f.user});case 2:return x=v.sent,n(),v.abrupt("return",!0);case 5:case"end":return v.stop()}},g)}));return function(g){return y.apply(this,arguments)}}(),children:[(0,i.jsxs)(We.Z,{ghost:!0,split:"vertical",bordered:!0,children:[(0,i.jsx)(se.Z,{name:"fileList",hidden:!0}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionOwner"),headerBordered:!0,children:[(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionRead"),name:"ownerRead"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionWrite"),name:"ownerWrite"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionExec"),name:"ownerExec"})]}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionGroup"),headerBordered:!0,children:[(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionRead"),name:"groupRead"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionWrite"),name:"groupWrite"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionExec"),name:"groupExec"})]}),(0,i.jsxs)(We.Z,{title:_.format("toolbarPermissionEveryone"),headerBordered:!0,children:[(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionRead"),name:"everyoneRead"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionWrite"),name:"everyoneWrite"}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionExec"),name:"everyoneExec"})]})]}),(0,i.jsxs)(We.Z,{bordered:!0,style:{marginTop:10},children:[(0,i.jsx)(ie.Z,{label:_.format("toolbarPermissionButton"),name:"permission",fieldProps:{maxLength:3},labelCol:{span:2}}),(0,i.jsxs)(gn.Z.Compact,{children:[(0,i.jsx)(ie.Z,{width:"sm",placeholder:_.format("toolbarPermissionOwnerEmpty"),label:_.format("toolbarPermissionOwner"),name:"user",fieldProps:{addonAfter:":"}}),(0,i.jsx)(ie.Z,{width:"sm",placeholder:_.format("toolbarPermissionGroupEmpty"),name:"group"})]}),(0,i.jsx)(Pe.Z,{label:_.format("toolbarPermissionHasChildren"),name:"hasChildren",initialValue:!0})]})]})}),En=Pn,Dn=null,N=new Me.Uo("components.explorer"),wn=(0,u.forwardRef)(function(r,l){(0,u.useImperativeHandle)(l,function(){return{close:function(){K([]),v("")}}});var s=r.type=="host"?"common":"app",R=(0,u.useContext)(je.Z),n=R.message,S=(0,u.useRef)(),L=(0,u.useRef)(),W=(0,u.useRef)(),V=(0,u.useRef)(),I=(0,u.useRef)(),Z=(0,b.useSearchParams)(),_=z()(Z,2),le=_[0],K=_[1],y=(0,u.useState)(),g=z()(y,2),f=g[0],P=g[1],O=(0,u.useState)(""),x=z()(O,2),he=x[0],v=x[1];(0,u.useEffect)(function(){var w;n.info(N.format("commonMessageCreateExplorerPlugin")),v((w=r.workDir)!==null&&w!==void 0?w:"")},[]);function ue(w,t){return Fe.apply(this,arguments)}function Fe(){return Fe=E()(a()().mark(function w(t,o){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:(c=S.current)===null||c===void 0||c.addHistory(t,o),v(o),!((p=W.current)===null||p===void 0)&&p.reloadAndRest&&((d=W.current)===null||d===void 0||d.reloadAndRest()),o=="/"?K([]):(le.set("path",o),K(le));case 4:case"end":return m.stop()}},w)})),Fe.apply(this,arguments)}return r&&(0,i.jsxs)(ye.Z.Provider,{value:{name:r.name,apiPrefix:s,currentPath:he,showPath:ue,redirectPath:function(t){var o;if(v(t),W.current&&(o=W.current)!==null&&o!==void 0&&o.reloadAndRest){var c;(c=W.current)===null||c===void 0||c.reloadAndRest()}t=="/"?K([]):(le.set("path",t),K(le))},refresh:function(){var t;if(W&&typeof((t=W.current)===null||t===void 0?void 0:t.reloadAndRest)=="function"){var o;(o=W.current)===null||o===void 0||o.reloadAndRest()}}},children:[(0,i.jsx)(Qe.Co,{sticky:!1,quickToolbar:{offsetTop:10,target:function(){return document.querySelector(".file-explorer .ant-drawer-body")},render:function(t){var o=t.selectedRows,c=o.map(function(p){return p.path});return[r.onConsole&&(0,i.jsx)(Ae.ZP,{onClick:function(){r.onConsole&&r.onConsole(he)},children:"Console"},"fileConsole"),(0,i.jsx)(_n,{},"upload"),(0,i.jsx)(Ae.ZP,{icon:(0,i.jsx)(Ye.Z,{}),onClick:function(){L.current&&L.current.newFile()},type:"primary",children:N.format("toolbarNewButton")},"newfile")]}},headerTitle:(0,i.jsx)(J.Z,{ref:S}),actionRef:W,search:!1,rowKey:"name",pagination:{pageSize:500,position:["topRight","bottomRight"]},request:E()(a()().mark(function w(){var t,o,c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Oe(s,{name:r.name,path:he});case 2:if(o=m.sent,he==""&&o.data.currentPath!=""&&v(o.data.currentPath),c=[],(t=S.current)===null||t===void 0||t.initHistory(o.data.currentPath.split("/").filter(function(C){return C!=""}).map(function(C){return c.push(C),{title:C,path:"/".concat(c.join("/"))}}),o.data.rootDirs),p=f,p){m.next=13;break}return m.next=10,ge(s,{name:r.name});case 10:d=m.sent,P(d.data),p=d.data;case 13:return m.abrupt("return",{data:o.data.list.map(function(C){if(p){var Q,Be;C.group=(Q=(Be=p.group.find(function(be){return be.gid==C.group}))===null||Be===void 0?void 0:Be.name)!==null&&Q!==void 0?Q:C.group}return C}),success:!0,total:o.data.list.length});case 14:case"end":return m.stop()}},w)})),columns:[{title:N.format("listName"),dataIndex:"name",key:"name",render:function(D,o,c,p,d){var D;return o.isDir?D=(0,i.jsx)(Ue.Z,{isDir:!0,onClick:function(){return ue(o.name,o.path)},showName:o.name}):o.isSymlink?D=(0,i.jsx)(Ue.Z,{isLink:!0,showName:"".concat(o.name," -> ").concat(o.linkName),onClick:E()(a()().mark(function m(){var C,Q;return a()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.next=2,q(s,{name:r.name,path:o.path});case 2:C=be.sent,C.data.info.isDir?ue(o.name,C.data.info.target):(Q=L.current)===null||Q===void 0||Q.editFile(C.data.info.name,C.data.info.target,o.size);case 4:case"end":return be.stop()}},m)}))}):D=(0,i.jsx)(Ue.Z,{showName:o.name,onClick:function(){var C;(C=L.current)===null||C===void 0||C.editFile(o.name,o.path,o.size)}}),D}},{title:N.format("listStatus"),key:"status",width:110,render:function(t,o,c,p,d){return o.change>-1&&(0,i.jsx)(Ge.Z,{title:N.format("listStatusTipOption.".concat(o.change)),children:(0,i.jsx)(Je.Z,{color:N.format("listStatusColorOption.".concat(o.change)),children:N.format("listStatusOption.".concat(o.change))})})}},{title:N.format("listModStr"),dataIndex:"modStr",key:"mod"},{title:N.format("listUser"),dataIndex:"user"},{title:N.format("listGroup"),dataIndex:"group"},{title:N.format("listSize"),dataIndex:"size",key:"size",render:function(t,o,c,p,d){return(0,Ze.FI)(o.size)}},{title:N.format("listModTime"),dataIndex:"modTime",key:"modTime",sorter:function(t,o){return new Date(t.modTime).getTime()-new Date(o.modTime).getTime()},render:function(t,o,c,p,d){return(0,Ze.NF)(o.modTime)}}],cardProps:{ghost:!0},actions:[{key:"edit",label:Me.FD.format("listManageEdit"),showInContext:"manage",buttonProps:{icon:(0,i.jsx)(Xe.Z,{})},action:function(t){return E()(a()().mark(function o(){var c,p,d,D,m;return a()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRow,c(),Q.next=4,q(s,{name:r.name,path:d.path}).finally(function(){p(!0)});case 4:D=Q.sent,D.data.info.isDir?ue(d.name,D.data.info.target):(m=L.current)===null||m===void 0||m.editFile(D.data.info.name,D.data.info.target,d.size);case 6:case"end":return Q.stop()}},o)}))()},disable:function(t){return t.isMultiple()||t.selectedRow&&t.selectedRow.isDir||t.selectedRows.length==0}},{key:"permission",label:N.format("toolbarPermissionButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(qe.Z,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:p=t.finish,d=t.selectedRows,p(!0),(c=V.current)===null||c===void 0||c.show(d);case 3:case"end":return m.stop()}},o)}))()}},{key:"rename",label:N.format("toolbarRenameButton"),showInContext:"manage",buttonProps:{icon:(0,i.jsx)(an,{})},confirmProps:function(t){var o=t.finish;return{onOpenChange:function(p,d){var D;(D=I.current)===null||D===void 0||D.resetFields(),p&&o()},getPopupContainer:function(p){return document.querySelector(".file-explorer .ant-pro-table")},zIndex:9999,description:(0,i.jsx)(Te.A,{submitter:!1,style:{width:300,paddingTop:10,paddingRight:10},formRef:I,children:(0,i.jsx)(ie.Z,{name:"targetFile"})})}},action:function(t){return E()(a()().mark(function o(){var c,p,d,D;return a()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return p=t.loading,d=t.finish,D=t.selectedRow,p(),C.abrupt("return",h(s,{name:r.name,sourceFile:D.path,targetFile:"./".concat((c=I.current)===null||c===void 0?void 0:c.getFieldValue("targetFile")),isMove:!0}).finally(function(){d(!0)}));case 3:case"end":return C.stop()}},o)}))()},disable:function(t){return t.isMultiple()||t.selectedRows.length==0}},{key:"unzip",label:N.format("toolbarUnzipButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(dn,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",xe(s,{name:r.name,file:d.map(function(C){return C.path}),path:he}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()},addDivider:!0},{key:"download",label:N.format("toolbarDownloadButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(cn.Z,{})},disable:function(t){return t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.selectedRows,p=t.loading,d=t.finish,p(),m.abrupt("return",B(s,{name:r.name,fileList:c.map(function(C){return C.path})}).then(function(C){var Q=new Blob([C],{type:"application/zip"});(0,fn.saveAs)(Q,"export.zip")}).finally(function(){d(!0)}));case 3:case"end":return m.stop()}},o)}))()}},{key:"export",label:N.format("toolbarExportButton"),showInContext:"operator",buttonProps:{icon:(0,i.jsx)(mn.Z,{})},disable:function(t){return r.type=="host"||t.selectedRows.length==0},action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",B(s,{name:r.name,fileList:d.map(function(C){return C.path}),enableExportToPath:!0}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()}},{key:"delete",showInContext:!0,action:function(t){return E()(a()().mark(function o(){var c,p,d;return a()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=t.loading,p=t.finish,d=t.selectedRows,c(),m.abrupt("return",Ce(s,{name:r.name,fileList:d.map(function(C){return C.path})}).finally(function(){p(!0)}));case 3:case"end":return m.stop()}},o)}))()}}]},"explorer-list"),(0,i.jsx)(ke,{onFinish:function(){var t;!((t=W.current)===null||t===void 0)&&t.reset&&W.current.reset()},ref:L}),(0,i.jsx)(En,{ref:V},"chmod")]})}),Rn=wn,On=e(85265),Cn=e(99922),yn=(0,u.forwardRef)(function(r,l){var s,R=(0,u.useState)(!1),n=z()(R,2),S=n[0],L=n[1],W=(0,u.useState)(),V=z()(W,2),I=V[0],Z=V[1],_=(0,u.useRef)(),le=new Me.Uo("components.explorer"),K=(0,u.useContext)(je.Z),y=K.loading,g=(0,u.useRef)();return(0,u.useImperativeHandle)(l,function(){return{showContainer:function(P,O){Z({name:(0,Ze.fi)(P,"/"),type:"container",workDir:O!=null?O:void 0}),L(!0)},showHost:function(P){Z({name:P,type:"host"}),L(!0)},showVolume:function(P){return E()(a()().mark(function O(){var x;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return y.show(),v.next=3,re("app",{name:P}).finally(function(){y.destroy()});case 3:x=v.sent,Z({name:x.data.containerName,type:"container",workDir:x.data.path}),L(!0);case 6:case"end":return v.stop()}},O)}))()}}}),(0,i.jsxs)(i.Fragment,{children:[r.trigger?u.cloneElement(r.trigger,{onClick:function(){r.name&&r.type&&(Z(r),L(!0))}}):null,(0,i.jsxs)(On.Z,{destroyOnHidden:!0,width:Se.R_,title:le.format("drawerTitle",{name:(s=r.title)!==null&&s!==void 0?s:I==null?void 0:I.name}),onClose:E()(a()().mark(function f(){var P;return a()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(y.show(),L(!1),(P=_.current)===null||P===void 0||P.close(),Z(void 0),!r.onCloseDestroy){x.next=7;break}return x.next=7,oe("app");case 7:y.destroy();case 8:case"end":return x.stop()}},f)})),rootClassName:"file-explorer",open:S,children:[r.showConsole&&(0,i.jsx)(Cn.Z,{showFileExplorer:!1,ref:g}),S&&I&&(0,i.jsx)(Rn,Y()(Y()({ref:_},I),{},{onConsole:r.showConsole?function(f){var P;(P=g.current)===null||P===void 0||P.show({url:"/console/container/".concat(I.name),title:I.name,workDir:f})}:void 0}))]})]})}),xn=yn},90581:function(Ie,Ee,e){var we=e(15009),Y=e.n(we),X=e(99289),a=e.n(X),pe=e(5574),E=e.n(pe),de=e(3616),z=e(97269),u=e(38345),b=e(64317),Oe=e(37476),Re=e(62370),B=e(97462),H=e(11106),$=e(42075),ee=e(83622),Ce=e(83062),k=e(67294),xe=e(1883),ce=e(33160),ne=e(58638),ve=e(63713),De=e(75520),_e=e(36146),F=e(85893),ae=(0,k.forwardRef)(function(U,me){var ge=(0,k.useState)(!1),j=E()(ge,2),q=j[0],M=j[1],re=(0,k.useRef)(),T=new _e.Uo("components.console"),oe=(0,k.useRef)();return(0,k.useImperativeHandle)(me,function(){return{reset:function(){var h;(h=oe.current)===null||h===void 0||h.resetFields()}}}),(0,F.jsx)(z.A,{layout:"inline",submitter:!1,formRef:oe,children:(0,F.jsx)(u.Z,{ghost:!0,children:(0,F.jsxs)($.Z,{children:[(0,F.jsx)(b.Z,{width:"sm",name:"entryCmd",placeholder:T.format("toolbarEntryCmdEmpty"),valueEnum:{"/bin/sh":"/bin/sh","/bin/bash":"/bin/bash"},onChange:function(h){U.onChangeShell&&U.onChangeShell(h)}}),(0,F.jsx)(Oe.Y,{modalProps:{width:de.ob,height:de.Ed},title:T.format("toolbarBatchCommandTitle"),name:"batchCommand",open:q,trigger:(0,F.jsx)(ee.ZP,{icon:(0,F.jsx)(xe.Z,{}),children:T.format("toolbarBatchCommandTitle")}),formKey:"batchCommand",formRef:re,isKeyPressSubmit:!0,onFinish:function(){var G=a()(Y()().mark(function h(te){return Y()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:U.onBatchCommandFinish&&U.onBatchCommandFinish(te.shell.split(`
`)),M(!1);case 2:case"end":return ie.stop()}},h)}));return function(h){return G.apply(this,arguments)}}(),onOpenChange:function(h){M(h),h&&re.current&&re.current.resetFields()},children:(0,F.jsx)(Re.Z,{name:"shell",children:(0,F.jsx)(H.ZP,{theme:"dark",height:de.Ed})})}),(0,F.jsx)(ee.ZP,{onClick:function(){U.onChangeShell&&U.onChangeShell()},icon:(0,F.jsx)(ce.Z,{}),type:"primary",children:_e.FD.format("listManageRefresh")}),(0,F.jsx)(B.Z,{name:["entryCmd"],children:function(h){var te=h.entryCmd;return(!te||te=="")&&(te="/bin/sh"),U.onOpenNewWindow&&(0,F.jsx)(ve.Link,{onClick:function(){U.onOpenNewWindowFinish&&U.onOpenNewWindowFinish()},target:"_blank",to:U.onOpenNewWindow({cmd:te}),children:(0,F.jsx)(Ce.Z,{title:T.format("toolbarOpenInNewWindowTip"),children:(0,F.jsx)(ee.ZP,{type:"dashed",icon:(0,F.jsx)(ne.Z,{})})})})}}),(0,F.jsx)(De.Z,{buttonProps:{shape:"default",size:"middle"}})]})})})});Ee.Z=ae},49610:function(Ie,Ee,e){var we=e(5574),Y=e.n(we),X=e(67294),a=e(52626),pe=e(78267),E=e.n(pe),de=e(12323),z=e(87662),u=e(4244),b=e.n(u),Oe=e(24078),Re=e(85893),B,H,$,ee,Ce=(0,X.forwardRef)(function(k,xe){var ce,ne=(0,X.useState)(),ve=Y()(ne,2),De=ve[0],_e=ve[1],F=(0,X.useState)(""),ae=Y()(F,2),U=ae[0],me=ae[1];(0,X.useImperativeHandle)(xe,function(){return{start:function(q,M){ge(),H.fit(),M.width=B.cols,M.height=B.rows;var re=M?Object.keys(M).filter(function(T){return M&&M[T]}).map(function(T){if(M&&M[T])return"".concat(T,"=").concat(M[T])}):[];$=new WebSocket((0,a.R)(q+"?"+re.join("&"))),$.addEventListener("message",function(T){var oe=JSON.parse(T.data),G=oe.type;if(G==q&&(B.write(oe.data),oe.data.indexOf("exec failed")!=-1)){ge();return}}),ee=B.onData(function(T){var oe={content:{command:T},type:q};$&&$.send(JSON.stringify(oe))}),me(q),_e(M)},close:function(){ge()},fit:function(){return H.fit(),{width:B.cols,height:B.rows}},run:function(q){De&&q&&q.forEach(function(M){var re={content:{command:M+`
`},type:U};$&&$.send(JSON.stringify(re))})}}}),(0,X.useEffect)(function(){return B=new u.Terminal(de.X),H=new pe.FitAddon,B.loadAddon(H),B.open(document.getElementById("terminal-container-console")),H.fit(),(0,z.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(j){j.data&&j.data.fontSize&&Object.assign(B.options,j.data)}),function(){ge()}},[]),(0,X.useEffect)(function(){window.addEventListener("resize",function(){H.fit();var j={size:{width:B.cols,height:B.rows},type:U};U&&$&&$.send(JSON.stringify(j))})},[U]);function ge(){ee&&(B.reset(),H.fit(),B.focus(),ee.dispose()),$&&($.close(),$=null)}return(0,Re.jsx)("div",{style:{height:(ce=k.height)!==null&&ce!==void 0?ce:"100vh"},id:"terminal-container-console"})});Ee.Z=Ce}}]);
