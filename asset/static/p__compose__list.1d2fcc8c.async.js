"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8022],{91806:function(w,E,n){n.d(E,{Z:function(){return R}});var P=n(87462),c=n(67294),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},m=O,M=n(84089),g=function(C,I){return c.createElement(M.Z,(0,P.Z)({},C,{ref:I,icon:m}))},v=c.forwardRef(g),R=v},33862:function(w,E,n){n.d(E,{Z:function(){return R}});var P=n(87462),c=n(67294),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 289.1a362.49 362.49 0 00-79.9-115.7 370.83 370.83 0 00-118.2-77.8C610.7 76.6 562.1 67 512 67c-50.1 0-98.7 9.6-144.5 28.5-44.3 18.3-84 44.5-118.2 77.8A363.6 363.6 0 00169.4 289c-19.5 45-29.4 92.8-29.4 142 0 70.6 16.9 140.9 50.1 208.7 26.7 54.5 64 107.6 111 158.1 80.3 86.2 164.5 138.9 188.4 153a43.9 43.9 0 0022.4 6.1c7.8 0 15.5-2 22.4-6.1 23.9-14.1 108.1-66.8 188.4-153 47-50.4 84.3-103.6 111-158.1C867.1 572 884 501.8 884 431.1c0-49.2-9.9-97-29.4-142zM512 880.2c-65.9-41.9-300-207.8-300-449.1 0-77.9 31.1-151.1 87.6-206.3C356.3 169.5 431.7 139 512 139s155.7 30.5 212.4 85.9C780.9 280 812 353.2 812 431.1c0 241.3-234.1 407.2-300 449.1zm0-617.2c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 551c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 439c0-29.9 11.7-58 32.8-79.2C454 338.6 482.1 327 512 327c29.9 0 58 11.6 79.2 32.8C612.4 381 624 409.1 624 439c0 29.9-11.6 58-32.8 79.2z"}}]},name:"environment",theme:"outlined"},m=O,M=n(84089),g=function(C,I){return c.createElement(M.Z,(0,P.Z)({},C,{ref:I,icon:m}))},v=c.forwardRef(g),R=v},96781:function(w,E,n){var P=n(67294),c=(0,P.createContext)({});E.Z=c},92922:function(w,E,n){n.r(E),n.d(E,{default:function(){return fe}});var P=n(15009),c=n.n(P),O=n(99289),m=n.n(O),M=n(5574),g=n.n(M),v=n(90098),R=n(30159),W=n(33160),C=n(87784),I=n(99611),Q=n(86548),G=n(16596),H=n(1883),V=n(95591),N=n(23430),Y=n(74453),K=n(82346),j=n(83062),J=n(25593),X=n(66309),q=n(42075),h=n(67294),ee=n(94359),A=n(67255),ne=n(96781),te=n(91218),ae=n(1699),se=n(83403),f=n(36146),L=n(55375),B=n(96486),he=n.n(B),re=n(37413),oe=n(87662),ie=n(5251),y=n(93162),Pe=n.n(y),le=n(42013),ce=n(55681),ue=n(83002),de=n(29463),_e=n(2831),d=n(85893);function fe(){var x=(0,h.useContext)(ne.Z),T=x.listTableRef,$=x.reload,U=(0,h.useRef)(),me=(0,K.useAccess)(),Z=(0,K.useLocation)(),F=new f.Uo("compose"),pe=(0,h.useState)(""),b=g()(pe,2),ve=b[0],Ee=b[1],S=(0,h.useRef)(),k=(0,h.useRef)(),z=(0,h.useRef)();return(0,h.useEffect)(function(){(0,oe.K3)().then(function(u){var e;Ee((e=u.data.serverUrl)!==null&&e!==void 0?e:"")})},[]),(0,h.useEffect)(function(){var u;Z.state&&!((u=T.current)===null||u===void 0)&&u.setPageInfo&&T.current.setPageInfo({current:(0,A.G$)(L.q9,T.current.pageInfo)})},[Z.state,T.current]),(0,d.jsxs)(Y._z,{header:{extra:[(0,d.jsx)(ae.u,{access:"canSeeComposeListManageCreate",children:(0,d.jsx)(le.Z,{onFinish:function(e){var a,t;!((a=U.current)===null||a===void 0)&&a.show&&((t=U.current)===null||t===void 0||t.show(e)),$()},ref:z})},"create")]},children:[(0,d.jsx)(ue.Z,{ref:S},"composeLog"),(0,d.jsx)(te.Z,{ref:U,onClose:function(){$()}}),(0,d.jsx)(de.Z,{ref:k}),(0,d.jsx)(ce.Co,{tableKey:L.q9,request:function(){var u=m()(c()().mark(function e(a){var t;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,v.pm)({title:a.title,name:a.name});case 2:return t=o.sent,o.abrupt("return",{data:t.data.list.map(function(s){var i=t.data.containerList.filter(function(r){return r.project==s.name});return i&&(s.containerList=i),s}),success:!0,total:t.data.list.length});case 4:case"end":return o.stop()}},e)}));return function(e){return u.apply(this,arguments)}}(),rowKey:function(e){return e.id>0?e.id:e.name},columns:[{key:"name",title:f.FD.format("listName"),dataIndex:"name",width:300,render:function(e,a,t,l,o){return(0,d.jsx)(j.Z,{title:"".concat(a.title),placement:"right",children:(0,d.jsx)(J.Z.Link,{onClick:function(){var i;(i=U.current)===null||i===void 0||i.show(a.id||a.name)},children:a.name})})},sorter:function(e,a){return e.name.localeCompare(a.name)},defaultSortOrder:(0,A.rj)(L.q9,"name"),sortDirections:A.h5},{key:"title",title:f.FD.format("listTitle"),dataIndex:"title",width:200},{key:"ports",title:f.FD.format("listAccess"),tooltip:f.FD.format("listAccessTip"),width:150,dataIndex:"ports",search:!1,render:function(e,a,t,l){if((0,B.isEmpty)(a.containerList))return null;var o=[],s=[];return a.containerList&&a.containerList.forEach(function(i){i.publishers.forEach(function(r){r.publishedPort?o.push({PrivatePort:r.targetPort,Type:r.protocol,IP:r.url,PublicPort:r.publishedPort}):r.publishedPort&&s.push({PrivatePort:r.targetPort,Type:r.protocol,IP:r.url,PublicPort:r.publishedPort})})}),(0,d.jsx)(re.Z,{publicPort:o,privatePort:s,domain:[],serverIp:ve})}},{title:f.FD.format("listType"),width:150,search:!1,render:function(e,a,t,l,o){var s,i=a.setting&&a.setting.type?a.setting.type:"default";return(0,d.jsx)(j.Z,{placement:"right",title:((s=a.setting.uri)!==null&&s!==void 0?s:[]).join(", "),children:(0,d.jsx)(X.Z,{color:F.format("listTypeColorOption.".concat(i)),children:F.format("listTypeOption.".concat(i))})})}},{title:f.FD.format("listStatus"),dataIndex:"status",search:!1,key:"status",render:function(e,a,t,l,o){return(0,d.jsx)(q.Z,{children:a.setting.status.split(", ").map(function(s,i){var r,_="running",p=s.indexOf("(");return p>-1?_=s.slice(0,p):_=s,(0,d.jsx)(ee.Z,{status:"compose.".concat(_),statusValue:{count:s.slice(p+1,s.length-1)},tip:"".concat(s," ").concat((r=a.setting.message)!==null&&r!==void 0?r:"")},i)})})},sorter:function(e,a){return e.setting.status.localeCompare(a.setting.status)},defaultSortOrder:(0,A.rj)(L.q9,"status")},{title:f.FD.format("listUpdatedAt"),dataIndex:"",search:!1,width:180,render:function(e,a,t,l,o){return(0,ie.NF)(a.setting.updatedAt)},sorter:function(e,a){var t,l;return new Date((t=e.setting.updatedAt)!==null&&t!==void 0?t:"").toLocaleString().localeCompare(new Date((l=a.setting.updatedAt)!==null&&l!==void 0?l:"").toLocaleString())},key:"updated",defaultSortOrder:(0,A.rj)(L.q9,"updated")}],rowSelection:me.canSeeComposeListManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0,getCheckboxProps:function(e){return{disabled:e.setting.type=="dangling"||e.setting.type=="outPath"}}}:void 0,actionRef:T,actions:[{key:"pause",label:"".concat(f.FD.format("listManagePause")," & ").concat(f.FD.format("listManageUnpause")),icon:(0,d.jsx)(R.Z,{}),isMultiple:!0,showInContext:"operator",action:function(e){return m()(c()().mark(function a(){var t,l,o,s;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.loading,l=e.selectedRows,o=e.finish,t(),s=l.some(function(_){return _.setting.status.includes("paused")}),r.abrupt("return",Promise.all(l.map(function(_){return(0,v.GG)({id:_.id||_.name,op:s?"unpause":"pause"})})).finally(function(){o(!0)}));case 4:case"end":return r.stop()}},a)}))()}},{key:"restart",label:"".concat(f.FD.format("listManageStart")," & ").concat(f.FD.format("listManageRestart")),icon:(0,d.jsx)(W.Z,{}),isMultiple:!0,showInContext:"operator",action:function(e){return m()(c()().mark(function a(){var t,l,o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.loading,l=e.selectedRows,o=e.finish,t(),i.abrupt("return",Promise.all(l.map(function(r){return(0,v.GG)({id:r.id||r.name,op:"restart"})})).finally(function(){o(!0)}));case 3:case"end":return i.stop()}},a)}))()}},{key:"stop",label:f.FD.format("listManageStop"),icon:(0,d.jsx)(C.Z,{}),isMultiple:!0,showInContext:"operator",action:function(e){return m()(c()().mark(function a(){var t,l,o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.loading,l=e.finish,o=e.selectedRows,t(),i.abrupt("return",Promise.all(o.map(function(r){return(0,v.GG)({id:r.id||r.name,op:"stop"})})).finally(function(){l(!0)}));case 3:case"end":return i.stop()}},a)}))()}},{key:"view",label:f.FD.format("listManageView"),icon:(0,d.jsx)(I.Z,{}),showInContext:"manage",action:function(e){return m()(c()().mark(function a(){var t,l,o,s;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o=e.finish,s=e.selectedRow,o(!0),s&&((t=U.current)===null||t===void 0||t.show((l=s.id)!==null&&l!==void 0?l:s.name));case 3:case"end":return r.stop()}},a)}))()}},{key:"edit",label:f.FD.format("listManageEdit"),icon:(0,d.jsx)(Q.Z,{}),showInContext:"manage",action:function(e){return m()(c()().mark(function a(){var t,l,o,s;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o=e.finish,s=e.selectedRow,o(!0),s&&((t=z.current)===null||t===void 0||t.edit((l=s.id)!==null&&l!==void 0?l:s.name));case 3:case"end":return r.stop()}},a)}))()}},{key:"update",label:f.FD.format("listManageUpgrade"),showInContext:"manage",showInOperator:!0,icon:(0,d.jsx)(G.Z,{}),action:function(e){return m()(c()().mark(function a(){var t,l,o,s;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=e.finish,o=e.loading,s=e.selectedRow,o(),r.abrupt("return",(0,v.Oh)({id:(t=s.id)!==null&&t!==void 0?t:s.name,pullImage:!0}).finally(function(){l(!0)}));case 3:case"end":return r.stop()}},a)}))()}},{key:"log",label:f.FD.format("listManageLog"),icon:(0,d.jsx)(H.Z,{}),showInContext:"manage",showInOperator:!0,action:function(e){return m()(c()().mark(function a(){var t,l,o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:l=e.finish,o=e.selectedRow,(t=S.current)===null||t===void 0||t.show(o),l(!0);case 3:case"end":return i.stop()}},a)}))()}},{key:"file",label:f.FD.format("listManageFilePath"),icon:(0,d.jsx)(V.Z,{}),showInContext:"manage",showInOperator:!0,action:function(e){return m()(c()().mark(function a(){var t,l,o,s,i,r;return c()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return l=e.finish,o=e.selectedRow,p.next=3,(0,_e.aF)();case 3:s=p.sent,s.data&&(t=s.data.dpanel.containerInfo)!==null&&t!==void 0&&t.Name&&((i=k.current)===null||i===void 0||i.showContainer((r=s.data.dpanel.containerInfo)===null||r===void 0?void 0:r.Name,"/dpanel/compose/".concat(o.name))),l(!0);case 6:case"end":return p.stop()}},a)}))()}},{key:"download",label:f.FD.format("listManageDownload"),icon:(0,d.jsx)(N.Z,{}),showInContext:"manage",action:function(e){return m()(c()().mark(function a(){var t,l,o,s,i;return c()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(t=e.loading,l=e.finish,o=e.selectedRow,t(),o){_.next=4;break}return _.abrupt("return");case 4:return _.next=6,(0,v.tw)({id:o.id||o.name}).finally(function(){l(!0)});case 6:s=_.sent,i=new Blob([s],{type:"application/zip"}),(0,y.saveAs)(i,"compose-"+o.name+".zip");case 9:case"end":return _.stop()}},a)}))()}},{key:"dataPermission",label:se.W6.COMPOSE},{key:"delete",action:function(e){return m()(c()().mark(function a(){var t,l,o;return c()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.loading,l=e.finish,o=e.selectedRows,t(),i.abrupt("return",Promise.all(o.map(function(){var r=m()(c()().mark(function _(p){return c()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(0,v.j6)({id:p.id||p.name,deleteData:!0,deletePath:!0});case 2:return D.abrupt("return",D.sent);case 3:case"end":return D.stop()}},_)}));return function(_){return r.apply(this,arguments)}}())).finally(function(){l(!0)}));case 3:case"end":return i.stop()}},a)}))()}}]},"table")]})}}}]);
