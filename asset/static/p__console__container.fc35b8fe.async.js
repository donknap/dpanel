"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(S,E,n){var y=n(5574),v=n.n(y),m=n(67294),a=n(52626),M=n(78267),l=n.n(M),o=n(12323),j=n(87662),P=n(4244),b=n.n(P),C=n(24078),T=n(85893),s,f,_,O,h=(0,m.forwardRef)(function(B,W){var U,R=(0,m.useState)(),L=v()(R,2),A=L[0],w=L[1],I=(0,m.useState)(""),t=v()(I,2),r=t[0],u=t[1];(0,m.useImperativeHandle)(W,function(){return{start:function(g,i){e(),f.fit(),i.width=s.cols,i.height=s.rows;var D=i?Object.keys(i).filter(function(d){return i&&i[d]}).map(function(d){if(i&&i[d])return"".concat(d,"=").concat(i[d])}):[];_=new WebSocket((0,a.R)(g+"?"+D.join("&"))),_.addEventListener("message",function(d){var p=JSON.parse(d.data),K=p.type;if(K==g&&(s.write(p.data),p.data.indexOf("exec failed")!=-1)){e();return}}),O=s.onData(function(d){var p={content:{command:d},type:g};_&&_.send(JSON.stringify(p))}),u(g),w(i)},close:function(){e()},fit:function(){return f.fit(),{width:s.cols,height:s.rows}},run:function(g){A&&g&&g.forEach(function(i){var D={content:{command:i+`
`},type:r};_&&_.send(JSON.stringify(D))})}}}),(0,m.useEffect)(function(){return s=new P.Terminal(o.X),f=new M.FitAddon,s.loadAddon(f),s.open(document.getElementById("terminal-container-console")),f.fit(),(0,j.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(c){c.data&&c.data.fontSize&&Object.assign(s.options,c.data)}),function(){e()}},[]),(0,m.useEffect)(function(){window.addEventListener("resize",function(){f.fit();var c={size:{width:s.cols,height:s.rows},type:r};r&&_&&_.send(JSON.stringify(c))})},[r]);function e(){O&&(s.reset(),f.fit(),s.focus(),O.dispose()),_&&(_.close(),_=null)}return(0,T.jsx)("div",{style:{height:(U=B.height)!==null&&U!==void 0?U:"100vh"},id:"terminal-container-console"})});E.Z=h},12323:function(S,E,n){n.d(E,{X:function(){return y},n:function(){return v}});var y={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},v=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},15563:function(S,E,n){n.r(E),n.d(E,{default:function(){return P}});var y=n(5574),v=n.n(y),m=n(49610),a=n(13822),M=n(5251),l=n(82346),o=n(67294),j=n(85893);function P(){var b=(0,l.useParams)(),C=(0,l.useSearchParams)(),T=v()(C,2),s=T[0],f=T[1],_=(0,o.useRef)();return(0,o.useEffect)(function(){b.id&&(0,a.jV)({md5:b.id}).then(function(O){var h;window.document.title="".concat((0,M.fi)(O.data.info.Name,"/")," - console"),b.id&&((h=_.current)===null||h===void 0||h.start("/console/container/".concat(O.data.info.Id),{cmd:s.get("cmd"),workDir:s.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,j.jsx)(m.Z,{ref:_})}},13822:function(S,E,n){n.d(E,{IE:function(){return b},IW:function(){return j},KK:function(){return O},LJ:function(){return B},RF:function(){return L},Re:function(){return U},aF:function(){return w},eE:function(){return f},jV:function(){return T}});var y=n(5574),v=n.n(y),m=n(15009),a=n.n(m),M=n(99289),l=n.n(M),o=n(82346);function j(t){return P.apply(this,arguments)}function P(){return P=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/status",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),P.apply(this,arguments)}function b(t){return C.apply(this,arguments)}function C(){return C=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-list",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),C.apply(this,arguments)}function T(t){return s.apply(this,arguments)}function s(){return s=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-detail",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),s.apply(this,arguments)}function f(t){return _.apply(this,arguments)}function _(){return _=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/update",{data:r,method:"POST"}));case 1:case"end":return e.stop()}},t)})),_.apply(this,arguments)}function O(){return h.apply(this,arguments)}function h(){return h=l()(a()().mark(function t(){return a()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,o.request)("/dpanel/api/app/container/prune",{method:"POST"}));case 1:case"end":return u.stop()}},t)})),h.apply(this,arguments)}function B(t){return W.apply(this,arguments)}function W(){return W=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.enableExportToPath){e.next=2;break}return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/export",{method:"GET",params:r}));case 2:return e.abrupt("return",new Promise(function(c,g){var i=localStorage.getItem("token"),D=new URLSearchParams;D.append("token",i||""),Object.entries(r).forEach(function(K){var k=v()(K,2),$=k[0],x=k[1];D.append($,String(x))});var d="/dpanel/api/app/container/export?".concat(D.toString()),p=document.createElement("iframe");p.style.display="none",p.src=d,document.body.appendChild(p),setTimeout(function(){p.parentElement&&document.body.removeChild(p)},5e3),c({code:200,data:"success",error:""})}));case 3:case"end":return e.stop()}},t)})),W.apply(this,arguments)}function U(t){return R.apply(this,arguments)}function R(){return R=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/commit",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),R.apply(this,arguments)}function L(t){return A.apply(this,arguments)}function A(){return A=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/upgrade",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),A.apply(this,arguments)}function w(t){return I.apply(this,arguments)}function I(){return I=l()(a()().mark(function t(r){return a()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/copy",{method:"POST",data:r}));case 1:case"end":return e.stop()}},t)})),I.apply(this,arguments)}}}]);
