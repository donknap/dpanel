"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7523],{75544:function(te,L,e){var S=e(5574),l=e.n(S),G=e(12323),a=e(78267),p=e.n(a),u=e(75458),O=e.n(u),E=e(67294),j=e(4244),R=e.n(j),T=e(24078),M=e(85893),y,x,s,I=(0,E.forwardRef)(function(t,F){var f,le=(0,E.useState)(!0),re=l()(le,2),de=re[0],ne=re[1];return(0,E.useEffect)(function(){return y=new j.Terminal(G.X),x=new u.SearchAddon,s=new a.FitAddon,window.addEventListener("resize",function(){t.showInModal||s.fit()}),t.style&&t.style.fontSize&&(y.options.fontSize=t.style.fontSize),y.loadAddon(s),y.loadAddon(x),y.open(document.getElementById(t.id?t.id:"terminal-container")),t.showInModal||s.fit(),function(){y.reset(),ne(!0)}},[]),(0,E.useImperativeHandle)(F,function(){return{write:function(D){de&&(s.fit(),ne(!1)),y.write(D)},clear:function(){y.clear()},getTerminal:function(){return y},findNext:function(D){x.findNext(D)},findPrev:function(D){x.findPrevious(D)},fit:function(){s.fit()},onData:function(D){return y.onData(D)}}}),(0,M.jsx)("div",{id:t.id?t.id:"terminal-container",style:{width:t.width?t.width:"100%",height:t.height?t.height:"500px",marginTop:(f=t.style)===null||f===void 0?void 0:f.marginTop}})});L.Z=I},94359:function(te,L,e){e.d(L,{Z:function(){return I}});var S=e(5574),l=e.n(S),G=e(3089),a=e(98165),p=e(18429),u=e(8751),O=e(66212),E=e(14313),j=e(30159),R=e(87740),T=e(50888),M=e(66309),y=e(83062),x=e(36146),s=e(85893);function I(t){var F,f,le=new x.Uo("components.containerStatus"),re=t.status.split("."),de=l()(re,2),ne=de[0],o=de[1],D="";D=le.format(t.status,(F=t.statusValue)!==null&&F!==void 0?F:{});var d=(0,s.jsx)(s.Fragment,{});return o=="0"&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(G.Z,{}),color:"default",children:D})),o=="10"&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(a.Z,{spin:!0}),color:"processing",children:D})),o=="20"&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(p.Z,{}),color:"error",children:D})),o=="30"&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(u.Z,{}),color:"success",children:D})),o=="new"&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(O.Z,{}),children:D})),(o=="running"||o=="healthy"||o=="active"||o=="ready")&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(E.Z,{}),color:"success",children:D})),(o=="paused"||o=="pause"||o=="rollback_paused")&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(j.Z,{}),color:"warning",children:D})),(o=="waiting"||o=="starting"||o=="accepted")&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(R.Z,{}),children:D})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(o)&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(T.Z,{}),color:"processing",children:D})),(o=="error"||o=="down"||o=="failed")&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(p.Z,{}),color:"error",children:D})),["complete","completed","rollback_completed"].includes(o)&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(u.Z,{}),color:"success",children:D})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(o)&&(d=(0,s.jsx)(M.Z,{icon:(0,s.jsx)(p.Z,{}),color:"warning",children:D})),(0,s.jsx)(y.Z,{placement:"top",title:(f=t.tip)!==null&&f!==void 0?f:"",children:d})}},78451:function(te,L,e){e.d(L,{Z:function(){return G}});var S=e(67294),l=e(85893);function G(a){var p;return(0,l.jsx)("span",{style:{width:a.width?a.width:"auto",wordBreak:"break-word"},children:(p=a.content)!==null&&p!==void 0?p:a.children})}},51100:function(te,L,e){e.d(L,{Z:function(){return p}});var S=e(4813),l=e(91604),G=e(1677),a=e(85893);function p(u){return u.showDragger?(0,a.jsx)(l.Z,{max:u.max?u.max:1,title:u.title,label:u.label,required:u.required,rules:[{required:u.required}],fieldProps:{multiple:!!(u.max&&u.max>1),name:"file",accept:u.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(E){return new Promise(function(j){var R;(0,S._)({path:(R=E.response.data.path)!==null&&R!==void 0?R:""}).then(function(T){j(!0)})})},onChange:function(E){E.file.status=="done"&&u.onFinish&&u.onFinish(E.fileList)}},name:u.name}):(0,a.jsx)(G.Z,{max:u.max?u.max:1,title:u.title,label:u.label,required:u.required,rules:[{required:u.required}],fieldProps:{multiple:!!(u.max&&u.max>1),name:"file",accept:u.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(E){return new Promise(function(j){var R;(0,S._)({path:(R=E.response.data.path)!==null&&R!==void 0?R:""}).then(function(T){j(!0)})})},onChange:function(E){E.file.status=="done"&&u.onFinish&&u.onFinish(E.fileList)}},name:u.name})}},12323:function(te,L,e){e.d(L,{X:function(){return S},n:function(){return l}});var S={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},l=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},65913:function(te,L,e){var S=e(5574),l=e.n(S),G=e(74330),a=e(67294),p=e(85893),u=(0,a.forwardRef)(function(O,E){(0,a.useImperativeHandle)(E,function(){return{show:function(){M(!0)},destroy:function(){M(!1)}}});var j=(0,a.useState)(!1),R=l()(j,2),T=R[0],M=R[1];return(0,p.jsx)(G.Z,{spinning:T,size:"default",children:O.children})});L.Z=u},99430:function(te,L,e){e.r(L),e.d(L,{default:function(){return Ne}});var S=e(97857),l=e.n(S),G=e(15009),a=e.n(G),p=e(99289),u=e.n(p),O=e(74453),E=e(25593),j=e(42075),R=e(97841),T=e(94359),M=e(82061),y=e(99611),x=e(86548),s=e(87740),I=e(80821),t=e(67294),F=e(5574),f=e.n(F),le=e(38345),re=e(82346),de=e(75544),ne=e(3616),o=e(36146),D=e(85265),d=e(74330),B=e(38703),r=e(85893),i=(0,t.forwardRef)(function(K,se){var _=(0,re.useModel)("subscriber"),V=(0,t.useRef)(),J=(0,t.useState)(!1),g=f()(J,2),h=g[0],Z=g[1],H=(0,t.useState)(""),w=f()(H,2),m=w[0],b=w[1],X=(0,t.useState)(0),P=f()(X,2),U=P[0],C=P[1];return(0,t.useImperativeHandle)(se,function(){return{start:function(){for(var v=arguments.length,n=new Array(v),c=0;c<v;c++)n[c]=arguments[c];var z=n.join(":");Z(!0),C(0),b(z),_.addDataHandler("image:"+z,function(Y){var Q;if(Y.data.includes("Step")){var q=Array.from(Y.data.matchAll(/Step\s+(\d+)\/(\d+)/g));if(q.length>0){var W=q[q.length-1],k=parseInt(W[1],10),ee=parseInt(W[2],10);if(ee>0&&k>=1&&k<=ee){var ie=k/ee*100;C(Math.round(ie))}}}(Q=V.current)===null||Q===void 0||Q.write(Y.data)})},close:function(){var v;(v=V.current)===null||v===void 0||v.clear(),Z(!1)},error:function(){C(-100)},show:function(v){Z(!0),setTimeout(function(){var n,c;(n=V.current)===null||n===void 0||n.clear(),(c=V.current)===null||c===void 0||c.write(v)},500)}}}),(0,r.jsx)(D.Z,{width:ne.ob,destroyOnHidden:!0,title:o.FD.format("listLog"),afterOpenChange:function(v){if(v){var n,c;(n=V.current)===null||n===void 0||n.clear(),(c=V.current)===null||c===void 0||c.fit()}},onClose:function(){_.progress.close("image:"+m),Z(!1),C(0),b(""),K.onFinish&&K.onFinish()},open:h,children:(0,r.jsx)(le.Z,{ghost:!0,children:(0,r.jsxs)(d.Z,{spinning:U==0,children:[(0,r.jsx)(B.Z,{strokeLinecap:"butt",status:U<0?"exception":"normal",percent:Math.abs(U),size:["100%",10],percentPosition:{align:"center",type:"inner"},format:function(){return null}}),(0,r.jsx)(de.Z,{style:{fontSize:12},height:"85vh",ref:V})]})})})}),je=i,Ce=e(19632),ce=e.n(Ce),ye=e(91058),ge=e(11106),ve=e(62370),Ee=e(12491);function Re(K){var se=new o.Uo("image");return(0,r.jsx)(ve.Z,{shouldUpdate:!0,children:function(V){var J=V.getFieldValue,g=V.setFieldValue;return[(0,r.jsx)(ve.Z,{name:K.name,hidden:!0},"input"),(0,r.jsx)(Ee.Z,{title:se.format("formBuildDockerfileContent"),onImport:function(Z){return g(K.name,Z),!0},onLoad:function(Z){if(Z.indexOf("FROM ")<0)throw new Error(o.FD.format("commonFileIncorrectFormat",{name:"Dockerfile"}));return!0}},"importFile"),(0,r.jsx)(ge.ZP,{value:J("buildDockerfileContent"),onChange:function(Z){g(K.name,Z)},height:"600px",theme:"dark",style:{marginBottom:"20px"}},"codeMirror")]}})}var Ie=e(51100),$e=e(75870),ae=e(5966),Te=e(24739),xe=e(64317),Be=e(86615),we=e(97462),De=e(90672),Ue=e(83622),Ae=e(83062),Le=e(27166),Ze=e(47837),We=e(48399),Se=e(73813),Ke=e(68297),Fe=e(24963),Ge=(0,t.forwardRef)(function(K,se){var _=new o.Uo("image"),V=(0,t.useContext)(Fe.Z),J=V.message,g=(0,t.useRef)(),h=(0,t.useRef)(),Z=(0,t.useState)(!1),H=f()(Z,2),w=H[0],m=H[1],b=(0,t.useRef)(),X=(0,t.useState)(""),P=f()(X,2),U=P[0],C=P[1];return(0,t.useImperativeHandle)(se,function(){return{show:function(v){return u()(a()().mark(function n(){var c,z,Y,Q,q,W,k,ee,ie,me,ue,fe,_e,N,pe,$,oe,he,Oe;return a()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return m(!0),(c=b.current)===null||c===void 0||c.loading(),Pe.next=4,(0,R.Xr)({id:v}).finally(function(){var Me;(Me=b.current)===null||Me===void 0||Me.finish()});case 4:N=Pe.sent,(z=N.data.detail.setting)!==null&&z!==void 0&&z.buildGit&&(he=N.data.detail.setting.buildGit,he.includes("#")?(Oe=(0,Ze.Z)(he,"#"),pe=he.slice(0,Oe),$=he.slice(Oe+1)):pe=he,$&&$.includes(":")&&($=$.slice(0,(0,We.Z)($,":"))),pe.includes("@")&&(oe=new URL(pe),oe&&(pe="".concat(oe.origin).concat(oe.pathname)))),(Y=h.current)===null||Y===void 0||Y.setFieldsValue({id:N.data.detail.id,title:N.data.detail.title,imageTag:(Q=N.data.detail.setting)===null||Q===void 0?void 0:Q.tag,imageRegistry:(q=N.data.detail.setting)===null||q===void 0?void 0:q.registry,buildType:(W=N.data.detail.setting)===null||W===void 0?void 0:W.buildType,buildDockerfileRoot:(k=N.data.detail.setting)===null||k===void 0?void 0:k.buildDockerfileRoot,buildDockerfileContent:(ee=N.data.detail.setting)===null||ee===void 0?void 0:ee.buildDockerfileContent,buildDockerfileName:(ie=N.data.detail.setting)===null||ie===void 0?void 0:ie.buildDockerfileName,buildGit:pe,buildGitBranch:$,buildGitUsername:(me=oe)===null||me===void 0?void 0:me.username,buildGitPassword:(ue=oe)===null||ue===void 0?void 0:ue.password,buildArgs:(fe=N.data.detail.setting)===null||fe===void 0?void 0:fe.buildArgs,platform:(_e=N.data.detail.setting)===null||_e===void 0?void 0:_e.platform});case 7:case"end":return Pe.stop()}},n)}))()}}}),(0,r.jsx)(Le.Z,{drawerProps:{width:ne.R_},ref:b,title:o.Ob.format("image.create"),open:w,onOpenChange:function(v){if(m(v),!v){var n;(n=h.current)===null||n===void 0||n.resetFields(),K.onFinish&&K.onFinish()}},trigger:(0,r.jsx)(Ue.ZP,{type:"primary",children:o.Ob.format("image.create")},"create"),onFinish:function(){var A=u()(a()().mark(function v(n){var c,z,Y,Q,q,W,k,ee,ie,me,ue,fe,_e,N;return a()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(z=(c=n.buildType)!==null&&c!==void 0?c:"dockerfile",z!="containerTar"){$.next=7;break}return $.next=4,(0,Se.Ck)({tag:n.imageTag,registry:n.imageRegistry,tar:(Y=n.containerTar[0].response.data.path)!==null&&Y!==void 0?Y:"",cmd:n.cmd,workDir:n.workDir,expose:n.expose?n.expose.split(`
`):[],env:n.env?n.env.split(`
`):[],volume:n.volume?n.volume.split(`
`):[]});case 4:return $.abrupt("return",!0);case 7:return W={name:"",arch:""},Ke.ii.map(function(oe){oe.name==n.platform&&(W=oe)}),k={id:n.id?parseInt(n.id):0,tag:n.imageTag,title:n.title,registry:n.imageRegistry,buildDockerfileContent:n.buildDockerfileContent,buildDockerfileRoot:n.buildDockerfileRoot,buildDockerfileName:n.buildDockerfileName,buildZip:"",buildGit:n.buildGit,buildType:n.buildType,buildArgs:n.buildArgs},n.buildZip&&n.buildZip.length>0&&(k.buildZip=(ee=n.buildZip[0].response.data.path)!==null&&ee!==void 0?ee:""),z=="git"&&(k.buildGit=k.buildGit+"#"+(n.buildGitBranch||"master"),n.buildDockerfileRoot&&n.buildDockerfileRoot!=""&&(k.buildGit="".concat(k.buildGit,":").concat(n.buildDockerfileRoot)),n.buildGitUsername&&n.buildGitPassword&&(ie="https://",k.buildGit.includes("http://")&&(ie="http://"),k.buildGit="".concat(k.buildGit.replace(ie,"".concat(ie).concat(n.buildGitUsername,":").concat(n.buildGitPassword,"@"))))),(Q=g.current)===null||Q===void 0||Q.start("build",((q=k.id)!==null&&q!==void 0?q:0).toString()),C(""),$.prev=14,$.next=17,(0,R.l9)(k);case 17:if(ue=$.sent,ue.data.id&&((fe=h.current)===null||fe===void 0||fe.setFieldValue("id",ue.data.id)),!ue.data.error){$.next=23;break}return C(ue.data.error),(_e=g.current)===null||_e===void 0||_e.error(),$.abrupt("return");case 23:return J.success(o.FD.format("finish")),(me=g.current)===null||me===void 0||me.close(),$.abrupt("return",!0);case 28:return $.prev=28,$.t0=$.catch(14),C(String($.t0)),(N=g.current)===null||N===void 0||N.error(),$.abrupt("return",!1);case 33:case"end":return $.stop()}},v,null,[[14,28]])}));return function(v){return A.apply(this,arguments)}}(),formRef:h,children:(0,r.jsxs)(le.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,r.jsxs)(le.Z,{ghost:!0,children:[(0,r.jsx)(ve.Z,{name:"id",hidden:!0}),(0,r.jsx)(ae.Z,{width:"lg",label:_.format("formTitle"),name:"title"}),(0,r.jsxs)(Te.UW,{children:[(0,r.jsx)(xe.Z,{width:"lg",label:_.format("formImageRegistry"),tooltip:_.format("formImageRegistryTip"),name:"imageRegistry",request:u()(a()().mark(function A(){var v;return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,$e.Ot)();case 2:return v=c.sent,c.abrupt("return",v.data.list.map(function(z){return{value:z.serverAddress,label:z.title+"("+z.serverAddress+")"}}));case 4:case"end":return c.stop()}},A)}))}),(0,r.jsx)(ae.Z,{rules:[{required:!0}],width:"lg",required:!0,tooltip:_.format("formImageTagTip"),placeholder:_.format("formImageTagEmpty"),label:_.format("formImageTag"),name:"imageTag"})]}),(0,r.jsx)(Be.Z.Group,{name:"buildType",initialValue:"dockerfile",label:_.format("formBuildType"),options:_.option("formBuildTypeOption",["dockerfile","zip","git","containerTar"]).map(function(A){return{label:(0,r.jsx)(Ae.Z,{title:_.format("formBuildTypeTipOption."+A.value),children:A.label}),value:A.value}})}),(0,r.jsx)(we.Z,{name:["buildType"],children:function(v){var n=v.buildType,c=[];return n=="containerTar"?c=[(0,r.jsx)(ae.Z,{tooltip:_.format("formWorkDirTip"),label:_.format("formWorkDir"),name:"workDir",placeholder:_.format("formWorkDirEmpty")},"workDir"),(0,r.jsx)(ae.Z,{required:!0,tooltip:_.format("formCmdTip"),rules:[{required:!0}],label:"CMD",name:"cmd"},"cmd"),(0,r.jsx)(De.Z,{tooltip:_.format("formExposeTip"),label:_.format("formExpose"),name:"expose",placeholder:`80 
9000`},"expose"),(0,r.jsx)(De.Z,{tooltip:_.format("formEnvTip"),label:_.format("formEnv"),name:"env",placeholder:`TEST_VALUE=123 
TEST_NO_VALUE=`},"env"),(0,r.jsx)(De.Z,{tooltip:_.format("formVolumeTip"),label:_.format("formVolume"),name:"volume",placeholder:`/app 
/home`},"volume")]:(n=="zip"||n=="git")&&(c=[(0,r.jsxs)(Te.UW,{children:[(0,r.jsx)(ae.Z,{width:"lg",name:"buildDockerfileRoot",label:_.format("formBuildDockerfileRoot"),fieldProps:{addonBefore:"/"},placeholder:_.format("formBuildDockerfileRootEmpty")},"buildDockerfileRoot"),(0,r.jsx)(ae.Z,{width:"lg",name:"buildDockerfileName",label:_.format("formBuildDockerfileName"),placeholder:_.format("formBuildDockerfileNameEmpty")},"dockerfileName")]},"buildRoot"),(0,r.jsx)(ye.Z,{drawerProps:{ghost:!0},name:"buildArgs",showAddButton:!0,showCodeMode:!0,listLabel:_.format("formBuildArgs")},"env")]),n=="zip"&&(c=[].concat(ce()(c),[(0,r.jsx)(Ie.Z,{required:!0,label:_.format("formBuildZip"),name:"buildZip",accept:".zip"},"buildZip")])),n=="containerTar"&&(c=[].concat(ce()(c),[(0,r.jsx)(Ie.Z,{required:!0,label:_.format("formBuildContainerTar"),name:"containerTar",accept:".tar"},"containerTar")])),n=="git"&&(c=[].concat(ce()(c),[(0,r.jsxs)(Te.UW,{children:[(0,r.jsxs)(j.Z.Compact,{block:!0,children:[(0,r.jsx)(ae.Z,{width:"md",label:_.format("formBuildGitUsername"),name:"buildGitUsername",placeholder:_.format("formBuildGitUsernameEmpty")}),(0,r.jsx)(ae.Z,{width:"md",label:_.format("formBuildGitPassword"),name:"buildGitPassword"})]}),(0,r.jsxs)(j.Z.Compact,{block:!0,children:[(0,r.jsx)(ae.Z,{label:_.format("formBuildGitBranch"),width:"md",name:"buildGitBranch"}),(0,r.jsx)(ae.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],width:"lg",required:!0,placeholder:_.format("formBuildGitEmpty"),label:_.format("formBuildGit"),name:"buildGit"})]})]},"buildGit")])),n=="dockerfile"&&(c=[].concat(ce()(c),[(0,r.jsx)(Re,{name:"buildDockerfileContent"},"buildDockerfileContent")])),c}})]}),(0,r.jsx)(je,{onFinish:function(){if(U&&U!=""){var v;(v=h.current)===null||v===void 0||v.resetFields(["buildZip"])}else m(!1),K.onFinish&&K.onFinish()},ref:g})]})})}),ke=Ge,be=e(98510),ze=e(1584);function Ne(){var K=(0,t.useRef)(),se=(0,t.useRef)(),_=(0,t.useRef)(),V=(0,t.useRef)();return(0,r.jsxs)(O._z,{header:{extra:[(0,r.jsx)(ke,{ref:_,onFinish:function(){var g;!((g=K.current)===null||g===void 0)&&g.reloadAndRest&&K.current.reloadAndRest()}},"create")]},children:[(0,r.jsx)(ze.Z,{ref:V}),(0,r.jsx)(be.C,{actionRef:K,rowKey:"id",columns:[{title:o.FD.format("listTitle"),render:function(g,h,Z,H){return h.title}},{title:o.FD.format("listImageName"),dataIndex:"tag",search:!1,render:function(g,h,Z,H){var w,m,b;return(0,r.jsx)(E.Z.Link,{type:!((w=h.setting)!==null&&w!==void 0&&w.imageId)||h.setting.imageId==""?"secondary":void 0,onClick:function(){var P,U,C;!((P=h.setting)===null||P===void 0)&&P.imageId&&((U=V.current)===null||U===void 0||U.show((C=h.setting)===null||C===void 0?void 0:C.imageId))},children:(m=(b=h.setting)===null||b===void 0?void 0:b.tag)!==null&&m!==void 0?m:h.tag})}},{title:o.FD.format("listStatus"),width:150,ellipsis:!0,search:!1,render:function(g,h,Z,H){var w;return(w=h.setting)!==null&&w!==void 0&&w.imageId||(h.status=0),[(0,r.jsx)("div",{children:(0,r.jsx)(T.Z,{status:"status.".concat(h.status)},h.id)},h.id)]}}],request:function(){var J=u()(a()().mark(function g(h,Z,H){var w,m,b;return a()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,R.bJ)({page:(w=h.current)!==null&&w!==void 0?w:1,pageSize:(m=h.pageSize)!==null&&m!==void 0?m:10});case 2:return b=P.sent,P.abrupt("return",{data:b.data.list,success:!0,total:b.data.list.length});case 4:case"end":return P.stop()}},g)}));return function(g,h,Z){return J.apply(this,arguments)}}(),quickToolbarRender:function(g){var h=g.selectedRows,Z=g.finish,H=g.loading;return(0,r.jsx)(j.Z,{size:16,children:(0,r.jsx)(I.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,r.jsx)(M.Z,{})},confirmProps:{showCommonConfirm:!0},action:u()(a()().mark(function w(){return a()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return H(),b.abrupt("return",(0,R.hf)({id:h.map(function(X){return X.id})}).finally(function(){Z(!0)}));case 2:case"end":return b.stop()}},w)})),onSuccess:function(){var m,b;return!((m=K.current)===null||m===void 0)&&m.reloadAndRest&&((b=K.current)===null||b===void 0||b.reloadAndRest()),!0},onError:function(){var m,b;return!((m=K.current)===null||m===void 0)&&m.reset&&((b=K.current)===null||b===void 0||b.reset()),!0},children:o.FD.format("listManageDeleteBatch")})})},contextMenu:function(g){var h,Z=g.loading,H=g.finish,w=g.isMultiple,m=g.selectedRow,b=g.selectedRows;return{items:[{type:"group",label:o.FD.format("listManage"),key:"operator",children:[{label:(0,r.jsx)(be.C.ContextMenuItem,{buttonProps:{icon:(0,r.jsx)(y.Z,{}),disabled:w()||(m==null||(h=m.setting)===null||h===void 0?void 0:h.imageId)==""},action:u()(a()().mark(function X(){var P,U,C;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:H(!0),!((P=m.setting)===null||P===void 0)&&P.imageId&&((U=V.current)===null||U===void 0||U.show((C=m.setting)===null||C===void 0?void 0:C.imageId));case 2:case"end":return v.stop()}},X)})),children:o.FD.format("listManageView")}),key:"view"},{label:(0,r.jsx)(be.C.ContextMenuItem,{buttonProps:{icon:(0,r.jsx)(x.Z,{}),disabled:w()},action:u()(a()().mark(function X(){var P;return a()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:H(!0),m.id&&((P=_.current)===null||P===void 0||P.show(m.id));case 2:case"end":return C.stop()}},X)})),children:o.FD.format("listManageEdit")}),key:"edit"},{label:(0,r.jsx)(be.C.ContextMenuItem,{buttonProps:{icon:(0,r.jsx)(s.Z,{}),disabled:w()},action:u()(a()().mark(function X(){var P,U,C,A,v,n,c,z,Y,Q;return a()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return Z(),(P=se.current)===null||P===void 0||P.start("build",((U=m.id)!==null&&U!==void 0?U:0).toString()),W.prev=2,W.next=5,(0,R.l9)(l()(l()({id:m.id,title:m.title},m.setting),{},{buildDockerfileContent:((C=m.setting)===null||C===void 0?void 0:C.buildDockerfileContent)||((A=m.setting)===null||A===void 0?void 0:A.buildDockerfile),buildDockerfileRoot:((v=m.setting)===null||v===void 0?void 0:v.buildDockerfileRoot)||((n=m.setting)===null||n===void 0?void 0:n.buildRoot),buildType:((c=m.setting)===null||c===void 0?void 0:c.buildType)||m.buildType,tag:((z=m.setting)===null||z===void 0?void 0:z.tag)||m.tag}));case 5:return Y=W.sent,W.abrupt("return",!0);case 9:W.prev=9,W.t0=W.catch(2),(Q=se.current)===null||Q===void 0||Q.error();case 12:return W.prev=12,H(!0),W.finish(12);case 15:case"end":return W.stop()}},X,null,[[2,9,12,15]])})),children:o.FD.format("listManageBuild")}),key:"redo"}]},{key:"delete",label:(0,r.jsx)(be.C.ContextMenuItem,{buttonProps:{icon:(0,r.jsx)(M.Z,{})},type:"danger",confirmProps:{showCommonConfirm:!0},action:u()(a()().mark(function X(){return a()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return Z(),U.abrupt("return",(0,R.hf)({id:b.map(function(C){return C.id})}).finally(function(){H(!0)}));case 2:case"end":return U.stop()}},X)})),children:o.FD.format("listManageDelete")},"deleteBatch")}]}}}),(0,r.jsx)(je,{onFinish:function(){var g;!((g=K.current)===null||g===void 0)&&g.reloadAndRest&&K.current.reloadAndRest()},ref:se})]})}},4813:function(te,L,e){e.d(L,{_:function(){return u}});var S=e(15009),l=e.n(S),G=e(99289),a=e.n(G),p=e(82346);function u(E){return O.apply(this,arguments)}function O(){return O=a()(l()().mark(function E(j){return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,p.request)("/dpanel/api/common/attach/delete",{method:"POST",data:j});case 2:return T.abrupt("return",T.sent);case 3:case"end":return T.stop()}},E)})),O.apply(this,arguments)}},97841:function(te,L,e){e.d(L,{Xr:function(){return M},bJ:function(){return R},c5:function(){return x},hf:function(){return u},l9:function(){return E}});var S=e(15009),l=e.n(S),G=e(99289),a=e.n(G),p=e(82346);function u(I){return O.apply(this,arguments)}function O(){return O=a()(l()().mark(function I(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,p.request)("/dpanel/api/app/image-build/delete",{method:"POST",data:t});case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},I)})),O.apply(this,arguments)}function E(I){return j.apply(this,arguments)}function j(){return j=a()(l()().mark(function I(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,p.request)("/dpanel/api/app/image-build/create",{method:"POST",data:t}));case 1:case"end":return f.stop()}},I)})),j.apply(this,arguments)}function R(I){return T.apply(this,arguments)}function T(){return T=a()(l()().mark(function I(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,p.request)("/dpanel/api/app/image-build/get-list",{method:"POST",data:t}));case 1:case"end":return f.stop()}},I)})),T.apply(this,arguments)}function M(I){return y.apply(this,arguments)}function y(){return y=a()(l()().mark(function I(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,p.request)("/dpanel/api/app/image-build/get-detail",{method:"POST",data:t});case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},I)})),y.apply(this,arguments)}function x(){return s.apply(this,arguments)}function s(){return s=a()(l()().mark(function I(){return l()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,p.request)("/dpanel/api/app/image-build/prune",{method:"POST"});case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},I)})),s.apply(this,arguments)}},73813:function(te,L,e){e.d(L,{Ck:function(){return u},Fj:function(){return I},GH:function(){return E},KG:function(){return M},Rb:function(){return le},Xz:function(){return R},YU:function(){return F},ZQ:function(){return de},ao:function(){return x},cD:function(){return o}});var S=e(15009),l=e.n(S),G=e(99289),a=e.n(G),p=e(82346);function u(d){return O.apply(this,arguments)}function O(){return O=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/import-by-container-tar",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),O.apply(this,arguments)}function E(d){return j.apply(this,arguments)}function j(){return j=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/import-by-image-tar",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),j.apply(this,arguments)}function R(d){return T.apply(this,arguments)}function T(){return T=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,p.request)("/dpanel/api/app/image/prune",{method:"POST"});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},d)})),T.apply(this,arguments)}function M(d){return y.apply(this,arguments)}function y(){return y=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/get-list",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),y.apply(this,arguments)}function x(d){return s.apply(this,arguments)}function s(){return s=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,p.request)("/dpanel/api/app/image/delete",{method:"POST",data:B});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},d)})),s.apply(this,arguments)}function I(d){return t.apply(this,arguments)}function t(){return t=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,p.request)("/dpanel/api/app/image/update-title",{method:"POST",data:B});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},d)})),t.apply(this,arguments)}function F(d){return f.apply(this,arguments)}function f(){return f=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/get-detail",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),f.apply(this,arguments)}function le(d){return re.apply(this,arguments)}function re(){return re=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!B.enableExportToPath){i.next=2;break}return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/export",{method:"POST",data:B}));case 2:return i.abrupt("return",new Promise(function(je,Ce){var ce,ye=localStorage.getItem("token"),ge=new URLSearchParams;ge.append("token",ye||""),B.md5&&B.md5.forEach(function(Re){ge.append("md5",Re)}),ge.append("enableExportToPath",String((ce=B.enableExportToPath)!==null&&ce!==void 0?ce:!1));var ve="/dpanel/api/app/image/export?".concat(ge.toString()),Ee=document.createElement("iframe");Ee.style.display="none",Ee.src=ve,document.body.appendChild(Ee),je({code:200,data:"success",error:""})}));case 3:case"end":return i.stop()}},d)})),re.apply(this,arguments)}function de(d){return ne.apply(this,arguments)}function ne(){return ne=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/app/image/check-upgrade",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),ne.apply(this,arguments)}function o(d){return D.apply(this,arguments)}function D(){return D=a()(l()().mark(function d(B){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,p.request)("/dpanel/api/pro/image/get-rootfs",{method:"POST",data:B}));case 1:case"end":return i.stop()}},d)})),D.apply(this,arguments)}},75870:function(te,L,e){e.d(L,{Ot:function(){return u},ZH:function(){return E},ix:function(){return R},t1:function(){return M}});var S=e(15009),l=e.n(S),G=e(99289),a=e.n(G),p=e(82346);function u(x){return O.apply(this,arguments)}function O(){return O=a()(l()().mark(function x(s){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/dpanel/api/common/registry/get-list",{method:"POST",data:s}));case 1:case"end":return t.stop()}},x)})),O.apply(this,arguments)}function E(x){return j.apply(this,arguments)}function j(){return j=a()(l()().mark(function x(s){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/dpanel/api/common/registry/create",{method:"POST",data:s}));case 1:case"end":return t.stop()}},x)})),j.apply(this,arguments)}function R(x){return T.apply(this,arguments)}function T(){return T=a()(l()().mark(function x(s){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/dpanel/api/common/registry/delete",{method:"POST",data:s}));case 1:case"end":return t.stop()}},x)})),T.apply(this,arguments)}function M(x){return y.apply(this,arguments)}function y(){return y=a()(l()().mark(function x(s){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,p.request)("/dpanel/api/common/registry/get-detail",{method:"POST",data:s}));case 1:case"end":return t.stop()}},x)})),y.apply(this,arguments)}}}]);
