"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4316],{52645:function(Re,k,e){e.d(k,{Z:function(){return f}});var X=e(87462),F=e(67294),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},c=q,ee=e(84089),H=function(x,B){return F.createElement(ee.Z,(0,X.Z)({},x,{ref:B,icon:c}))},N=F.forwardRef(H),f=N},36435:function(Re,k,e){var X=e(15009),F=e.n(X),q=e(64599),c=e.n(q),ee=e(99289),H=e.n(ee),N=e(9783),f=e.n(N),ce=e(5574),x=e.n(ce),B=e(67294),xe=e(184),Ee=e(38345),Ie=e(97269),te=e(97321),$=e(97462),Ce=e(64317),Se=e(5966),ne=e(86615),le=e(68602),be=e(83622),Z=e(83403),je=e(24963),De=e(1699),Te=e(29177),Le=e(1883),ye=e(43425),Ze=e(44349),Ue=e(3616),ie=e(36146),M=e(85893),Fe=(0,B.forwardRef)(function(A,Q){var me=(0,B.useState)(!1),P=x()(me,2),G=P[0],oe=P[1],K=(0,B.useRef)(),z=(0,B.useContext)(je.Z),t=z.message,We=(0,B.useState)([]),_e=x()(We,2),fe=_e[0],V=_e[1],S=new ie.Uo("components.permissionButton"),Me=f()(f()(f()(f()(f()({},Z.W6.CONTAINER,"Id"),Z.W6.APPSTORE,"name"),Z.W6.COMPOSE,"name"),Z.W6.REGISTRY,"serverAddress"),Z.W6.DOCKER_ENV,"name"),Ae=f()(f()(f()(f()(f()({},Z.W6.CONTAINER,"name"),Z.W6.APPSTORE,"name"),Z.W6.COMPOSE,"name"),Z.W6.REGISTRY,"title"),Z.W6.DOCKER_ENV,"title"),Oe=Me[A.type],Be=Ae[A.type],Ke=A.selected.map(function(C){return C[Me[A.type]]});return B.useEffect(function(){if(G){if(!A.selected||A.selected.length==0){t.error(ie.FD.format("title.noDataSelect")),oe(!1);return}(0,le.dP)({permission:{uri:A.type,key:Oe,value:Ke}}).then(function(C){var p;(p=K.current)===null||p===void 0||p.setFieldValue("list",Object.keys(C.data.list).map(function(j){return{name:j,type:C.data.list[j].type,users:C.data.list[j].users}}))}),(0,le.lE)().then(function(C){var p,j=(p=C.data)===null||p===void 0||(p=p.list)===null||p===void 0?void 0:p.map(function(D){return{label:D.username,value:D.username}});V(j)})}},[G]),(0,M.jsx)(De.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,M.jsxs)(xe.a,{name:"create",title:S.format("drawerTitle"),open:G,onOpenChange:function(p){if(!p){var j;(j=K.current)===null||j===void 0||j.resetFields()}oe(p)},drawerProps:{forceRender:!0,width:Ue.R_},formRef:K,trigger:(0,M.jsx)(be.ZP,{icon:(0,M.jsx)(Te.Z,{}),children:S.format("drawerTriggerButton")}),onFinish:function(){var C=H()(F()().mark(function p(j){var D,R,i;return F()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:D=c()(j.list),y.prev=1,D.s();case 3:if((R=D.n()).done){y.next=9;break}return i=R.value,y.next=7,(0,le.Db)({usernames:i.users,permissionType:i.type,permission:{uri:A.type,key:Oe,showKey:Be,value:[i.name]}});case 7:y.next=3;break;case 9:y.next=14;break;case 11:y.prev=11,y.t0=y.catch(1),D.e(y.t0);case 14:return y.prev=14,D.f(),y.finish(14);case 17:t.success(ie.FD.format("finish")),oe(!1),A.onSuccess();case 20:case"end":return y.stop()}},p,null,[[1,11,14,17]])}));return function(p){return C.apply(this,arguments)}}(),children:[(0,M.jsxs)(Ee.Z,{ghost:!0,title:(0,M.jsx)(Le.Z,{}),subTitle:S.format("batchTitle"),children:[(0,M.jsx)(Ie.A.Item,{name:"type",style:{marginBottom:0},children:(0,M.jsx)(te.Z.Group,{defaultValue:"admin",onChange:function(p){var j,D,R=(j=K.current)===null||j===void 0?void 0:j.getFieldValue("list");R.forEach(function(i){i.type=p,i.users=[]}),(D=K.current)===null||D===void 0||D.setFieldValue("list",R)},children:["admin","restricted","public"].map(function(C){return(0,M.jsx)(te.Z,{style:{width:240},title:S.format("dataTypeOption.".concat(C)),description:S.format("dataTypeDescOption.".concat(C)),value:C},C)})})}),(0,M.jsx)($.Z,{name:["type"],children:function(p){var j=p.type;if(j==="restricted")return(0,M.jsx)(Ce.Z,{mode:"multiple",name:"usernames",label:S.format("formUsernames"),onChange:function(R){var i,W,y=(i=K.current)===null||i===void 0?void 0:i.getFieldValue("list");y.forEach(function(b){b.users=R}),(W=K.current)===null||W===void 0||W.setFieldValue("list",y)},rules:[{required:!0}],request:H()(F()().mark(function D(){var R,i,W;return F()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(fe.length>0)){b.next=2;break}return b.abrupt("return",fe);case 2:return b.next=4,(0,le.lE)();case 4:return i=b.sent,W=(R=i.data)===null||R===void 0||(R=R.list)===null||R===void 0?void 0:R.map(function(T){return{label:T.username,value:T.username}}),V(W),b.abrupt("return",W);case 8:case"end":return b.stop()}},D)}))})}})]}),(0,M.jsx)(Ee.Z,{ghost:!0,title:(0,M.jsx)(ye.Z,{}),subTitle:S.format("dataTitle"),children:(0,M.jsx)(Ze.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:S.format("dataName"),render:function(p,j,D){var R=D.getCurrentRowData();return(0,M.jsx)(Se.Z,{disabled:!0,label:S.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:S.format("dataType"),render:function(p,j,D){var R=D.getCurrentRowData();return(0,M.jsx)(ne.Z.Group,{label:S.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(i){return{label:S.format("dataTypeOption.".concat(i)),value:i}})})}},{name:"users",label:S.format("dataUsers"),render:function(p,j,D){return(0,M.jsx)($.Z,{name:["type"],children:function(i){var W=i.type;if(W=="restricted")return(0,M.jsx)(Ce.Z,{width:"sm",mode:"tags",name:"users",label:S.format("dataUsers"),options:fe})}})}}]})})]})})});k.Z=Fe},14668:function(Re,k,e){e.r(k),e.d(k,{default:function(){return rt}});var X=e(64599),F=e.n(X),q=e(15009),c=e.n(q),ee=e(19632),H=e.n(ee),N=e(99289),f=e.n(N),ce=e(5574),x=e.n(ce),B=e(74453),xe=e(34041),Ee=e(97269),Ie=e(62370),te=e(42075),$=e(25593),Ce=e(40411),Se=e(96074),ne=e(83062),le=e(84567),be=e(82346),Z=e(1883),je=e(89035),De=e(95591),Te=e(16596),Le=e(52645),ye=e(82061),Ze=e(33160),Ue=e(87784),ie=e(30159),M=e(99611),Fe=e(86548),A=e(94359),Q=e(13822),me=e(80821),P=e(67294),G=e(62597),oe=e(87662),K=e(16165),z=e(5251),t=e(85893),We=function(){return(0,t.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18403",children:(0,t.jsx)("path",{d:"M224 192v64H96v576h128v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h128V256h-128V192h-64v64h-64V192h-64v64h-64V192h-64v64h-64V192h-64v64H288V192z m-64 128h704v448H160z m96 64c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 512c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m512 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 640c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z","p-id":"18404"})})},_e=function(){return(0,t.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18546",children:(0,t.jsx)("path",{d:"M64 224v576h416v-32c0-17.76 14.24-32 32-32 17.76 0 32 14.24 32 32v32h416V224z m64 64h768v288H128z m64 64v160h192v-160z m224 0v160h192v-160z m224 0v160h192v-160zM256 416h64v32H256z m224 0h64v32h-64z m224 0h64v32h-64zM128 640h768v96h-300.992c-14.144-35.52-42.752-64-83.008-64-40.256 0-68.864 28.48-83.008 64H128z","p-id":"18547"})})};function fe(L){var ve,J,he,ue,pe,ge;return(0,t.jsx)(t.Fragment,{children:L.value&&L.value.memory&&L.value.memory.out>0?(0,t.jsxs)(te.Z,{children:[(0,t.jsxs)(ne.Z,{title:"Cpu: ".concat((ve=L.value)===null||ve===void 0?void 0:ve.cpu.toFixed(2),"%"),children:[(0,t.jsx)(K.Z,{component:We,style:{width:15,lineHeight:20}})," ","".concat((J=L.value)===null||J===void 0?void 0:J.cpu.toFixed(2),"%")]}),(0,t.jsxs)(ne.Z,{title:"Memory: ".concat((0,z.FI)((he=L.value)===null||he===void 0?void 0:he.memory.in)," / ").concat((0,z.FI)((ue=L.value)===null||ue===void 0?void 0:ue.memory.out)),children:[(0,t.jsx)(K.Z,{component:_e,style:{width:15,lineHeight:20}})," ","".concat((((pe=L.value)===null||pe===void 0?void 0:pe.memory.in)/((ge=L.value)===null||ge===void 0?void 0:ge.memory.out)*100).toFixed(2),"%")]})]}):""})}var V=e(67255),S=e(37413),Me=e(3905),Ae=e(99922),Oe=e(83403),Be=e(20578),Ke=e(99861),C=e(78914),p=e(29453),j=e(8287),D=e(29463),R=e(78451),i=e(36146),W=e(36435),y=e(1699),b=e(55375),T=e(98510),at=e(84941);function rt(){var L=new i.Uo("components.appDetail"),ve=new i.Uo("app"),J=(0,be.useAccess)(),he=(0,P.useState)(""),ue=x()(he,2),pe=ue[0],ge=ue[1],st=(0,P.useState)(1),Ge=x()(st,2),Y=Ge[0],ae=Ge[1],lt=(0,P.useState)([]),Je=x()(lt,2),de=Je[0],it=Je[1],ot=(0,P.useState)(),Ye=x()(ot,2),we=Ye[0],ut=Ye[1],dt=(0,P.useState)([]),Xe=x()(dt,2),qe=Xe[0],ct=Xe[1],re=(0,P.useRef)(),Ne=(0,P.useRef)(),$e=(0,P.useRef)(),ze=(0,P.useRef)(),Ve=(0,P.useRef)(),et=(0,P.useRef)(),ke=(0,P.useRef)(),tt=(0,P.useRef)(),nt=(0,P.useRef)();return(0,P.useEffect)(function(){(0,oe.K3)().then(function(g){var m;ge((m=g.data.serverUrl)!==null&&m!==void 0?m:"")}),!J.canSeeEnableCe&&(0,Be.q)().then(function(g){ut(g.data)})},[]),(0,P.useEffect)(function(){var g;!((g=re.current)===null||g===void 0)&&g.reload&&re.current.reload(!1)},[Y]),(0,t.jsxs)(B._z,{header:{extra:[(0,t.jsx)(at.Z,{showTrigger:!0,onFinish:function(){ae(Y+1)},ref:nt},"createByImage")]},children:[(0,t.jsx)(Me.Z,{ref:Ne,onFinish:function(){ae(Y+1)},onUpgradeFinish:function(){ae(Y+1)}}),(0,t.jsx)(Ae.Z,{showFileExplorer:!0,ref:$e}),(0,t.jsx)(j.Z,{ref:ze}),(0,t.jsx)(Ke.Z,{ref:ke,finishAutoHide:!0}),(0,t.jsx)(C.Z,{ref:tt}),(0,t.jsx)(D.Z,{showConsole:!0,ref:Ve}),(0,t.jsx)(T.C,{actionRef:re,tableKey:b.Dc,columns:[{key:"title",title:i.FD.format("listName"),width:300,dataIndex:"siteTitle",sorter:function(m,n){return m.Names[0].localeCompare(n.Names[0])},defaultSortOrder:(0,V.rj)(b.Dc,"title"),sortDirections:V.h5,render:function(m,n,h,O,l){var s=(0,z.fi)(n.Names[0],"/");return(0,t.jsxs)(te.Z,{direction:"vertical",children:[(0,t.jsx)($.Z.Link,{onClick:function(){var r;(r=Ne.current)===null||r===void 0||r.show(n.Id)},children:(0,t.jsx)(R.Z,{content:s})}),!J.canSeeEnableCe&&we&&we.container&&we.container.find(function(a){return a.id==n.Id})&&(0,t.jsx)(Ce.Z,{count:"new"})]})}},{title:i.FD.format("listTag"),hidden:!0,dataIndex:"tag",renderFormItem:function(m,n,h,O){return(0,t.jsx)(xe.Z,{onSelect:function(s){h.submit()},onDeselect:function(){h.submit()},onClear:function(){h.submit()},allowClear:!0,popupMatchSelectWidth:!1,options:qe&&Object.entries(qe.reduce(function(l,s){var a=s.group||"tag";return l[a]||(l[a]=[]),l[a].push(s),l},{})).map(function(l){var s=x()(l,2),a=s[0],r=s[1];return{label:a,title:a,options:r.map(function(u){return{label:u.tag,value:u.tag}})}})})}},{key:"ports",title:i.FD.format("listAccess"),tooltip:i.FD.format("listAccessTip"),width:150,dataIndex:"ports",search:!1,render:function(m,n,h,O){var l,s=[],a=[];return n!=null&&n.Ports&&n.Ports.map(function(r,u){r.PublicPort?s.push(r):a.push(r)}),(0,t.jsx)(S.Z,{publicPort:s,privatePort:a,domain:(l=n.DPExtend)===null||l===void 0?void 0:l.domainList,serverIp:pe})}},{title:i.FD.format("listUsage"),width:200,search:!1,key:"usage",sorter:function(m,n){var h={},O={};if(de){var l,s;h=(l=de.find(function(a){return m.Id.startsWith(a.container)}))!==null&&l!==void 0?l:{},O=(s=de.find(function(a){return n.Id.startsWith(a.container)}))!==null&&s!==void 0?s:{}}return JSON.stringify(h).localeCompare(JSON.stringify(O))},defaultSortOrder:(0,V.rj)(b.Dc,"usage"),sortDirections:V.h5,render:function(m,n,h,O,l){if(!de||de.length<=0)return"";var s={};return de.filter(function(a){n.Id.indexOf(a.container)==0&&(s=a)}),(0,t.jsx)(fe,{value:s})}},{title:i.FD.format("listRunStatus"),key:"status",dataIndex:["container","status"],search:!1,width:130,render:function(m,n,h,O){var l="",s={};if(n.State.includes("(")){var a=n.State.indexOf("(");a>-1&&(l="compose.".concat(n.State.slice(0,a))),s={count:n.State.slice(a+1,n.State.length-1)}}else l="container.".concat(n.State),n.Status.indexOf("(healthy)")>-1?l="container.healthy":n.Status.indexOf("(unhealthy)")>-1&&(l="container.unhealthy");return(0,t.jsx)(A.Z,{statusValue:s,status:l,tip:"".concat(n.State," ").concat(n.Status)})}},{title:i.FD.format("listImageName"),key:"image",width:150,dataIndex:"image",render:function(m,n,h,O){return(0,t.jsx)("span",{style:{wordBreak:"break-word"},children:(0,t.jsx)($.Z.Link,{onClick:function(){var s;(s=tt.current)===null||s===void 0||s.show(n.Image)},children:n.Image.includes("sha256:")?n.Image.substring(7,19):n.Image})})}},{key:"created",search:!1,title:i.FD.format("listCreatedAt"),width:170,dataIndex:["Created"],render:function(m,n,h,O,l){return(0,z.ZM)(n.Created*1e3)},sorter:function(m,n){return new Date(m.Created*1e3).toISOString().localeCompare(new Date(n.Created*1e3).toISOString())},defaultSortOrder:(0,V.rj)(b.Dc,"created"),sortDirections:V.h5},{title:i.FD.format("listManage"),valueType:"option",key:"option",width:130,fixed:"right",hidden:!J.canSeeContainerListManage,render:function(m,n,h,O){return(0,t.jsxs)(te.Z,{split:(0,t.jsx)(Se.Z,{type:"vertical"}),children:[(0,t.jsx)($.Z.Link,{onClick:function(){var s;(s=ze.current)===null||s===void 0||s.show(n.Id)},children:(0,t.jsx)(ne.Z,{title:i.FD.format("listManageLog"),children:(0,t.jsx)(Z.Z,{})})},"log"),(n.State=="running"||n.State=="healthy"||n.State=="unhealthy")&&(0,t.jsx)($.Z.Link,{onClick:function(){var s;(s=$e.current)===null||s===void 0||s.show({url:"/console/container/".concat(n.Id),title:(0,z.fi)(n.Names[0],"/")})},children:(0,t.jsx)(ne.Z,{title:i.FD.format("listManageConsole"),children:(0,t.jsx)(je.Z,{})})},"console"),(n.State=="running"||n.State=="healthy"||n.State=="unhealthy")&&(0,t.jsx)($.Z.Link,{onClick:function(){var s,a=n.Names.find(function(r){if(r.indexOf("/")===0)return r});(s=Ve.current)===null||s===void 0||s.showContainer(a!=null?a:n.Names[0])},children:(0,t.jsx)(ne.Z,{title:i.FD.format("listManageFileExplorer"),children:(0,t.jsx)(De.Z,{})})},"file")]})}}],rowKey:"Id",request:function(){var g=f()(c()().mark(function m(n,h,O){var l,s,a,r,u,d;return c()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,Q.IE)({siteTitle:n.title,image:n.image});case 2:return s=E.sent,a="",r=[],E.next=7,(0,p.e1)({showCompose:!0,showSwarm:!0});case 7:if(u=E.sent,ct(u.data.list),d=[],d=s.data.list.map(function(o){var v=s.data.siteList.find(function(_){return _.containerInfo&&_.containerInfo.Id==o.Id&&_.siteTitle!=""});if(v&&o.Names.unshift(v.siteTitle),o.Labels&&o.Labels[G.fu]&&o.Names.unshift(o.Labels[G.fu]),o.DPExtend={domainList:s.data.domainList.filter(function(_,w){return o.Names.includes(_.containerId)}).map(function(_){return _.setting.enableSSL?"https://"+_.serverName:"http://"+_.serverName}),tag:[]},o.Labels&&o.Labels["com.docker.compose.project"]){var U;(U=o.DPExtend.tag)===null||U===void 0||U.push((0,z.fi)(o.Labels["com.docker.compose.project"],"dpanel-c-"))}if(o.Labels&&o.Labels["com.docker.swarm.service.name"]){var Pe;(Pe=o.DPExtend.tag)===null||Pe===void 0||Pe.push(o.Labels["com.docker.swarm.service.name"])}return u.data.list.forEach(function(_){_.item&&_.item.forEach(function(w){if(o.Names.includes(w.name)&&o.DPExtend){var se;(se=o.DPExtend.tag)===null||se===void 0||se.push(_.tag)}})}),o}),!n.tag){E.next=15;break}if(d.forEach(function(o){var v;!((v=o.DPExtend)===null||v===void 0)&&v.tag&&o.DPExtend.tag.forEach(function(U){n.tag.includes(U)&&r.push.apply(r,H()(o.Names))})}),r.length!=0){E.next=15;break}return E.abrupt("return",{data:[],success:!0,total:0});case 15:return a!=""?d=d.filter(function(o){var v=!1;return o.Names.forEach(function(U){U.startsWith("/"+a)&&(v=!0)}),v}):r&&r.length>0&&(d=d.filter(function(o){var v=!1;return o.Names.forEach(function(U){r.includes(U)&&(v=!0)}),v})),(0,oe.Cz)({follow:!1}).then(function(o){it(o.data.list)}),E.abrupt("return",{data:(l=d)!==null&&l!==void 0?l:[],success:!0,total:s.data.list.length});case 18:case"end":return E.stop()}},m)}));return function(m,n,h){return g.apply(this,arguments)}}(),rowSelection:J.canSeeContainerListManage&&{defaultSelectedRowKeys:[],alwaysShowAlert:!0},quickToolbarRender:function(m){var n=m.selectedRows,h=m.loading,O=m.finish,l=m.isMultiple;return[(0,t.jsx)(W.Z,{type:Oe.W6.CONTAINER,selected:n!=null?n:[],onSuccess:function(){return ae(Y+1),!0}},"dataPermission"),(0,t.jsx)(y.u,{showProTips:!0,access:["canSeeEnableCe","canSeeContainerListManageOp"],children:function(a){var r=a.canSeeEnableCe,u=a.canSeeContainerListManageOp;return u&&(0,t.jsx)(me.Z,{buttonProps:{disabled:r,type:"primary",icon:(0,t.jsx)(Te.Z,{})},action:f()(c()().mark(function d(){var I,E,o,v,U;return c()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(n){_.next=2;break}return _.abrupt("return",!1);case 2:h(),I=[],E=F()(n);try{for(E.s();!(o=E.n()).done;)v=o.value,v&&!I.includes(v.Image)&&I.push(v.Image)}catch(w){E.e(w)}finally{E.f()}if(!I){_.next=9;break}return _.next=9,(U=ke.current)===null||U===void 0?void 0:U.pull(I).finally(function(){var w;(w=ke.current)===null||w===void 0||w.finish()});case 9:return _.abrupt("return",Promise.all(n.map(function(w){var se,He,Qe;return(0,Q.RF)({md5:(se=w.Id)!==null&&se!==void 0?se:"",imageTag:"",enableBak:(He=(Qe=et.current)===null||Qe===void 0?void 0:Qe.getFieldValue("enableBak"))!==null&&He!==void 0?He:!1}).finally(function(){O(!0)})})));case 10:case"end":return _.stop()}},d)})),onSuccess:function(){return ae(Y+1),!0},confirmProps:{description:(0,t.jsxs)(te.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,t.jsx)($.Z.Text,{children:L.format("upgradeConfirm")}),(0,t.jsx)(Ee.A,{formRef:et,submitter:!1,layout:"inline",children:(0,t.jsx)(Ie.Z,{name:"enableBak",valuePropName:"checked",children:(0,t.jsx)(le.Z,{children:L.format("upgradeConfirmEnableBak")})})})]})},children:i.FD.format("listManageUpgradeBatch")})}},"batchUpgrade"),(0,t.jsx)(y.u,{access:"canSeeContainerListManageDelete",children:(0,t.jsx)(me.Z,{action:function(){return(0,Q.KK)()},buttonProps:{icon:(0,t.jsx)(Le.Z,{})},onSuccess:function(){return ae(Y+1),!0},onError:function(){var a,r;return!((a=re.current)===null||a===void 0)&&a.reloadAndRest&&((r=re.current)===null||r===void 0||r.reloadAndRest()),!0},confirmProps:{description:ve.format("listManagePruneTip")},children:i.FD.format("listManagePrune")})},"clear"),(0,t.jsx)(y.u,{access:"canSeeContainerListManageDelete",children:(0,t.jsx)(me.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,t.jsx)(ye.Z,{})},action:f()(c()().mark(function s(){return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return h(),r.abrupt("return",Promise.all(n.map(function(){var u=f()(c()().mark(function d(I){return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,G.Ct)({md5:I.Id,deleteImage:!1,deleteVolume:!1});case 2:return o.t0=o.sent,o.next=5,(0,p.rn)({name:I.Names[0]});case 5:return o.t1=o.sent,o.abrupt("return",[o.t0,o.t1]);case 7:case"end":return o.stop()}},d)}));return function(d){return u.apply(this,arguments)}}())).finally(function(){O(!0)}));case 2:case"end":return r.stop()}},s)})),onSuccess:function(){return ae(Y+1),!0},onError:function(){var a,r;return!((a=re.current)===null||a===void 0)&&a.reloadAndRest&&((r=re.current)===null||r===void 0||r.reloadAndRest()),!0},confirmProps:{showCommonConfirm:!0},children:i.FD.format("listManageDeleteBatch")})},"batchDelete")]},contextMenu:function(m){var n=m.loading,h=m.finish,O=m.isMultiple,l=m.selectedRow,s=m.selectedRows;return{items:[{type:"group",label:i.FD.format("listManageManage"),key:"manage",children:[{access:"canSeeContainerList",label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(Ze.Z,{})},action:f()(c()().mark(function a(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n(),u.abrupt("return",Promise.all(s.map(function(d){return(0,Q.IW)({md5:d.Id,operate:"restart"})})).finally(function(){h(!0)}));case 2:case"end":return u.stop()}},a)})),children:i.FD.format("listManageRestart")}),key:"restart"},{label:(0,t.jsx)(T.C.ContextMenuItem,{action:f()(c()().mark(function a(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n(),u.abrupt("return",Promise.all(s.map(function(d){return(0,Q.IW)({md5:d.Id,operate:"stop"})})).finally(function(){h(!0)}));case 2:case"end":return u.stop()}},a)})),buttonProps:{icon:(0,t.jsx)(Ue.Z,{})},children:i.FD.format("listManageStop")}),key:"stop"},{label:(0,t.jsx)(T.C.ContextMenuItem,{action:f()(c()().mark(function a(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n(),u.abrupt("return",Promise.all(s.map(function(d){return(0,Q.IW)({md5:d.Id,operate:"pause"})})).finally(function(){h(!0)}));case 2:case"end":return u.stop()}},a)})),buttonProps:{icon:(0,t.jsx)(ie.Z,{})},children:i.FD.format("listManagePause")}),key:"pause"},{label:(0,t.jsx)(T.C.ContextMenuItem,{action:f()(c()().mark(function a(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n(),u.abrupt("return",Promise.all(s.map(function(d){return(0,Q.IW)({md5:d.Id,operate:"unpause"})})).finally(function(){h(!0)}));case 2:case"end":return u.stop()}},a)})),buttonProps:{icon:(0,t.jsx)(ie.Z,{})},children:i.FD.format("listManageUnpause")}),key:"unpause"}]},{type:"group",label:i.FD.format("listManage"),key:"operator",children:[{label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(M.Z,{}),disabled:O()},action:f()(c()().mark(function a(){var r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:h(!0),l&&((r=Ne.current)===null||r===void 0||r.show(l.Id));case 2:case"end":return d.stop()}},a)})),children:i.FD.format("listManageView")}),key:"view"},{label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(Fe.Z,{}),disabled:O()},action:f()(c()().mark(function a(){var r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:h(!0),l&&((r=nt.current)===null||r===void 0||r.show(l.Id));case 2:case"end":return d.stop()}},a)})),children:i.FD.format("listManageEdit")}),key:"edit"},{label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(Z.Z,{}),disabled:O()},action:f()(c()().mark(function a(){var r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:l&&((r=ze.current)===null||r===void 0||r.show(l.Id)),h(!0);case 2:case"end":return d.stop()}},a)})),children:i.FD.format("listManageLog")}),key:"log"},{label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(je.Z,{}),disabled:O()||l&&!["running","healthy","unhealthy"].includes(l.State)},action:f()(c()().mark(function a(){var r;return c()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:l&&((r=$e.current)===null||r===void 0||r.show({url:"/console/container/".concat(l.Id),title:(0,z.fi)(l.Names[0],"/")})),h(!0);case 2:case"end":return d.stop()}},a)})),children:i.FD.format("listManageConsole")}),key:"console"},{label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(De.Z,{}),disabled:O()||l&&!["running","healthy","unhealthy"].includes(l.State)},action:f()(c()().mark(function a(){var r,u;return c()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(l){I.next=2;break}return I.abrupt("return");case 2:u=l.Names.find(function(E){if(E.indexOf("/")===0)return E}),(r=Ve.current)===null||r===void 0||r.showContainer(u!=null?u:l.Names[0]),h(!0);case 5:case"end":return I.stop()}},a)})),children:i.FD.format("listManageFilePath")}),key:"file"}]},{key:"delete",label:(0,t.jsx)(T.C.ContextMenuItem,{buttonProps:{icon:(0,t.jsx)(ye.Z,{})},type:"danger",confirmProps:{showCommonConfirm:!0},action:f()(c()().mark(function a(){return c()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n(),u.abrupt("return",Promise.all(s.map(function(){var d=f()(c()().mark(function I(E){return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,G.Ct)({md5:E.Id,deleteImage:!1,deleteVolume:!1});case 2:return v.t0=v.sent,v.next=5,(0,p.rn)({name:E.Names[0]});case 5:return v.t1=v.sent,v.abrupt("return",[v.t0,v.t1]);case 7:case"end":return v.stop()}},I)}));return function(I){return d.apply(this,arguments)}}())).finally(function(){h(!0)}));case 2:case"end":return u.stop()}},a)})),children:i.FD.format("listManageDelete")},"deleteBatch")}]}}},"app-list")]})}},20578:function(Re,k,e){e.d(k,{q:function(){return H}});var X=e(15009),F=e.n(X),q=e(99289),c=e.n(q),ee=e(82346);function H(){return N.apply(this,arguments)}function N(){return N=c()(F()().mark(function f(){return F()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,ee.request)("/dpanel/api/pro/container-upgrade/get-all-list",{method:"POST"});case 2:return x.abrupt("return",x.sent);case 3:case"end":return x.stop()}},f)})),N.apply(this,arguments)}}}]);
