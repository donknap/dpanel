"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4316],{52645:function(ae,F,t){t.d(F,{Z:function(){return p}});var L=t(87462),D=t(67294),z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},v=z,T=t(84089),k=function(R,W){return D.createElement(T.Z,(0,L.Z)({},R,{ref:W,icon:v}))},I=D.forwardRef(k),p=I},14668:function(ae,F,t){t.r(F),t.d(F,{default:function(){return et}});var L=t(64599),D=t.n(L),z=t(15009),v=t.n(z),T=t(19632),k=t.n(T),I=t(99289),p=t.n(I),B=t(5574),R=t.n(B),W=t(74453),we=t(34041),Ce=t(74330),je=t(97269),Se=t(62370),Q=t(23345),K=t(25593),xe=t(40411),De=t(84567),Ie=t(63713),Oe=t(50888),Pe=t(30159),Fe=t(33160),Me=t(87784),be=t(99611),Ze=t(86548),Ee=t(1883),Le=t(89035),ze=t(95591),Te=t(16596),ke=t(52645),Ne=t(10781),M=t(13822),g=t(67294),G=t(62597),ne=t(87662),re=t(83062),se=t(16165),b=t(5251),l=t(85893),Ue=function(){return(0,l.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18403",children:(0,l.jsx)("path",{d:"M224 192v64H96v576h128v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h64v64h64v-64h128V256h-128V192h-64v64h-64V192h-64v64h-64V192h-64v64h-64V192h-64v64H288V192z m-64 128h704v448H160z m96 64c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 512c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m512 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32zM256 640c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z m128 0c-17.6 0-32 14.4-32 32s14.4 32 32 32 32-14.4 32-32-14.4-32-32-32z","p-id":"18404"})})},$e=function(){return(0,l.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18546",children:(0,l.jsx)("path",{d:"M64 224v576h416v-32c0-17.76 14.24-32 32-32 17.76 0 32 14.24 32 32v32h416V224z m64 64h768v288H128z m64 64v160h192v-160z m224 0v160h192v-160z m224 0v160h192v-160zM256 416h64v32H256z m224 0h64v32h-64z m224 0h64v32h-64zM128 640h768v96h-300.992c-14.144-35.52-42.752-64-83.008-64-40.256 0-68.864 28.48-83.008 64H128z","p-id":"18547"})})};function Ae(C){var N,O,U,E,$,A;return(0,l.jsx)(l.Fragment,{children:C.value&&C.value.memory&&C.value.memory.out>0?(0,l.jsxs)(Q.Z,{children:[(0,l.jsxs)(re.Z,{title:"Cpu: ".concat((N=C.value)===null||N===void 0?void 0:N.cpu.toFixed(2),"%"),children:[(0,l.jsx)(se.Z,{component:Ue,style:{width:15,lineHeight:20}})," ","".concat((O=C.value)===null||O===void 0?void 0:O.cpu.toFixed(2),"%")]}),(0,l.jsxs)(re.Z,{title:"Memory: ".concat((0,b.FI)((U=C.value)===null||U===void 0?void 0:U.memory.in)," / ").concat((0,b.FI)((E=C.value)===null||E===void 0?void 0:E.memory.out)),children:[(0,l.jsx)(se.Z,{component:$e,style:{width:15,lineHeight:20}})," ","".concat(((($=C.value)===null||$===void 0?void 0:$.memory.in)/((A=C.value)===null||A===void 0?void 0:A.memory.out)*100).toFixed(2),"%")]})]}):"-"})}var Z=t(67255),He=t(89638),Ve=t(41477),Be=t(99922),We=t(83403),Qe=t(20578),Ke=t(99861),Ge=t(10040),ie=t(29453),Je=t(8287),Xe=t(69033),Ye=t(78451),h=t(36146),H=t(55375),qe=t(55681),_e=t(84941);function et(){var C=new h.Uo("components.appDetail"),N=new h.Uo("app"),O=(0,Ie.useAccess)(),U=(0,g.useState)(""),E=R()(U,2),$=E[0],A=E[1],tt=(0,g.useState)(1),le=R()(tt,2),V=le[0],J=le[1],at=(0,g.useState)([]),oe=R()(at,2),x=oe[0],X=oe[1],nt=(0,g.useState)(),ue=R()(nt,2),Y=ue[0],rt=ue[1],st=(0,g.useState)([]),ce=R()(st,2),de=ce[0],it=ce[1],q=(0,g.useRef)(),_=(0,g.useRef)(),fe=(0,g.useRef)(),ve=(0,g.useRef)(),he=(0,g.useRef)(),me=(0,g.useRef)(),ee=(0,g.useRef)(),pe=(0,g.useRef)(),ge=(0,g.useRef)();return(0,g.useEffect)(function(){(0,ne.K3)().then(function(u){var e;A((e=u.data.serverUrl)!==null&&e!==void 0?e:"")}),!O.canSeeEnableCe&&(0,Qe.q)().then(function(u){rt(u.data)})},[]),(0,g.useEffect)(function(){var u;!((u=q.current)===null||u===void 0)&&u.reload&&q.current.reload(!1),X([])},[V]),(0,l.jsxs)(W._z,{header:{extra:[(0,l.jsx)(_e.Z,{showTrigger:!0,onFinish:function(){J(V+1)},ref:ge},"createByImage")]},children:[(0,l.jsx)(Ve.Z,{ref:_,onFinish:function(){J(V+1)},onUpgradeFinish:function(){J(V+1)}}),(0,l.jsx)(Be.Z,{showFileExplorer:!0,ref:fe}),(0,l.jsx)(Je.Z,{ref:ve}),(0,l.jsx)(Ke.Z,{ref:ee,finishAutoHide:!0}),(0,l.jsx)(Ge.Z,{ref:pe}),(0,l.jsx)(Xe.Z,{showConsole:!0,ref:he}),(0,l.jsx)(qe.Co,{actionRef:q,tableKey:H.Dc,columns:[{key:"title",title:h.FD.format("listName"),width:300,dataIndex:"siteTitle",sorter:function(e,r){return e.Names[0].localeCompare(r.Names[0])},defaultSortOrder:(0,Z.rj)(H.Dc,"title"),sortDirections:Z.h5,render:function(e,r,i,o,a){var s=(0,b.fi)(r.Names[0],"/");return(0,l.jsxs)(Q.Z,{direction:"vertical",children:[(0,l.jsx)(K.Z.Link,{onClick:function(){var d;(d=_.current)===null||d===void 0||d.show(r.Id)},children:(0,l.jsx)(Ye.Z,{content:s})}),!O.canSeeEnableCe&&Y&&Y.container&&Y.container.find(function(n){return n.id==r.Id})&&(0,l.jsx)(xe.Z,{count:"new"})]})}},{title:h.FD.format("listTag"),hidden:!0,dataIndex:"tag",renderFormItem:function(e,r,i,o){return(0,l.jsx)(we.Z,{onSelect:function(s){i.submit()},onDeselect:function(){i.submit()},onClear:function(){i.submit()},allowClear:!0,popupMatchSelectWidth:!1,options:de&&Object.entries(de.reduce(function(a,s){var n=s.group||"tag";return a[n]||(a[n]=[]),a[n].push(s),a},{})).map(function(a){var s=R()(a,2),n=s[0],d=s[1];return{label:n,title:n,options:d.map(function(m){return{label:m.tag,value:m.tag}})}})})}},{key:"ports",title:h.FD.format("listAccess"),tooltip:h.FD.format("listAccessTip"),width:150,dataIndex:"ports",search:!1,render:function(e,r,i,o){var a,s=[],n=[];return r!=null&&r.Ports&&r.Ports.map(function(d,m){d.PublicPort?s.push(d):n.push(d)}),(0,l.jsx)(He.Z,{publicPort:s,privatePort:n,domain:(a=r.DPExtend)===null||a===void 0?void 0:a.domainList,serverIp:$})}},{title:(0,l.jsx)(Ce.Z,{spinning:!x||x.length==0,indicator:(0,l.jsx)(Oe.Z,{spin:!0}),size:"small",children:h.FD.format("listUsage")}),width:150,search:!1,key:"usage",sorter:function(e,r){var i={},o={};if(x){var a,s;i=(a=x.find(function(n){return e.Id.startsWith(n.container)}))!==null&&a!==void 0?a:{},o=(s=x.find(function(n){return r.Id.startsWith(n.container)}))!==null&&s!==void 0?s:{}}return JSON.stringify(i).localeCompare(JSON.stringify(o))},defaultSortOrder:(0,Z.rj)(H.Dc,"usage"),sortDirections:Z.h5,render:function(e,r,i,o,a){var s={};return x&&x.length>0&&x.filter(function(n){r.Id.indexOf(n.container)==0&&(s=n)}),(0,l.jsx)(Ae,{value:s})}},{title:h.FD.format("listRunStatus"),key:"status",dataIndex:["container","status"],search:!1,width:130,render:function(e,r,i,o){var a="",s={};if(r.State.includes("(")){var n=r.State.indexOf("(");n>-1&&(a="compose.".concat(r.State.slice(0,n))),s={count:r.State.slice(n+1,r.State.length-1)}}else a="container.".concat(r.State),r.Status.indexOf("(healthy)")>-1?a="container.healthy":r.Status.indexOf("(unhealthy)")>-1&&(a="container.unhealthy");return(0,l.jsx)(Ne.Z,{statusValue:s,status:a,tip:"".concat(r.State," ").concat(r.Status)})}},{title:h.FD.format("listImageName"),key:"image",width:150,dataIndex:"image",render:function(e,r,i,o){return(0,l.jsx)("span",{style:{wordBreak:"break-word"},children:(0,l.jsx)(K.Z.Link,{onClick:function(){var s;(s=pe.current)===null||s===void 0||s.show(r.Image)},children:r.Image.includes("sha256:")?r.Image.substring(7,19):r.Image})})}},{key:"created",search:!1,title:h.FD.format("listCreatedAt"),width:170,dataIndex:["Created"],render:function(e,r,i,o,a){return(0,b.ZM)(r.Created*1e3)},sorter:function(e,r){return new Date(e.Created*1e3).toISOString().localeCompare(new Date(r.Created*1e3).toISOString())},defaultSortOrder:(0,Z.rj)(H.Dc,"created"),sortDirections:Z.h5}],rowKey:"Id",request:function(){var u=p()(v()().mark(function e(r,i,o){var a,s,n,d,m,w;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return X([]),f.next=3,(0,M.IE)({siteTitle:r.title,image:r.image});case 3:return s=f.sent,n="",d=[],f.next=8,(0,ie.e1)({showCompose:!0,showSwarm:!0});case 8:if(m=f.sent,it(m.data.list),w=[],w=s.data.list.map(function(c){var y=s.data.siteList.find(function(S){return S.containerInfo&&S.containerInfo.Id==c.Id&&S.siteTitle!=""});if(y&&c.Names.unshift(y.siteTitle),c.Labels&&c.Labels[G.fu]&&c.Names.unshift(c.Labels[G.fu]),c.DPExtend={domainList:s.data.domainList.filter(function(S,Re){return c.Names.includes(S.containerId)}).map(function(S){return S.setting.enableSSL?"https://"+S.serverName:"http://"+S.serverName}),tag:[]},c.Labels&&c.Labels["com.docker.compose.project"]){var j;(j=c.DPExtend.tag)===null||j===void 0||j.push((0,b.fi)(c.Labels["com.docker.compose.project"],"dpanel-c-"))}if(c.Labels&&c.Labels["com.docker.swarm.service.name"]){var P;(P=c.DPExtend.tag)===null||P===void 0||P.push(c.Labels["com.docker.swarm.service.name"])}return m.data.list.forEach(function(S){S.item&&S.item.forEach(function(Re){if(c.Names.includes(Re.name)&&c.DPExtend){var te;(te=c.DPExtend.tag)===null||te===void 0||te.push(S.tag)}})}),c}),!r.tag){f.next=16;break}if(w.forEach(function(c){var y;!((y=c.DPExtend)===null||y===void 0)&&y.tag&&c.DPExtend.tag.forEach(function(j){r.tag.includes(j)&&d.push.apply(d,k()(c.Names))})}),d.length!=0){f.next=16;break}return f.abrupt("return",{data:[],success:!0,total:0});case 16:return n!=""?w=w.filter(function(c){var y=!1;return c.Names.forEach(function(j){j.startsWith("/"+n)&&(y=!0)}),y}):d&&d.length>0&&(w=w.filter(function(c){var y=!1;return c.Names.forEach(function(j){d.includes(j)&&(y=!0)}),y})),(0,ne.Cz)({follow:!1}).then(function(c){X(c.data.list)}),f.abrupt("return",{data:(a=w)!==null&&a!==void 0?a:[],success:!0,total:s.data.list.length});case 19:case"end":return f.stop()}},e)}));return function(e,r,i){return u.apply(this,arguments)}}(),rowSelection:O.canSeeContainerListManage&&{defaultSelectedRowKeys:[],alwaysShowAlert:!0},actions:[{key:"pause",label:"".concat(h.FD.format("listManagePause")," & ").concat(h.FD.format("listManageUnpause")),showInContext:"operator",icon:(0,l.jsx)(Pe.Z,{}),isMultiple:!0,action:function(e){return p()(v()().mark(function r(){var i,o,a,s;return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=e.loading,o=e.finish,a=e.selectedRows,i(),s=a.find(function(m){return m.State=="paused"}),d.abrupt("return",Promise.all(a.map(function(m){return(0,M.IW)({md5:m.Id,operate:s?"unpause":"pause"})})).finally(function(){o(!0)}));case 4:case"end":return d.stop()}},r)}))()}},{key:"restart",showInContext:"operator",label:"".concat(h.FD.format("listManageStart")," & ").concat(h.FD.format("listManageRestart")),icon:(0,l.jsx)(Fe.Z,{}),isMultiple:!0,action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.loading,o=e.selectedRows,a=e.finish,i(),n.abrupt("return",Promise.all(o.map(function(d){return(0,M.IW)({md5:d.Id,operate:"restart"})})).finally(function(){a(!0)}));case 3:case"end":return n.stop()}},r)}))()}},{key:"stop",label:h.FD.format("listManageStop"),showInContext:"operator",icon:(0,l.jsx)(Me.Z,{}),isMultiple:!0,action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.loading,o=e.finish,a=e.selectedRows,i(),n.abrupt("return",Promise.all(a.map(function(d){return(0,M.IW)({md5:d.Id,operate:"stop"})})).finally(function(){o(!0)}));case 3:case"end":return n.stop()}},r)}))()}},{key:"view",label:h.FD.format("listManageView"),showInContext:"manage",disable:function(e){return e.isMultiple()},buttonProps:{icon:(0,l.jsx)(be.Z,{})},action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=e.finish,a=e.selectedRow,o(!0),a&&((i=_.current)===null||i===void 0||i.show(a.Id));case 3:case"end":return n.stop()}},r)}))()}},{key:"edit",label:h.FD.format("listManageEdit"),showInContext:"manage",disable:function(e){return e.isMultiple()},buttonProps:{icon:(0,l.jsx)(Ze.Z,{})},action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=e.finish,a=e.selectedRow,o(!0),a&&((i=ge.current)===null||i===void 0||i.show(a.Id));case 3:case"end":return n.stop()}},r)}))()},addDivider:!0},{key:"log",label:h.FD.format("listManageLog"),showInContext:"manage",showInOperator:!0,buttonProps:{icon:(0,l.jsx)(Ee.Z,{})},disable:function(e){return e.isMultiple()},action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=e.finish,a=e.selectedRow,o(!0),a&&((i=ve.current)===null||i===void 0||i.show(a.Id));case 3:case"end":return n.stop()}},r)}))()}},{key:"console",label:h.FD.format("listManageConsole"),showInContext:"manage",showInOperator:!0,disable:function(e){return e.isMultiple()||e.selectedRow&&!["running","healthy","unhealthy"].includes(e.selectedRow.State)},buttonProps:{icon:(0,l.jsx)(Le.Z,{})},action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=e.finish,a=e.selectedRow,o(!0),a&&((i=fe.current)===null||i===void 0||i.show({url:"/console/container/".concat(a.Id),title:(0,b.fi)(a.Names[0],"/")}));case 3:case"end":return n.stop()}},r)}))()}},{key:"file",label:h.FD.format("listManageFilePath"),showInContext:"manage",showInOperator:!0,disable:function(e){return e.isMultiple()||e.selectedRow&&!["running","healthy","unhealthy"].includes(e.selectedRow.State)},buttonProps:{icon:(0,l.jsx)(ze.Z,{})},action:function(e){return p()(v()().mark(function r(){var i,o,a,s;return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(o=e.finish,a=e.selectedRow,a){d.next=3;break}return d.abrupt("return");case 3:s=a.Names.find(function(m){if(m.indexOf("/")===0)return m}),(i=he.current)===null||i===void 0||i.showContainer(s!=null?s:a.Names[0]),o(!0);case 6:case"end":return d.stop()}},r)}))()}},{key:"dataPermission",label:We.W6.CONTAINER},{key:"upgrade",permission:{access:["canSeeEnablePe","canSeeContainerListManageOp"]},label:h.FD.format("listManageUpgradeBatch"),showInQuickToolbar:!0,confirmProps:{description:(0,l.jsxs)(Q.Z,{style:{width:280,paddingRight:"10px"},direction:"vertical",children:[(0,l.jsx)(K.Z.Text,{children:C.format("upgradeConfirm")}),(0,l.jsx)(je.A,{formRef:me,submitter:!1,layout:"inline",children:(0,l.jsx)(Se.Z,{name:"enableBak",valuePropName:"checked",children:(0,l.jsx)(De.Z,{children:C.format("upgradeConfirmEnableBak")})})})]})},buttonProps:{type:"primary",icon:(0,l.jsx)(Te.Z,{})},action:function(e){return p()(v()().mark(function r(){var i,o,a,s,n,d,m,w;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(i=e.selectedRows,o=e.finish,a=e.loading,i){f.next=3;break}return f.abrupt("return",!1);case 3:a(),s=[],n=D()(i);try{for(n.s();!(d=n.n()).done;)m=d.value,m&&!s.includes(m.Image)&&s.push(m.Image)}catch(c){n.e(c)}finally{n.f()}if(!s){f.next=10;break}return f.next=10,(w=ee.current)===null||w===void 0?void 0:w.pull(s).finally(function(){var c;(c=ee.current)===null||c===void 0||c.finish()});case 10:return f.abrupt("return",Promise.all(i.map(function(c){var y,j,P;return(0,M.RF)({md5:(y=c.Id)!==null&&y!==void 0?y:"",imageTag:"",enableBak:(j=(P=me.current)===null||P===void 0?void 0:P.getFieldValue("enableBak"))!==null&&j!==void 0?j:!1})})).finally(function(){o(!0)}));case 11:case"end":return f.stop()}},r)}))()}},{key:"clear",label:h.FD.format("listManagePrune"),showInQuickToolbar:!0,buttonProps:{icon:(0,l.jsx)(ke.Z,{})},confirmProps:{description:N.format("listManagePruneTip")},action:function(e){return p()(v()().mark(function r(){var i,o;return v()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=e.loading,o=e.finish,i(),s.abrupt("return",(0,M.KK)().finally(function(){o(!0)}));case 3:case"end":return s.stop()}},r)}))()}},{key:"delete",showInContext:!0,showInQuickToolbar:!0,action:function(e){return p()(v()().mark(function r(){var i,o,a;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.loading,o=e.selectedRows,a=e.finish,i(),n.abrupt("return",Promise.all(o.map(function(){var d=p()(v()().mark(function m(w){return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,G.Ct)({md5:w.Id,deleteImage:!1,deleteVolume:!1});case 2:return f.t0=f.sent,f.next=5,(0,ie.rn)({name:w.Names[0]});case 5:return f.t1=f.sent,f.abrupt("return",[f.t0,f.t1]);case 7:case"end":return f.stop()}},m)}));return function(m){return d.apply(this,arguments)}}())).finally(function(){a(!0)}));case 3:case"end":return n.stop()}},r)}))()}}]},"app-list")]})}},20578:function(ae,F,t){t.d(F,{q:function(){return k}});var L=t(15009),D=t.n(L),z=t(99289),v=t.n(z),T=t(63713);function k(){return I.apply(this,arguments)}function I(){return I=v()(D()().mark(function p(){return D()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,T.request)("/dpanel/api/pro/container-upgrade/get-all-list",{method:"POST"});case 2:return R.abrupt("return",R.sent);case 3:case"end":return R.stop()}},p)})),I.apply(this,arguments)}}}]);
