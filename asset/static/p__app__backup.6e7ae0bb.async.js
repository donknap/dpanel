"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[550],{94359:function(k,T,e){e.d(T,{Z:function(){return G}});var w=e(5574),r=e.n(w),B=e(3089),c=e(98165),x=e(18429),s=e(8751),Z=e(66212),R=e(14313),U=e(30159),p=e(87740),b=e(50888),j=e(66309),S=e(83062),$=e(36146),o=e(85893);function G(i){var n,C,W=new $.Uo("components.containerStatus"),a=i.status.split("."),K=r()(a,2),re=K[0],h=K[1],E="";E=W.format(i.status,(n=i.statusValue)!==null&&n!==void 0?n:{});var v=(0,o.jsx)(o.Fragment,{});return h=="0"&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(B.Z,{}),color:"default",children:E})),h=="10"&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(c.Z,{spin:!0}),color:"processing",children:E})),h=="20"&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(x.Z,{}),color:"error",children:E})),h=="30"&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(s.Z,{}),color:"success",children:E})),h=="new"&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(Z.Z,{}),children:E})),(h=="running"||h=="healthy"||h=="active"||h=="ready")&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(R.Z,{}),color:"success",children:E})),(h=="paused"||h=="pause"||h=="rollback_paused")&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(U.Z,{}),color:"warning",children:E})),(h=="waiting"||h=="starting"||h=="accepted")&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(p.Z,{}),children:E})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(h)&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(b.Z,{}),color:"processing",children:E})),(h=="error"||h=="down"||h=="failed")&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(x.Z,{}),color:"error",children:E})),["complete","completed","rollback_completed"].includes(h)&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(s.Z,{}),color:"success",children:E})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(h)&&(v=(0,o.jsx)(j.Z,{icon:(0,o.jsx)(x.Z,{}),color:"warning",children:E})),(0,o.jsx)(S.Z,{placement:"top",title:(C=i.tip)!==null&&C!==void 0?C:"",children:v})}},76428:function(k,T,e){e.d(T,{Z:function(){return c}});var w=e(25593),r=e(67294),B=e(85893);function c(x){return(0,B.jsx)(w.Z.Text,{copyable:!0,children:x.title})}},51100:function(k,T,e){e.d(T,{Z:function(){return x}});var w=e(4813),r=e(91604),B=e(1677),c=e(85893);function x(s){return s.showDragger?(0,c.jsx)(r.Z,{max:s.max?s.max:1,title:s.title,label:s.label,required:s.required,rules:[{required:s.required}],fieldProps:{multiple:!!(s.max&&s.max>1),name:"file",accept:s.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(R){return new Promise(function(U){var p;(0,w._)({path:(p=R.response.data.path)!==null&&p!==void 0?p:""}).then(function(b){U(!0)})})},onChange:function(R){R.file.status=="done"&&s.onFinish&&s.onFinish(R.fileList)}},name:s.name}):(0,c.jsx)(B.Z,{max:s.max?s.max:1,title:s.title,label:s.label,required:s.required,rules:[{required:s.required}],fieldProps:{multiple:!!(s.max&&s.max>1),name:"file",accept:s.accept,action:"/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(R){return new Promise(function(U){var p;(0,w._)({path:(p=R.response.data.path)!==null&&p!==void 0?p:""}).then(function(b){U(!0)})})},onChange:function(R){R.file.status=="done"&&s.onFinish&&s.onFinish(R.fileList)}},name:s.name})}},3616:function(k,T,e){e.d(T,{Ed:function(){return c},FK:function(){return r},R_:function(){return w},ob:function(){return B}});var w=window.innerWidth<=1024?"90vw":"65vw",r="90vw",B="60vw",c="50vh"},65913:function(k,T,e){var w=e(5574),r=e.n(w),B=e(74330),c=e(67294),x=e(85893),s=(0,c.forwardRef)(function(Z,R){(0,c.useImperativeHandle)(R,function(){return{show:function(){j(!0)},destroy:function(){j(!1)}}});var U=(0,c.useState)(!1),p=r()(U,2),b=p[0],j=p[1];return(0,x.jsx)(B.Z,{spinning:b,size:"default",children:Z.children})});T.Z=s},6091:function(k,T,e){e.r(T),e.d(T,{default:function(){return je}});var w=e(15009),r=e.n(w),B=e(99289),c=e.n(B),x=e(37476),s=e(86615),Z=e(97462),R=e(5966),U=e(83622),p=e(67294),b=e(1699),j=e(82346);function S(y){return $.apply(this,arguments)}function $(){return $=c()(r()().mark(function y(F){return r()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,j.request)("/api/pro/container-backup/import",{data:F,method:"POST"});case 2:return O.abrupt("return",O.sent);case 3:case"end":return O.stop()}},y)})),$.apply(this,arguments)}var o=e(3616),G=e(51100),i=e(36146),n=e(85893),C=(0,p.forwardRef)(function(y,F){(0,p.useImperativeHandle)(F,function(){return{}});var N=(0,p.useRef)(),O=new i.Uo("components.appDetail");return(0,n.jsx)(b.u,{showProTips:!0,access:["canSeeEnableCe","canSeeEnableDockerEnvLocal"],children:function(I){var m=I.canSeeEnableCe,l=I.canSeeEnableDockerEnvLocal;return l&&(0,n.jsxs)(x.Y,{modalProps:{width:o.ob},onFinish:function(){var g=c()(r()().mark(function _(d){var u,t,M;return r()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return u=d.tarFilePath,d.tarFileUpload&&d.tarFileUpload.length>0&&(u=(t=d.tarFileUpload[0].response.data.path)!==null&&t!==void 0?t:""),P.next=4,S({type:d.type,tarFilePath:u});case 4:return M=P.sent,y.onFinish&&y.onFinish(),P.abrupt("return",!0);case 7:case"end":return P.stop()}},_)}));return function(_){return g.apply(this,arguments)}}(),title:O.format("backupImportTitle"),formRef:N,trigger:(0,n.jsx)(U.ZP,{disabled:m,type:"primary",children:O.format("backupImportTitle")}),onOpenChange:function(){var _;(_=N.current)===null||_===void 0||_.resetFields()},children:[(0,n.jsx)(s.Z.Group,{label:O.format("backupImportType"),name:"type",initialValue:"upload",options:O.option("backupImportTypeOption",["upload"])}),(0,n.jsx)(Z.Z,{name:["type"],children:function(_){var d=_.type;if(d=="upload")return(0,n.jsx)(G.Z,{required:!0,label:O.format("backupImportTarFileUpload"),name:"tarFileUpload",accept:".snapshot"});if(d=="serverPath")return(0,n.jsx)(R.Z,{required:!0,rules:[{required:!0}],name:"tarFilePath",label:O.format("backupImportTarFilePath")})}})]})}})}),W=C,a=e(5574),K=e.n(a),re=e(65913),h=e(85265),E=e(26412),v=e(42075),J=e(96074),L=e(25593),ae=e(66309),Q=e(2487),H=e(70146),X=e(5251),ce=e(45605),de=e(58638),me=e(38345),pe=e(76428),fe=(0,p.forwardRef)(function(y,F){(0,p.useImperativeHandle)(F,function(){return{show:function(M){return c()(r()().mark(function D(){var P;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,H.iD)({id:M});case 2:P=f.sent,m(P.data.detail),d(!0);case 5:case"end":return f.stop()}},D)}))()}}});var N=(0,p.useRef)(),O=(0,p.useState)(),z=K()(O,2),I=z[0],m=z[1],l=(0,p.useState)(!1),g=K()(l,2),_=g[0],d=g[1],u=new i.Uo("components.appDetail");return(0,n.jsx)(h.Z,{title:u.format("titleBackup"),open:_,onClose:function(){d(!1)},width:o.R_,children:(0,n.jsx)(re.Z,{ref:N,children:I&&I.map(function(t){var M,D,P=[],ee=[];return t.NetworkSettings&&t.NetworkSettings.Ports&&Object.entries(t.NetworkSettings.Ports).map(function(f){var A=K()(f,2),V=A[0],ne=A[1],Ee=ne!=null?ne:[{HostPort:null,HostIp:""}],De=V.split("/"),ie=K()(De,2),le=ie[0],ue=ie[1];Ee.map(function(te){te.HostPort?P.push({PrivatePort:le,Type:ue,IP:te.HostIp,PublicPort:te.HostPort}):ee.push({PrivatePort:le,Type:ue,IP:"",PublicPort:""})})}),(0,n.jsx)(me.Z,{title:(0,n.jsx)(ce.Z,{}),subTitle:u.format("titleBasic"),ghost:!0,children:(0,n.jsxs)(E.Z,{column:1,bordered:!0,children:[(0,n.jsx)(E.Z.Item,{label:i.FD.format("listName"),children:(0,n.jsx)(v.Z,{split:(0,n.jsx)(J.Z,{type:"vertical"}),children:(0,n.jsx)(L.Z.Text,{children:(0,X.fi)(t.Name,"/")})})}),(0,n.jsx)(E.Z.Item,{label:i.FD.format("listImageName"),children:(0,n.jsxs)(v.Z,{split:(0,n.jsx)(J.Z,{type:"vertical"}),children:[(0,n.jsx)(L.Z.Text,{copyable:!0,children:t.Config.Image}),(0,n.jsx)(ae.Z,{color:"blue",children:t.EnableImage?i.FD.format("listHas"):i.FD.format("listHasNot")})]})}),(0,n.jsx)(E.Z.Item,{label:i.FD.format("listPort"),children:(0,n.jsx)(v.Z,{size:"large",wrap:!0,children:[].concat(P,ee).map(function(f,A){return(0,n.jsx)(ae.Z,{color:f.PublicPort?"#2db7f5":"warning",icon:f.PublicPort?(0,n.jsx)(de.Z,{}):"",style:{marginBottom:10,marginRight:15,width:210},children:f.PublicPort?"".concat(f.PublicPort?f.IP+":"+f.PublicPort+" -> ":"").concat(f.PrivatePort,"/").concat(f.Type):"".concat(f.PrivatePort,"/").concat(f.Type)},A)})},"space")}),t.State.Running&&t.NetworkSettings.Networks&&Object.keys(t.NetworkSettings.Networks).map(function(f,A){return(0,n.jsx)(E.Z.Item,{label:f,children:f=="host"?i.FD.format("listNetworkUseHost"):(0,n.jsxs)(v.Z,{direction:"vertical",children:[(0,n.jsx)(pe.Z,{title:t.NetworkSettings.Networks[f].IPAddress}),t.NetworkSettings.Networks[f].Gateway,t.NetworkSettings.Networks[f].MacAddress]})},A)}),(0,n.jsx)(E.Z.Item,{label:i.FD.format("listEnv"),children:(0,n.jsx)(Q.Z,{dataSource:(M=t.Config.Env)!==null&&M!==void 0?M:[],renderItem:function(A){var V=A.split("=");return(0,n.jsxs)(Q.Z.Item,{children:[(0,n.jsx)(L.Z.Text,{code:!0,children:V[0]})," = ",(0,n.jsx)(L.Z.Text,{copyable:!0,children:V.slice(1).join("=")})]},V[0])}})}),t.Mounts&&t.Mounts.length>0&&(0,n.jsx)(E.Z.Item,{label:i.FD.format("listHostPath"),children:(0,n.jsx)(Q.Z,{dataSource:(D=t.Mounts)!==null&&D!==void 0?D:[],renderItem:function(A){return(0,n.jsxs)(Q.Z.Item,{children:[(0,n.jsx)(L.Z.Text,{code:!0,children:A.Source})," : ",(0,n.jsx)(L.Z.Text,{children:A.Destination})]},A.Source)}})})]})},t.Name)})})})}),he=fe,q=e(80821),_e=e(94359),Y=e(98510),se=e(87740),ve=e(87784),oe=e(82061),ge=e(99611),Pe=e(74453);function je(){var y=(0,p.useRef)(),F=(0,j.useAccess)(),N=(0,j.useModel)("subscriber"),O=(0,p.useRef)(),z=new i.Uo("app");return(0,n.jsxs)(Pe._z,{header:{extra:[(0,n.jsx)(W,{onFinish:function(){var m;!((m=y.current)===null||m===void 0)&&m.reloadAndRest&&y.current.reloadAndRest()}},"backup-import")]},children:[(0,n.jsx)(he,{ref:O}),(0,n.jsx)(Y.C,{rowKey:"id",columns:[{title:i.FD.format("listContainerName"),dataIndex:"containerId",width:150,render:function(m,l,g,_,d){return(0,n.jsx)(L.Z.Link,{onClick:function(){var t;(t=O.current)===null||t===void 0||t.show(l.id)},children:(0,X.fi)(l.containerId,"/")})}},{title:i.FD.format("listFilePath"),search:!1,width:300,render:function(m,l,g,_,d){var u=l.setting.backupTar;return(0,n.jsx)("span",{style:{wordBreak:"break-word"},children:u.substring(u.lastIndexOf("/",u.lastIndexOf("/")-1))})}},{title:i.FD.format("listSize"),search:!1,width:100,render:function(m,l,g,_,d){return l.setting.size?(0,n.jsx)(L.Z.Text,{children:(0,X.FI)(l.setting.size)}):"-"}},{title:i.FD.format("listContainerVolume"),search:!1,minWidth:100,render:function(m,l,g,_,d){return(0,n.jsx)(v.Z,{wrap:!0,children:l.setting.volumePathList.map(function(u){return u})})}},{title:i.FD.format("listStatus"),search:!1,width:80,render:function(m,l,g,_,d){var u,t;return(0,n.jsx)(_e.Z,{tip:(u=l.setting.error)!==null&&u!==void 0?u:"",status:"status.".concat((t=l.setting.status)!==null&&t!==void 0?t:"30")},l.id)}},{title:i.FD.format("listCreatedAt"),search:!1,width:200,render:function(m,l,g,_,d){return new Date(l.createdAt).toLocaleString()}},{title:i.FD.format("listManage"),search:!1,width:100,fixed:"right",hidden:!F.canSeeContainerBackupManage,render:function(m,l,g,_,d){return(0,n.jsxs)(v.Z,{split:(0,n.jsx)(J.Z,{}),children:[l.setting.status=="30"&&(0,n.jsx)(q.Z,{buttonProps:{ghost:!0,type:"link",icon:(0,n.jsx)(se.Z,{})},confirmProps:{description:(0,n.jsx)(v.Z,{style:{width:300},children:z.format("backupRestoreConfirm")})},tips:i.FD.format("listManageUnpause"),action:function(){return(0,H.SR)({id:l.id,enableForce:!1})}}),l.setting.status=="10"&&(0,n.jsx)(q.Z,{buttonProps:{danger:!0,ghost:!0,type:"link",icon:(0,n.jsx)(ve.Z,{})},action:c()(r()().mark(function u(){return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return N.progress.close("container:backup:".concat(l.id)),setTimeout(function(){var D;!((D=y.current)===null||D===void 0)&&D.reloadAndRest&&y.current.reloadAndRest()},500),M.abrupt("return",!1);case 3:case"end":return M.stop()}},u)}))})]})}}],request:function(){var I=c()(r()().mark(function m(l,g,_){var d;return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,H.Zy)({containerId:l.containerId,page:l.current,pageSize:l.pageSize});case 2:return d=t.sent,t.abrupt("return",{data:d.data.list,success:!0,total:d.data.total});case 4:case"end":return t.stop()}},m)}));return function(m,l,g){return I.apply(this,arguments)}}(),rowSelection:F.canSeeContainerBackupManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:y,quickToolbarRender:function(m){var l=m.selectedRows,g=m.finish,_=m.loading;return(0,n.jsx)(v.Z,{size:16,children:(0,n.jsx)(q.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,n.jsx)(oe.Z,{})},confirmProps:{showCommonConfirm:!0},action:c()(r()().mark(function d(){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return _(),t.abrupt("return",(0,H.VE)({id:l.map(function(M){return M.id})}).finally(function(){g(!0)}));case 2:case"end":return t.stop()}},d)})),onSuccess:function(){var u,t;return!((u=y.current)===null||u===void 0)&&u.reloadAndRest&&((t=y.current)===null||t===void 0||t.reloadAndRest()),!0},onError:function(){var u,t;return!((u=y.current)===null||u===void 0)&&u.reset&&((t=y.current)===null||t===void 0||t.reset()),!0},children:i.FD.format("listManageDeleteBatch")},"batchDelete")})},contextMenu:function(m){var l=m.loading,g=m.finish,_=m.isMultiple,d=m.selectedRow,u=m.selectedRows;return{items:[{type:"group",label:i.FD.format("listManage"),key:"operator",children:[{label:(0,n.jsx)(Y.C.ContextMenuItem,{buttonProps:{icon:(0,n.jsx)(ge.Z,{}),disabled:_()},action:c()(r()().mark(function t(){var M;return r()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:g(!0),(M=O.current)===null||M===void 0||M.show(d.id);case 2:case"end":return P.stop()}},t)})),children:i.FD.format("listManageView")}),key:"view"},{label:(0,n.jsx)(Y.C.ContextMenuItem,{buttonProps:{icon:(0,n.jsx)(se.Z,{}),disabled:_()},action:c()(r()().mark(function t(){return r()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return g(!0),D.abrupt("return",(0,H.SR)({id:d.id,enableForce:!1}).then(function(){var P;!((P=y.current)===null||P===void 0)&&P.reloadAndRest&&y.current.reloadAndRest()}).finally(function(){g()}));case 2:case"end":return D.stop()}},t)})),confirmProps:{description:z.format("recycleRestoreConfirm")},children:i.FD.format("listManageUnpause")}),key:"recover"}]},{key:"delete",label:(0,n.jsx)(Y.C.ContextMenuItem,{buttonProps:{icon:(0,n.jsx)(oe.Z,{})},type:"danger",confirmProps:{showCommonConfirm:!0},action:c()(r()().mark(function t(){return r()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return l(),D.abrupt("return",(0,H.VE)({id:u.map(function(P){return P.id})}).finally(function(){g(!0)}));case 2:case"end":return D.stop()}},t)})),children:i.FD.format("listManageDelete")},"deleteBatch")}]}}})]})}},70146:function(k,T,e){e.d(T,{SR:function(){return j},VE:function(){return p},Zy:function(){return R},iD:function(){return $},vG:function(){return G},yB:function(){return s}});var w=e(15009),r=e.n(w),B=e(99289),c=e.n(B),x=e(82346);function s(n){return Z.apply(this,arguments)}function Z(){return Z=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/container-backup/create",{data:C,method:"POST"});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},n)})),Z.apply(this,arguments)}function R(n){return U.apply(this,arguments)}function U(){return U=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/container-backup/get-list",{method:"POST",data:C}));case 1:case"end":return a.stop()}},n)})),U.apply(this,arguments)}function p(n){return b.apply(this,arguments)}function b(){return b=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/container-backup/delete",{method:"POST",data:C}));case 1:case"end":return a.stop()}},n)})),b.apply(this,arguments)}function j(n){return S.apply(this,arguments)}function S(){return S=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/container-backup/restore",{method:"POST",data:C}));case 1:case"end":return a.stop()}},n)})),S.apply(this,arguments)}function $(n){return o.apply(this,arguments)}function o(){return o=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,x.request)("/api/app/container-backup/get-detail",{method:"POST",data:C}));case 1:case"end":return a.stop()}},n)})),o.apply(this,arguments)}function G(n){return i.apply(this,arguments)}function i(){return i=c()(r()().mark(function n(C){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,x.request)("/api/app/site/restore",{data:C,method:"POST"});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},n)})),i.apply(this,arguments)}},4813:function(k,T,e){e.d(T,{_:function(){return s}});var w=e(15009),r=e.n(w),B=e(99289),c=e.n(B),x=e(82346);function s(R){return Z.apply(this,arguments)}function Z(){return Z=c()(r()().mark(function R(U){return r()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,x.request)("/api/common/attach/delete",{method:"POST",data:U});case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},R)})),Z.apply(this,arguments)}}}]);
