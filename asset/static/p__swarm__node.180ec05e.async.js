"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3763],{52645:function(ce,z,i){i.d(z,{Z:function(){return F}});var X=i(87462),c=i(67294),Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},I=Q,Y=i(84089),V=function(te,ne){return c.createElement(Y.Z,(0,X.Z)({},te,{ref:ne,icon:I}))},q=c.forwardRef(V),F=q},91806:function(ce,z,i){i.d(z,{Z:function(){return F}});var X=i(87462),c=i(67294),Q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},I=Q,Y=i(84089),V=function(te,ne){return c.createElement(Y.Z,(0,X.Z)({},te,{ref:ne,icon:I}))},q=c.forwardRef(V),F=q},75293:function(ce,z,i){i.d(z,{Z:function(){return Q}});var X=i(25593),c=i(85893);function Q(I){return(0,c.jsx)(X.Z.Text,{copyable:!0,style:{padding:10,display:I.block?"block":"",background:"#24292f",color:"#ffffff"},children:I.content})}},47900:function(ce,z,i){i.r(z),i.d(z,{default:function(){return wt}});var X=i(15009),c=i.n(X),Q=i(99289),I=i.n(Q),Y=i(5574),V=i.n(Y),q=i(10781),F=i(24494),r=i(36146),te=i(184),ne=i(5966),ye=i(52688),Ie=i(83622),ue=i(86250),S=i(67294),e=i(85893);function Be(u){var g=(0,S.useRef)(),n=new r.Uo("swarm");return(0,e.jsxs)(te.a,{title:n.format("nodeInitTitle"),trigger:(0,e.jsx)(Ie.ZP,{type:"primary",children:n.format("nodeInitTitle")}),onFinish:function(){var $=I()(c()().mark(function C(x){var D;return c()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,F.UK)({advertiseAddr:x.advertiseAddr,listenAddr:x.listenAddr,dataPathAddr:x.dataPathAddr,autoLockManagers:x.autoLockManagers,forceNewCluster:x.forceNewCluster,subnet:x.subnet});case 2:return D=m.sent,u.onFinish&&u.onFinish(),m.abrupt("return",!0);case 5:case"end":return m.stop()}},C)}));return function(C){return $.apply(this,arguments)}}(),formRef:g,onOpenChange:function(C){var x;!C&&(!((x=g.current)===null||x===void 0)&&x.resetFields)&&g.current.resetFields()},children:[(0,e.jsx)(ne.Z,{name:"advertiseAddr",label:n.format("nodeInitAdvertiseAddr"),tooltip:n.format("nodeInitAdvertiseAddrTip"),required:!0,rules:[{required:!0}],placeholder:"172.16.1.13"}),(0,e.jsx)(ne.Z,{name:"listenAddr",label:n.format("nodeInitListenAddr"),tooltip:n.format("nodeInitListenAddrTip"),initialValue:"0.0.0.0",required:!0,rules:[{required:!0}]}),(0,e.jsx)(ne.Z,{name:"subnet",label:n.format("nodeInitSubnet"),initialValue:"10.0.0.0/16"}),(0,e.jsxs)(ue.Z,{gap:30,children:[(0,e.jsx)(ye.Z,{label:n.format("nodeInitAutoLockManagers"),name:"autoLockManagers",tooltip:n.format("nodeInitAutoLockManagersTip")}),(0,e.jsx)(ye.Z,{label:n.format("nodeInitForceNewCluster"),name:"forceNewCluster",tooltip:n.format("nodeInitForceNewClusterTip")})]})]})}var Re=i(3616),ke=i(86615),ze=i(64317),We=i(97462),Se=i(62370),$e=i(40056),Ce=i(75293),Oe=i(63713);function Fe(u){var g,n=new r.Uo("swarm"),$=(0,S.useRef)(),C=(0,S.useState)(),x=V()(C,2),D=x[0],E=x[1],m=(0,Oe.useModel)("@@initialState"),W=m.initialState;(0,S.useEffect)(function(){u.detail&&u.type=="add"&&A(u.detail,"worker")},[u.detail]);function A(T,h){return _.apply(this,arguments)}function _(){return _=I()(c()().mark(function T(h,M){var L,N,P;return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:E("docker swarm join --token ".concat(M=="manager"?(L=h.swarm)===null||L===void 0?void 0:L.JoinTokens.Manager:(N=h.swarm)===null||N===void 0?void 0:N.JoinTokens.Worker," ").concat((h==null?void 0:h.node)&&(h==null||(P=h.node.ManagerStatus)===null||P===void 0?void 0:P.Addr)));case 1:case"end":return y.stop()}},T)})),_.apply(this,arguments)}return(0,e.jsxs)(te.a,{drawerProps:{width:Re.R_},submitter:!1,formRef:$,onOpenChange:function(h){var M;!h&&(!((M=$.current)===null||M===void 0)&&M.resetFields)&&$.current.resetFields(),!h&&u.onFinish&&u.onFinish()},title:n.format("nodeJoinTitleOption.".concat(u.type)),trigger:(0,e.jsx)(Ie.ZP,{children:n.format("nodeJoinTitleOption.".concat(u.type))}),onValuesChange:function(){var T=I()(c()().mark(function h(M,L){var N,P;return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(E(""),!L.dockerEnvName){y.next=12;break}return y.prev=2,y.next=5,(0,F.vb)({dockerEnvName:L.dockerEnvName,role:L.role,type:u.type});case 5:N=y.sent,A(N.data,L.role),y.next=12;break;case 9:y.prev=9,y.t0=y.catch(2),(P=$.current)===null||P===void 0||P.resetFields(["dockerEnvName"]);case 12:u.type=="add"&&u.detail&&A(u.detail,L.role);case 13:case"end":return y.stop()}},h,null,[[2,9]])}));return function(h,M){return T.apply(this,arguments)}}(),children:[(0,e.jsx)(ke.Z.Group,{label:n.format("nodeJoinRole"),name:"role",initialValue:"worker",options:n.option("nodeAddRoleOption",["manager","worker"])}),u.type=="join"&&(0,e.jsx)(ze.Z,{label:n.format("nodeJoinDockerEnvName"),name:"dockerEnvName",placeholder:n.format("nodeJoinDockerEnvNameEmpty"),options:W==null||(g=W.dockerEnv)===null||g===void 0?void 0:g.list.map(function(T){return{value:T.name,label:T.title}})},"env"),u.type=="join"&&!D&&(0,e.jsx)(We.Z,{name:["role"],children:function(h){var M=h.role;return(0,e.jsx)(Se.Z,{label:n.format("nodeJoinCommandManual"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)($e.Z,{type:"warning",message:n.format("nodeJoinCommandManualTip")}),(0,e.jsx)(Ce.Z,{block:!0,content:"docker swarm join-token ".concat(M)})]})})}}),D&&(0,e.jsx)(Se.Z,{label:n.format("nodeJoinCommandJoin"),children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,style:{marginTop:10},children:[(0,e.jsx)($e.Z,{message:n.format("nodeJoinCommandJoinTip",{target:n.format("nodeJoinCommandJoinTargetOption.".concat(u.type))})}),(0,e.jsx)(Ce.Z,{block:!0,content:D})]})})]})}var Ke=i(43425),Ge=i(74842),Xe=i(30159),Qe=i(87784),ve=i(87462),Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"},qe=Ye,fe=i(84089),_e=function(g,n){return S.createElement(fe.Z,(0,ve.Z)({},g,{ref:n,icon:qe}))},et=S.forwardRef(_e),tt=et,nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},it=nt,at=function(g,n){return S.createElement(fe.Z,(0,ve.Z)({},g,{ref:n,icon:it}))},ot=S.forwardRef(at),rt=ot,lt=i(45605),st=i(91806),be=i(60433),B=i(38345),ee=i(42075),we=i(96074),R=i(26412),me=i(66309),ie=i(80821),ge=i(5251),dt=i(91058),ut=i(76428),ct=i(24963),vt=i(97269),Te=i(25593),ft=i(84567);function Ae(u){var g=(0,S.useRef)(),n=new r.Uo("swarm");return(0,e.jsx)(ie.Z,{buttonProps:{type:"primary",danger:!0},confirmProps:{title:r.FD.format("title.tip"),onOpenChange:function(C,x){var D;!((D=g.current)===null||D===void 0)&&D.resetFields&&g.current.resetFields()},description:(0,e.jsx)(vt.A,{submitter:!1,formRef:g,children:(0,e.jsxs)(ee.Z,{style:{width:600,paddingRight:"10px"},direction:"vertical",children:[(0,e.jsx)(Te.Z.Text,{children:(0,e.jsx)("ul",{children:n.prefix("removeButtonTipOption",4).map(function($,C){return(0,e.jsx)("li",{children:$},C)})})}),(0,e.jsx)(Se.Z,{name:"enableForce",valuePropName:"checked",children:(0,e.jsxs)(ft.Z,{disabled:!!u.nodeId,children:[r.FD.format("listManageExitForce"),"\uFF1F"]})})]})})},action:I()(c()().mark(function $(){var C;return c()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.abrupt("return",(0,F.QB)({nodeId:u.nodeId,force:(C=g.current)===null||C===void 0?void 0:C.getFieldValue("enableForce")}));case 1:case"end":return D.stop()}},$)})),onSuccess:function(){u.onFinish&&u.onFinish()},children:u.title},"console")}var mt=i(94617),pt=(0,S.forwardRef)(function(u,g){var n,$,C,x,D,E,m,W,A,_,T,h,M,L,N,P,ae,y,re,O,Z,l,j,w,U,s,a,d,p,b,J,H,le,se,De;(0,S.useImperativeHandle)(g,function(){return{show:function(o){var K,v,de;!((K=o.Spec)===null||K===void 0)&&K.Labels&&((v=Je.current)===null||v===void 0||v.setFieldValue("labels",Object.keys((de=o.Spec)===null||de===void 0?void 0:de.Labels).map(function(he){var G,xe,Ze;return{name:he,value:(G=o.Spec)!==null&&G!==void 0&&G.Labels&&(xe=o.Spec)!==null&&xe!==void 0&&xe.Labels[he]?(Ze=o.Spec)===null||Ze===void 0?void 0:Ze.Labels[he]:""}}))),oe(o),je(!0)}}});var Tt=(0,S.useState)(!1),Ue=V()(Tt,2),He=Ue[0],je=Ue[1],Je=(0,S.useRef)(),At=(0,S.useState)(),Ve=V()(At,2),t=Ve[0],oe=Ve[1],k=new r.Uo("swarm"),pe=new r.Uo("system.home.overview"),Mt=(0,S.useContext)(ct.Z),Lt=Mt.message;return(0,e.jsx)(te.a,{title:k.format("nodeDetailTitle",{name:t==null||(n=t.Description)===null||n===void 0?void 0:n.Hostname}),open:He,drawerProps:{forceRender:!0,width:Re.R_},onOpenChange:function(o){je(o),!o&&u.onFinish&&u.onFinish()},onFinish:function(){var f=I()(c()().mark(function o(K){var v,de;return c()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,F.Zc)({nodeId:(v=t==null?void 0:t.ID)!==null&&v!==void 0?v:"",labels:K.labels});case 2:return de=G.sent,oe(de.data.detail),Lt.success(r.FD.format("finish")),G.abrupt("return",!1);case 6:case"end":return G.stop()}},o)}));return function(o){return f.apply(this,arguments)}}(),formRef:Je,children:(0,e.jsxs)(ue.Z,{vertical:!0,gap:20,children:[(0,e.jsx)(B.Z,{title:(0,e.jsx)(Ke.Z,{}),ghost:!0,subTitle:r.FD.format("listManage"),children:(0,e.jsxs)(ee.Z,{wrap:!0,children:[(0,e.jsx)(ie.Z,{buttonProps:{disabled:(t==null||($=t.Spec)===null||$===void 0?void 0:$.Availability)=="active"||(t==null||(C=t.Status)===null||C===void 0?void 0:C.State)!="ready",icon:(0,e.jsx)(Ge.Z,{})},action:I()(c()().mark(function f(){var o;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.Zc)({nodeId:(o=t==null?void 0:t.ID)!==null&&o!==void 0?o:"",availability:"active"}));case 1:case"end":return v.stop()}},f)})),onSuccess:function(o){oe(o.data.detail)},tips:k.format("nodeListStatusOptionTip.active"),children:r.FD.format("listManageUnpause")}),(0,e.jsx)(ie.Z,{action:I()(c()().mark(function f(){var o;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.Zc)({nodeId:(o=t==null?void 0:t.ID)!==null&&o!==void 0?o:"",availability:"pause"}));case 1:case"end":return v.stop()}},f)})),onSuccess:function(o){oe(o.data.detail)},tips:k.format("nodeListStatusOptionTip.pause"),buttonProps:{disabled:(t==null||(x=t.Spec)===null||x===void 0?void 0:x.Availability)=="pause"||(t==null||(D=t.Status)===null||D===void 0?void 0:D.State)!="ready",icon:(0,e.jsx)(Xe.Z,{})},children:r.FD.format("listManagePause")}),(0,e.jsx)(ie.Z,{action:I()(c()().mark(function f(){var o;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.Zc)({nodeId:(o=t==null?void 0:t.ID)!==null&&o!==void 0?o:"",availability:"drain"}));case 1:case"end":return v.stop()}},f)})),onSuccess:function(o){oe(o.data.detail)},tips:k.format("nodeListStatusOptionTip.drain"),buttonProps:{disabled:(t==null||(E=t.Spec)===null||E===void 0?void 0:E.Availability)=="drain"||(t==null||(m=t.Status)===null||m===void 0?void 0:m.State)!="ready",icon:(0,e.jsx)(Qe.Z,{})},children:r.FD.format("listManageStop")}),(0,e.jsx)(we.Z,{type:"vertical"}),(t==null||(W=t.Spec)===null||W===void 0?void 0:W.Role)=="worker"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ie.Z,{action:I()(c()().mark(function f(){var o;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.Zc)({nodeId:(o=t==null?void 0:t.ID)!==null&&o!==void 0?o:"",role:"manager"}));case 1:case"end":return v.stop()}},f)})),onSuccess:function(o){oe(o.data.detail)},buttonProps:{disabled:(t==null||(A=t.Spec)===null||A===void 0?void 0:A.Availability)=="drain"||(t==null||(_=t.Status)===null||_===void 0?void 0:_.State)!="ready",icon:(0,e.jsx)(tt,{}),type:"primary"},children:k.format("nodeDetailManageManager")})}),(t==null||(T=t.Spec)===null||T===void 0?void 0:T.Role)=="manager"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ie.Z,{action:I()(c()().mark(function f(){var o;return c()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,F.Zc)({nodeId:(o=t==null?void 0:t.ID)!==null&&o!==void 0?o:"",role:"worker"}));case 1:case"end":return v.stop()}},f)})),onSuccess:function(o){oe(o.data.detail)},buttonProps:{disabled:(t==null||(h=t.Spec)===null||h===void 0?void 0:h.Availability)=="drain"||(t==null||(M=t.Status)===null||M===void 0?void 0:M.State)!="ready",icon:(0,e.jsx)(rt,{}),type:"primary"},children:k.format("nodeDetailManageWorker")})}),(0,e.jsx)(we.Z,{type:"vertical"}),(0,e.jsx)(Ae,{title:r.FD.format("listManageDelete"),nodeId:t==null?void 0:t.ID,onFinish:function(){je(!1),u.onFinish&&u.onFinish()}})]})}),(0,e.jsx)(B.Z,{title:(0,e.jsx)(lt.Z,{}),subTitle:r.FD.format("listManageDetail"),ghost:!0,children:(0,e.jsxs)(R.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,e.jsxs)(R.Z.Item,{label:"Hostname",children:[(0,e.jsx)(ut.Z,{title:t==null?void 0:t.ID})," - ",t==null||(L=t.Description)===null||L===void 0?void 0:L.Hostname," - ",(0,e.jsx)(me.Z,{color:"blue",children:t==null||(N=t.Spec)===null||N===void 0?void 0:N.Role})," ",t&&(0,e.jsx)(q.Z,{status:"swarm.".concat((P=t.Status)===null||P===void 0?void 0:P.State),tip:k.format("nodeListRunStatusTipOption.".concat((ae=(y=t.Status)===null||y===void 0?void 0:y.State)!==null&&ae!==void 0?ae:"ready"))}),t&&(0,e.jsx)(q.Z,{status:"swarm.".concat((re=t.Spec)===null||re===void 0?void 0:re.Availability),tip:k.format("nodeListStatusOptionTip.".concat((O=(Z=t.Spec)===null||Z===void 0?void 0:Z.Availability)!==null&&O!==void 0?O:"active"))})]}),(0,e.jsx)(R.Z.Item,{label:pe.format("basicDockerTitleSystemVersion"),children:"".concat(t==null||(l=t.Description)===null||l===void 0||(l=l.Platform)===null||l===void 0?void 0:l.OS,` - 
              `).concat(t==null||(j=t.Description)===null||j===void 0||(j=j.Platform)===null||j===void 0?void 0:j.Architecture,` - 
              `).concat(t==null||(w=t.Description)===null||w===void 0||(w=w.Engine)===null||w===void 0?void 0:w.EngineVersion)}),(0,e.jsxs)(R.Z.Item,{label:"Cpu",children:[((U=t==null||(s=t.Description)===null||s===void 0||(s=s.Resources)===null||s===void 0?void 0:s.NanoCPUs)!==null&&U!==void 0?U:0)/1e9," ",r.FD.format("unitCpu")]}),(0,e.jsx)(R.Z.Item,{label:"Memory",children:(0,ge.FI)((a=t==null||(d=t.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.MemoryBytes)!==null&&a!==void 0?a:0)}),(0,e.jsx)(R.Z.Item,{label:pe.format("basicDockerTitlePluginsVolume"),children:(0,e.jsx)(ee.Z,{children:(t==null||(p=t.Description)===null||p===void 0||(p=p.Engine)===null||p===void 0?void 0:p.Plugins)&&(t==null||(b=t.Description)===null||b===void 0||(b=b.Engine)===null||b===void 0?void 0:b.Plugins.filter(function(f){return f.Type=="Volume"}).map(function(f){return f.Name}))})}),(0,e.jsx)(R.Z.Item,{label:pe.format("basicDockerTitlePluginsNetwork"),children:(0,e.jsx)(ee.Z,{wrap:!0,children:(t==null||(J=t.Description)===null||J===void 0||(J=J.Engine)===null||J===void 0?void 0:J.Plugins)&&(t==null||(H=t.Description)===null||H===void 0||(H=H.Engine)===null||H===void 0?void 0:H.Plugins.filter(function(f){return f.Type=="Network"}).map(function(f){return f.Name}))})}),(0,e.jsx)(R.Z.Item,{label:pe.format("basicDockerTitleLogDriver"),children:(0,e.jsx)(ee.Z,{wrap:!0,children:(t==null||(le=t.Description)===null||le===void 0||(le=le.Engine)===null||le===void 0?void 0:le.Plugins)&&(t==null||(se=t.Description)===null||se===void 0||(se=se.Engine)===null||se===void 0?void 0:se.Plugins.filter(function(f){return f.Type=="Log"}).map(function(f){return f.Name}))})})]})}),t&&t.ID&&He&&(0,e.jsx)(B.Z,{title:(0,e.jsx)(st.Z,{}),subTitle:k.format("nodeDetailServiceList"),headStyle:{paddingBottom:0},ghost:!0,children:(0,e.jsx)(mt.Z,{showWithNodeId:t.ID,tableProps:{search:!1,ghost:!0}})}),(t==null||(De=t.Spec)===null||De===void 0?void 0:De.Labels)&&(0,e.jsx)(B.Z,{title:(0,e.jsx)(be.Z,{}),ghost:!0,subTitle:k.format("nodeDetailTagList"),children:(0,e.jsx)(dt.Z,{drawerProps:{ghost:!0},name:"labels",showAddButton:!0,addButtonLabel:k.format("nodeDetailTagAdd")})})]})})}),ht=pt,St=i(98009),gt=function(g,n){return S.createElement(fe.Z,(0,ve.Z)({},g,{ref:n,icon:St.Z}))},Dt=S.forwardRef(gt),Me=Dt,jt=i(30432),xt=function(g,n){return S.createElement(fe.Z,(0,ve.Z)({},g,{ref:n,icon:jt.Z}))},Zt=S.forwardRef(xt),yt=Zt,It=i(52645),Rt=i(74453),$t=i(40018),Le=i(32983),Ct=i(60940),Ot=i(40411),Ft=i(83062),bt=i(22181),Pe=i(95833),Ee={xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},Ne={display:"flex",justifyContent:"flex-end",width:100};function wt(){var u=(0,S.useState)(),g=V()(u,2),n=g[0],$=g[1],C=(0,S.useState)(0),x=V()(C,2),D=x[0],E=x[1],m=new r.Uo("swarm"),W=(0,S.useRef)(),A=(0,S.useRef)(),_=(0,S.useState)(),T=V()(_,2),h=T[0],M=T[1],L=(0,S.useState)(),N=V()(L,2),P=N[0],ae=N[1],y=(0,Oe.useModel)("@@initialState"),re=y.refresh;return(0,S.useEffect)(function(){(0,F.JC)().then(function(O){var Z;$(O.data),!((Z=A.current)===null||Z===void 0)&&Z.reloadAndRest&&A.current.reloadAndRest()})},[D]),(0,e.jsxs)(Rt._z,{extra:[n&&n.status.isManage&&(0,e.jsx)(Fe,{type:"add",detail:n,onFinish:function(){E(D+1)}},"join"),n&&n.status.isNode&&(0,e.jsx)(Ae,{title:m.format("nodeDetailDeleteButtonOption.".concat(n.status.isManage?"delete":"leave")),onFinish:function(){n.status.isManage?re():E(D+1)}},"leave")],children:[(0,e.jsx)(ht,{ref:W,onFinish:function(){E(D+1)}}),(0,e.jsxs)(B.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(!n||!n.status.isNode)&&(0,e.jsx)(ue.Z,{justify:"center",style:{height:"58vh"},vertical:!0,children:(0,e.jsx)(Le.Z,{image:Le.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(ee.Z,{direction:"vertical",size:[0,20],children:[m.format("nodeDetailJoinTip"),(0,e.jsxs)(ee.Z,{children:[(0,e.jsx)(Fe,{type:"join",detail:n,onFinish:function(){E(D+1)}},"join"),(0,e.jsx)(Be,{onFinish:function(){re(),E(D+1)}})]})]})})}),n&&n.status.isNode&&n.info&&n.info.LocalNodeState!="error"&&(0,e.jsxs)(B.Z,{title:(0,e.jsx)(Me,{}),subTitle:m.format("nodeDetailCurrent"),direction:"column",gutter:[0,20],children:[(0,e.jsx)(B.Z,{ghost:!0,children:(0,e.jsxs)(R.Z,{column:Ee,styles:{label:Ne},children:[(0,e.jsx)(R.Z.Item,{label:"Id",children:n.info.NodeID}),(0,e.jsx)(R.Z.Item,{label:r.FD.format("listRunStatus"),children:(0,e.jsx)(q.Z,{status:"swarm.".concat(n.info.LocalNodeState),tip:m.format("nodeListRunStatusTipOption.".concat(n.info.LocalNodeState))})}),(0,e.jsx)(R.Z.Item,{label:r.FD.format("listType"),children:m.format("nodeAddRoleOption.".concat(n.info.ControlAvailable?"manager":"worker"))})]})}),n.info.RemoteManagers&&!n.status.isManage&&(0,e.jsx)(B.Z,{ghost:!0,title:(0,e.jsx)(Me,{}),subTitle:m.format("nodeDetailManager"),children:(0,e.jsx)(Ct.Z,{pagination:!1,columns:[{title:r.FD.format("listName"),dataIndex:"NodeID"},{title:r.FD.format("listIpAddress"),dataIndex:"Addr"}],dataSource:n.info.RemoteManagers})})]}),n&&n.status.isManage&&n.swarm&&(0,e.jsx)(B.Z,{title:(0,e.jsx)(yt,{}),subTitle:m.format("nodeDetailSwarm"),direction:"column",gutter:[0,15],children:(0,e.jsx)(B.Z,{ghost:!0,children:(0,e.jsxs)(R.Z,{column:Ee,styles:{label:Ne},children:[(0,e.jsx)(R.Z.Item,{label:r.FD.format("listName"),children:n.swarm.ID}),(0,e.jsx)(R.Z.Item,{label:r.FD.format("listTitle"),children:n.swarm.Spec&&n.swarm.Spec.Name}),(0,e.jsxs)(R.Z.Item,{label:r.FD.format("listResource"),children:[h&&(0,Pe.PD)(h.cpu)," ",r.FD.format("unitCpu")," / ",(0,ge.FI)(h==null?void 0:h.memory)]}),(0,e.jsxs)(R.Z.Item,{label:"".concat(m.format("nodeDetailSwarmWorker")," / ").concat(m.format("nodeDetailSwarmManager")),children:[n.info.Nodes," / ",n.info.Managers]}),(0,e.jsx)(R.Z.Item,{label:r.FD.format("listCreatedAt"),children:new Date(n.swarm.CreatedAt).toLocaleString()}),(0,e.jsx)(R.Z.Item,{label:r.FD.format("listUpdatedAt"),children:new Date(n.swarm.UpdatedAt).toLocaleString()})]})})}),n&&n.status.isManage&&n.info.LocalNodeState!="error"&&(0,e.jsx)(B.Z,{title:(0,e.jsx)(be.Z,{}),subTitle:m.format("nodeDetailSwarmNodeList"),children:(0,e.jsx)($t.Z,{scroll:{x:"max-content"},rowKey:"ID",actionRef:A,pagination:!1,ghost:!0,search:!1,request:I()(c()().mark(function O(){var Z,l,j,w,U;return c()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,F.HN)();case 2:return Z=a.sent,l={cpu:0,memory:0},Z.data.list&&Z.data.list.forEach(function(d){var p,b,J,H;l.cpu+=(p=(b=d.Description)===null||b===void 0||(b=b.Resources)===null||b===void 0?void 0:b.NanoCPUs)!==null&&p!==void 0?p:0,l.memory+=(J=(H=d.Description)===null||H===void 0||(H=H.Resources)===null||H===void 0?void 0:H.MemoryBytes)!==null&&J!==void 0?J:0}),M(l),a.next=8,(0,F.kM)();case 8:return j=a.sent,a.next=11,(0,F.XX)();case 11:return w=a.sent,w.data&&w.data.list&&(U=[],w.data.list.forEach(function(d){if(d.Status.State=="running"){var p,b=j.data&&j.data.list&&((p=j.data.list.find(function(J){return J.ID==d.ServiceID}))===null||p===void 0||(p=p.Spec)===null||p===void 0?void 0:p.Name);(!b||b=="")&&(b=d.ServiceID),U.push({nodeId:d.NodeID,serviceName:b,taskId:d.ID})}}),ae(U)),a.abrupt("return",{data:Z.data.list,success:!0,total:Z.data.list.length});case 14:case"end":return a.stop()}},O)})),columns:[{title:r.FD.format("listName"),render:function(Z,l,j,w,U){var s,a;return(0,e.jsxs)(ee.Z,{children:[(0,e.jsx)(Te.Z.Link,{onClick:function(){var p;(p=W.current)===null||p===void 0||p.show(l)},children:(s=(a=l.Description)===null||a===void 0?void 0:a.Hostname)!==null&&s!==void 0?s:l.ID})," ",n.node&&l.ID==n.node.ID&&(0,e.jsx)(Ot.Z,{status:"processing"})]})}},{title:r.FD.format("listRole"),dataIndex:["Spec","Role"],render:function(Z,l,j,w,U){var s,a,d,p;return(0,e.jsx)(me.Z,{color:m.format("nodeAddRoleColorOption.".concat((s=(a=l.Spec)===null||a===void 0?void 0:a.Role)!==null&&s!==void 0?s:"worker")),children:m.format("nodeAddRoleOption.".concat((d=(p=l.Spec)===null||p===void 0?void 0:p.Role)!==null&&d!==void 0?d:"worker"))})}},{title:"CPU / Memory",render:function(Z,l,j,w,U){var s,a,d;return"".concat((0,Pe.PD)((s=l.Description)===null||s===void 0||(s=s.Resources)===null||s===void 0?void 0:s.NanoCPUs)," ").concat(r.FD.format("unitCpu")," / ").concat((0,ge.FI)((a=(d=l.Description)===null||d===void 0||(d=d.Resources)===null||d===void 0?void 0:d.MemoryBytes)!==null&&a!==void 0?a:0))}},{title:r.FD.format("listRunTask"),render:function(Z,l,j,w,U){var s={};return P&&P.filter(function(a){return a.nodeId==l.ID}).forEach(function(a){s[a.serviceName]||(s[a.serviceName]=0),s[a.serviceName]+=1}),Object.keys(s).length>0?Object.keys(s).map(function(a,d){return(0,e.jsx)(Ft.Z,{title:a,children:(0,e.jsx)(me.Z,{color:"success",children:s[a]})},"".concat(a,"-").concat(d))}):(0,e.jsx)(me.Z,{children:"0"})}},{title:r.FD.format("listApiVersion"),dataIndex:["Description","Engine","EngineVersion"]},{title:r.FD.format("listIpAddress"),dataIndex:["Status","Addr"]},{title:r.FD.format("listRunStatus"),render:function(Z,l,j,w,U){var s,a,d=(s=(a=l.Status)===null||a===void 0?void 0:a.State)!==null&&s!==void 0?s:"ready";return(0,e.jsx)(q.Z,{status:"swarm.".concat(d),tip:m.format("nodeListRunStatusTipOption.".concat(d))})}},{title:r.FD.format("listStatus"),render:function(Z,l,j,w,U){var s,a,d,p;return(0,e.jsx)(q.Z,{status:"swarm.".concat((s=(a=l.Spec)===null||a===void 0?void 0:a.Availability)!==null&&s!==void 0?s:"active"),tip:m.format("nodeListStatusOptionTip.".concat((d=(p=l.Spec)===null||p===void 0?void 0:p.Availability)!==null&&d!==void 0?d:"active"))})}}],toolBarRender:function(){return[(0,e.jsx)(ie.Z,{action:function(){return(0,F.kp)()},onSuccess:function(){var l,j;return!((l=A.current)===null||l===void 0)&&l.reloadAndRest&&((j=A.current)===null||j===void 0||j.reloadAndRest()),!0},onError:function(){var l,j;return!((l=A.current)===null||l===void 0)&&l.reset&&((j=A.current)===null||j===void 0||j.reset()),!0},confirmProps:{description:m.format("nodeListManagePruneTip")},buttonProps:{icon:(0,e.jsx)(It.Z,{})},children:r.FD.format("listManagePrune")},"clear")]}})}),n&&n.status.isNode&&n.info.LocalNodeState=="error"&&(0,e.jsx)(bt.ZP,{status:"error",title:m.format(["nodeListRunStatusTipOption.error","nodeListRunStatusTipOption.exit"]),subTitle:n.info.Error})]})]})}},72714:function(ce,z,i){var X=i(93589),c=i(18533),Q="[object Symbol]";function I(Y){return typeof Y=="symbol"||(0,c.Z)(Y)&&(0,X.Z)(Y)==Q}z.Z=I}}]);
