"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{52645:function(_,I,n){n.d(I,{Z:function(){return V}});var S=n(87462),s=n(67294),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},g=M,U=n(84089),L=function(T,N){return s.createElement(U.Z,(0,S.Z)({},T,{ref:N,icon:g}))},A=s.forwardRef(L),V=A},60415:function(_,I,n){n.r(I),n.d(I,{default:function(){return Fe}});var S=n(15009),s=n.n(S),M=n(99289),g=n.n(M),U=n(1699),L=n(29463),A=n(55681),V=n(78451),K=n(5574),T=n.n(K),N=n(3616),ee=n(24963),O=n(82346);function te(m){return H.apply(this,arguments)}function H(){return H=g()(s()().mark(function m(v){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/app/volume/get-list",{method:"POST",data:v}));case 1:case"end":return a.stop()}},m)})),H.apply(this,arguments)}function ne(m){return b.apply(this,arguments)}function b(){return b=g()(s()().mark(function m(v){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/app/volume/create",{method:"POST",data:v}));case 1:case"end":return a.stop()}},m)})),b.apply(this,arguments)}function re(m){return z.apply(this,arguments)}function z(){return z=g()(s()().mark(function m(v){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,O.request)("/dpanel/api/app/volume/prune",{method:"POST",data:v});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},m)})),z.apply(this,arguments)}function ae(m){return E.apply(this,arguments)}function E(){return E=g()(s()().mark(function m(v){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,O.request)("/dpanel/api/app/volume/delete",{method:"POST",data:v});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},m)})),E.apply(this,arguments)}function le(m){return B.apply(this,arguments)}function B(){return B=g()(s()().mark(function m(v){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,O.request)("/dpanel/api/app/volume/get-detail",{method:"POST",data:v}));case 1:case"end":return a.stop()}},m)})),B.apply(this,arguments)}var f=n(36146),Q=n(184),D=n(5966),W=n(62370),ie=n(86615),oe=n(97462),se=n(17186),ue=n(24739),de=n(83622),J=n(34041),x=n(67294),t=n(85893),ce=(0,x.forwardRef)(function(m,v){var y=(0,x.useState)(!1),a=T()(y,2),F=a[0],R=a[1],h=(0,x.useRef)(),u=(0,x.useContext)(ee.Z),o=u.message,e=new f.Uo("docker");return(0,x.useImperativeHandle)(v,function(){return{}}),(0,t.jsxs)(Q.a,{name:"create",title:e.format("volumeCreateTitle"),drawerProps:{width:N.R_},open:F,onOpenChange:function(r){R(r)},formRef:h,trigger:(0,t.jsx)(de.ZP,{type:"primary",children:e.format("volumeCreateTitle")}),onFinish:function(){var d=g()(s()().mark(function r(i){var l,c,p,w,P,j;return s()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return w=[],i.otherOptions&&i.otherOptions.map(function(q){w.push(q.name+`
`+q.value)}),Z.next=4,ne({name:i.name,driver:"local",type:i.type,nfsUrl:(l=i.nfsUrl)!==null&&l!==void 0?l:"",nfsMountPoint:(c=i.nfsMountPoint)!==null&&c!==void 0?c:"",nfsOptions:(p=i.nfsOptions)!==null&&p!==void 0?p:"",tmpfsOptions:i.tmpfsOptions,otherOptions:w});case 4:if(P=Z.sent,!(P&&P.data&&P.data.info.Name!="")){Z.next=10;break}return o.success(f.FD.format("finish")),m.onFinish&&m.onFinish(),(j=h.current)===null||j===void 0||j.resetFields(),Z.abrupt("return",!0);case 10:case"end":return Z.stop()}},r)}));return function(r){return d.apply(this,arguments)}}(),children:[(0,t.jsx)(D.Z,{label:e.format("volumeCreateFormName"),name:"name",placeholder:e.format("volumeCreateFormNameEmpty")}),(0,t.jsx)(W.Z,{label:e.format("volumeCreateFormDriver"),name:"driver",children:(0,t.jsx)(J.Z,{defaultValue:"local",children:(0,t.jsx)(J.Z.Option,{value:"local",children:"local"})})}),(0,t.jsx)(ie.Z.Group,{name:"type",label:e.format("volumeCreateFormType"),options:e.option("volumeCreateFormTypeOption",["default","tmpfs","nfs","nfs4","other"]),initialValue:"default"}),(0,t.jsx)(oe.Z,{name:["type"],children:function(r){var i=r.type;if(i=="other")return(0,t.jsx)(se.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:e.format("volumeCreateFormTypeOptions")},copyIconProps:!1,min:0,children:(0,t.jsxs)(ue.UW,{children:[(0,t.jsx)(D.Z,{name:"name",label:e.format("volumeCreateFormTypeOtherName")}),(0,t.jsx)(D.Z,{name:"value",label:e.format("volumeCreateFormTypeOtherValue"),placeholder:"/etc/path"})]})});if(i=="nfs"||i=="nfs4")return[(0,t.jsx)(D.Z,{label:e.format("volumeCreateFormTypeNfsUrl"),name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:e.format("volumeCreateFormTypeNfsUrlEmpty")},"nfsUrl"),(0,t.jsx)(D.Z,{label:e.format("volumeCreateFormTypeNfsMountPoint"),name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"/export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,t.jsx)(D.Z,{label:e.format("volumeCreateFormTypeOptions"),name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(i=="tmpfs")return[(0,t.jsx)(D.Z,{label:e.format("volumeCreateFormTypeOptions"),name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),me=ce,X=n(5251),Y=n(38345),C=n(26412),fe=n(60940),G=n(25593),$=n(66309),ve=n(3905),he=(0,x.forwardRef)(function(m,v){var y;(0,x.useImperativeHandle)(v,function(){return{showDetail:function(c){return g()(s()().mark(function p(){var w;return s()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,le({name:c});case 2:w=j.sent,h(!0),d(w.data);case 5:case"end":return j.stop()}},p)}))()}}});var a=(0,x.useState)(!1),F=T()(a,2),R=F[0],h=F[1],u=(0,x.useState)(),o=T()(u,2),e=o[0],d=o[1],r=new f.Uo("docker"),i=(0,x.useRef)();return(0,t.jsxs)(Q.a,{title:r.format("volumeDetailTitle"),open:R,submitter:!1,onOpenChange:function(c){h(c),!c&&d(void 0)},drawerProps:{width:N.R_},children:[(0,t.jsx)(Y.Z,{title:r.format("volumeDetailTitle"),ghost:!0,children:(0,t.jsxs)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,t.jsx)(C.Z.Item,{label:r.format("volumeDetailName"),children:e==null?void 0:e.info.Name}),(0,t.jsx)(C.Z.Item,{label:r.format("volumeDetailCreatedAt"),children:new Date((y=e==null?void 0:e.info.CreatedAt)!==null&&y!==void 0?y:"").toLocaleString()}),(0,t.jsx)(C.Z.Item,{label:r.format("volumeDetailMountpoint"),children:e==null?void 0:e.info.Mountpoint}),(0,t.jsx)(C.Z.Item,{label:r.format("volumeDetailDriver"),children:e==null?void 0:e.info.Driver}),(e==null?void 0:e.info.Labels)&&(0,t.jsx)(C.Z.Item,{label:"Lables",children:(0,t.jsx)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:(e==null?void 0:e.info.Labels)&&Object.keys(e==null?void 0:e.info.Labels).map(function(l){return(0,t.jsx)(C.Z.Item,{label:l,children:e.info.Labels[l]})})})})]})}),(0,t.jsxs)(Y.Z,{title:r.format("volumeDetailUseContainer"),ghost:!0,children:[(0,t.jsx)(ve.Z,{ref:i}),(0,t.jsx)(fe.Z,{rowKey:"Name",columns:[{title:f.FD.format("listContainerName"),dataIndex:"Name",render:function(c,p,w){return(0,t.jsx)(G.Z.Link,{onClick:function(){var j;(j=i.current)===null||j===void 0||j.show(p.Id)},children:(0,X.fi)(p.Name,"/")})}},{title:f.FD.format("listContainerPath"),dataIndex:"Mount"},{title:f.FD.format("listPermission"),render:function(c,p,w){return p.RW?(0,t.jsx)($.Z,{children:f.FD.format("listPermission.read")}):(0,t.jsx)($.Z,{children:f.FD.format("listPermission.write")})}}],dataSource:e==null?void 0:e.inUseContainer,pagination:!1})]})]})}),pe=he,ge=n(36693),xe=n(99611),ye=n(95591),je=n(52645),Ce=n(74453),we=n(97269),k=n(42075),De=n(84567);function Fe(){var m=(0,x.useRef)(),v=(0,x.useRef)(),y=(0,x.useRef)(),a=(0,O.useAccess)(),F=(0,x.useRef)(),R=new f.Uo("docker");return(0,t.jsxs)(Ce._z,{header:{extra:[(0,t.jsx)(U.u,{access:"canSeeDockerVolumeManage",children:(0,t.jsx)(me,{onFinish:function(){var u,o;!((u=m.current)===null||u===void 0)&&u.reloadAndRest&&((o=m.current)===null||o===void 0||o.reloadAndRest())}},"create")},"volumeManage")]},children:[(0,t.jsx)(pe,{ref:v}),(0,t.jsx)(L.Z,{type:"volume",ref:F,onCloseDestroy:!0}),(0,t.jsx)(A.Co,{rowKey:"Name",columns:[{title:f.FD.format("listTitle"),dataIndex:"Name",width:300,render:function(u,o,e,d,r){return(0,t.jsx)(G.Z.Link,{onClick:function(){var l;(l=v.current)===null||l===void 0||l.showDetail(o.Name)},children:(0,t.jsx)(V.Z,{content:o.Name})})}},{title:f.FD.format("listContainerName"),ellipsis:!0,search:!1,render:function(u,o,e,d,r){return o.InUse?(0,t.jsx)(k.Z,{direction:"vertical",children:o.InUse.map(function(i,l){return(0,t.jsx)($.Z,{color:"cyan",icon:(0,t.jsx)(ge.Z,{}),children:(0,X.fi)(i.name,"/")},l)})},e):(0,t.jsx)($.Z,{children:f.FD.format("listNotUse")})}},{title:f.FD.format("listDriver"),ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:f.FD.format("listHostPath"),search:!1,width:250,dataIndex:"Mountpoint",render:function(u,o,e,d,r){return(0,t.jsx)(V.Z,{content:o.Mountpoint})}},{title:f.FD.format("listCreatedAt"),ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(u,o,e,d,r){return new Date(o.CreatedAt).toLocaleString()}}],request:function(){var h=g()(s()().mark(function u(o,e,d){var r,i;return s()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,te({name:o.name});case 2:return r=c.sent,i=[],r.data.inUse?i=r.data.list.map(function(p){return r.data.inUse&&r.data.inUse[p.Name]?p.InUse=r.data.inUse[p.Name]:p.InUse=void 0,p}):i=r.data.list,c.abrupt("return",{data:i,success:!0,total:r.data.list.length});case 6:case"end":return c.stop()}},u)}));return function(u,o,e){return h.apply(this,arguments)}}(),rowSelection:a.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:m,actions:[{key:"view",label:f.FD.format("listManageView"),showInContext:"manage",showInOperator:!0,icon:(0,t.jsx)(xe.Z,{}),action:function(u){return g()(s()().mark(function o(){var e,d,r;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:d=u.finish,r=u.selectedRow,d(!0),(e=v.current)===null||e===void 0||e.showDetail(r.Name);case 3:case"end":return l.stop()}},o)}))()}},{key:"file",label:f.FD.format("listManageFilePath"),showInContext:"manage",showInOperator:!0,icon:(0,t.jsx)(ye.Z,{}),action:function(u){return g()(s()().mark(function o(){var e,d,r;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return d=u.finish,r=u.selectedRow,d(!0),(e=F.current)===null||e===void 0||e.showVolume(r.Name),l.abrupt("return");case 4:case"end":return l.stop()}},o)}))()}},{key:"clear",label:f.FD.format("listManagePrune"),showInQuickToolbar:!0,icon:(0,t.jsx)(je.Z,{}),confirmProps:{description:(0,t.jsx)(we.A,{formRef:y,submitter:!1,children:(0,t.jsxs)(k.Z,{style:{width:280},direction:"vertical",children:[(0,t.jsx)(G.Z.Text,{children:R.format("volumeListManagePruneTip")}),(0,t.jsx)(W.Z,{name:"deleteAll",valuePropName:"checked",children:(0,t.jsx)(De.Z,{children:R.format("volumeListManagePruneNotAnonymous")})})]})})},action:function(u){return g()(s()().mark(function o(){var e,d,r,i;return s()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return r=u.loading,i=u.finish,r(),c.abrupt("return",re({deleteAll:(e=(d=y.current)===null||d===void 0?void 0:d.getFieldValue("deleteAll"))!==null&&e!==void 0?e:!1}).finally(function(){i(!0)}));case 3:case"end":return c.stop()}},o)}))()}},{key:"delete",action:function(u){return g()(s()().mark(function o(){var e,d,r;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return e=u.loading,d=u.finish,r=u.selectedRows,e(),l.abrupt("return",ae({name:r.map(function(c){return c.Name})}).finally(function(){d(!0)}));case 3:case"end":return l.stop()}},o)}))()}}]},"volume-list")]})}}}]);
