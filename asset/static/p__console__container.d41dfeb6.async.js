(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(w,p,t){"use strict";var o=t(5574),u=t.n(o),m=t(67294),r=t(52626),O=t(78267),l=t.n(O),i=t(12323),D=t(87662),g=t(4244),C=t.n(g),T=t(24078),j=t(85893),s,v,_,y,P=(0,m.forwardRef)(function(L,W){var I,A=(0,m.useState)(),S=u()(A,2),U=S[0],B=S[1],R=(0,m.useState)(""),n=u()(R,2),a=n[0],c=n[1];(0,m.useImperativeHandle)(W,function(){return{start:function(M,d){e(),v.fit(),d.width=s.cols,d.height=s.rows;var b=d?Object.keys(d).filter(function(h){return d&&d[h]}).map(function(h){if(d&&d[h])return"".concat(h,"=").concat(d[h])}):[];_=new WebSocket((0,r.R)(M+"?"+b.join("&"))),_.addEventListener("message",function(h){var E=JSON.parse(h.data),K=E.type;if(K==M&&(s.write(E.data),E.data.indexOf("exec failed")!=-1)){e();return}}),y=s.onData(function(h){var E={content:{command:h},type:M};_&&_.send(JSON.stringify(E))}),c(M),B(d)},close:function(){e()},fit:function(){return v.fit(),{width:s.cols,height:s.rows}},run:function(M){U&&M&&M.forEach(function(d){var b={content:{command:d+`
`},type:a};_&&_.send(JSON.stringify(b))})}}}),(0,m.useEffect)(function(){return s=new g.Terminal(i.X),v=new O.FitAddon,s.loadAddon(v),s.open(document.getElementById("terminal-container-console")),v.fit(),(0,D.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(f){f.data&&f.data.fontSize&&Object.assign(s.options,f.data)}),function(){e()}},[]),(0,m.useEffect)(function(){window.addEventListener("resize",function(){v.fit();var f={size:{width:s.cols,height:s.rows},type:a};a&&_&&_.send(JSON.stringify(f))})},[a]);function e(){y&&(s.reset(),v.fit(),s.focus(),y.dispose()),_&&(_.close(),_=null)}return(0,j.jsx)("div",{style:{height:(I=L.height)!==null&&I!==void 0?I:"100vh"},id:"terminal-container-console"})});p.Z=P},12323:function(w,p,t){"use strict";t.d(p,{X:function(){return o},n:function(){return u}});var o={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},u=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},15563:function(w,p,t){"use strict";t.r(p),t.d(p,{default:function(){return g}});var o=t(5574),u=t.n(o),m=t(49610),r=t(13822),O=t(5251),l=t(63713),i=t(67294),D=t(85893);function g(){var C=(0,l.useParams)(),T=(0,l.useSearchParams)(),j=u()(T,2),s=j[0],v=j[1],_=(0,i.useRef)();return(0,i.useEffect)(function(){C.id&&(0,r.jV)({md5:C.id}).then(function(y){var P;window.document.title="".concat((0,O.fi)(y.data.info.Name,"/")," - console"),C.id&&((P=_.current)===null||P===void 0||P.start("/console/container/".concat(y.data.info.Id),{cmd:s.get("cmd"),workDir:s.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,D.jsx)(m.Z,{ref:_})}},13822:function(w,p,t){"use strict";t.d(p,{IE:function(){return C},IW:function(){return D},KK:function(){return y},LJ:function(){return L},RF:function(){return S},Re:function(){return I},aF:function(){return B},eE:function(){return v},jV:function(){return j}});var o=t(5574),u=t.n(o),m=t(15009),r=t.n(m),O=t(99289),l=t.n(O),i=t(63713);function D(n){return g.apply(this,arguments)}function g(){return g=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/status",{method:"POST",data:a}));case 1:case"end":return e.stop()}},n)})),g.apply(this,arguments)}function C(n){return T.apply(this,arguments)}function T(){return T=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/get-list",{data:a,method:"POST"}));case 1:case"end":return e.stop()}},n)})),T.apply(this,arguments)}function j(n){return s.apply(this,arguments)}function s(){return s=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/get-detail",{data:a,method:"POST"}));case 1:case"end":return e.stop()}},n)})),s.apply(this,arguments)}function v(n){return _.apply(this,arguments)}function _(){return _=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/update",{data:a,method:"POST"}));case 1:case"end":return e.stop()}},n)})),_.apply(this,arguments)}function y(){return P.apply(this,arguments)}function P(){return P=l()(r()().mark(function n(){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,i.request)("/dpanel/api/app/container/prune",{method:"POST"}));case 1:case"end":return c.stop()}},n)})),P.apply(this,arguments)}function L(n){return W.apply(this,arguments)}function W(){return W=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.enableExportToPath){e.next=2;break}return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/export",{method:"GET",params:a}));case 2:return e.abrupt("return",new Promise(function(f,M){var d=localStorage.getItem("token"),b=new URLSearchParams;b.append("token",d||""),Object.entries(a).forEach(function(K){var x=u()(K,2),k=x[0],N=x[1];b.append(k,String(N))});var h="/dpanel/api/app/container/export?".concat(b.toString()),E=document.createElement("iframe");E.style.display="none",E.src=h,document.body.appendChild(E),setTimeout(function(){E.parentElement&&document.body.removeChild(E)},5e3),f({code:200,data:"success",error:""})}));case 3:case"end":return e.stop()}},n)})),W.apply(this,arguments)}function I(n){return A.apply(this,arguments)}function A(){return A=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/commit",{method:"POST",data:a}));case 1:case"end":return e.stop()}},n)})),A.apply(this,arguments)}function S(n){return U.apply(this,arguments)}function U(){return U=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/upgrade",{method:"POST",data:a}));case 1:case"end":return e.stop()}},n)})),U.apply(this,arguments)}function B(n){return R.apply(this,arguments)}function R(){return R=l()(r()().mark(function n(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.request)("/dpanel/api/app/container/copy",{method:"POST",data:a}));case 1:case"end":return e.stop()}},n)})),R.apply(this,arguments)}},24078:function(){"use strict"},78267:function(w){(function(p,t){w.exports=t()})(self,()=>(()=>{"use strict";var p={};return(()=>{var t=p;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(o){this._terminal=o}dispose(){}fit(){const o=this.proposeDimensions();if(!o||!this._terminal||isNaN(o.cols)||isNaN(o.rows))return;const u=this._terminal._core;this._terminal.rows===o.rows&&this._terminal.cols===o.cols||(u._renderService.clear(),this._terminal.resize(o.cols,o.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const o=this._terminal._core,u=o._renderService.dimensions;if(u.css.cell.width===0||u.css.cell.height===0)return;const m=this._terminal.options.scrollback===0?0:o.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),O=parseInt(r.getPropertyValue("height")),l=Math.max(0,parseInt(r.getPropertyValue("width"))),i=window.getComputedStyle(this._terminal.element),D=O-(parseInt(i.getPropertyValue("padding-top"))+parseInt(i.getPropertyValue("padding-bottom"))),g=l-(parseInt(i.getPropertyValue("padding-right"))+parseInt(i.getPropertyValue("padding-left")))-m;return{cols:Math.max(2,Math.floor(g/u.css.cell.width)),rows:Math.max(1,Math.floor(D/u.css.cell.height))}}}})(),p})())}}]);
