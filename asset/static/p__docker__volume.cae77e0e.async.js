"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9002],{52645:function(ee,$,r){r.d($,{Z:function(){return H}});var I=r(87462),u=r(67294),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},y=U,A=r(84089),L=function(z,T){return u.createElement(A.Z,(0,I.Z)({},z,{ref:T,icon:y}))},V=u.forwardRef(L),H=V},60415:function(ee,$,r){r.r($),r.d($,{default:function(){return Oe}});var I=r(15009),u=r.n(I),U=r(99289),y=r.n(U),A=r(1699),L=r(29463),V=r(80821),H=r(98510),b=r(78451),z=r(5574),T=r.n(z),W=r(3616),te=r(24963),O=r(82346);function re(i){return E.apply(this,arguments)}function E(){return E=y()(u()().mark(function i(f){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,O.request)("/api/app/volume/get-list",{method:"POST",data:f}));case 1:case"end":return l.stop()}},i)})),E.apply(this,arguments)}function ne(i){return B.apply(this,arguments)}function B(){return B=y()(u()().mark(function i(f){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,O.request)("/api/app/volume/create",{method:"POST",data:f}));case 1:case"end":return l.stop()}},i)})),B.apply(this,arguments)}function ae(i){return G.apply(this,arguments)}function G(){return G=y()(u()().mark(function i(f){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,O.request)("/api/app/volume/prune",{method:"POST",data:f});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),G.apply(this,arguments)}function le(i){return K.apply(this,arguments)}function K(){return K=y()(u()().mark(function i(f){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,O.request)("/api/app/volume/delete",{method:"POST",data:f});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i)})),K.apply(this,arguments)}function oe(i){return Q.apply(this,arguments)}function Q(){return Q=y()(u()().mark(function i(f){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,O.request)("/api/app/volume/get-detail",{method:"POST",data:f}));case 1:case"end":return l.stop()}},i)})),Q.apply(this,arguments)}var c=r(36146),J=r(184),R=r(5966),X=r(62370),ie=r(86615),se=r(97462),ue=r(17186),de=r(24739),ce=r(83622),Y=r(34041),p=r(67294),e=r(85893),me=(0,p.forwardRef)(function(i,f){var g=(0,p.useState)(!1),l=T()(g,2),D=l[0],P=l[1],x=(0,p.useRef)(),d=(0,p.useContext)(te.Z),s=d.message,t=new c.Uo("docker");return(0,p.useImperativeHandle)(f,function(){return{}}),(0,e.jsxs)(J.a,{name:"create",title:t.format("volumeCreateTitle"),drawerProps:{width:W.R_},open:D,onOpenChange:function(o){P(o)},formRef:x,trigger:(0,e.jsx)(ce.ZP,{type:"primary",children:t.format("volumeCreateTitle")}),onFinish:function(){var h=y()(u()().mark(function o(n){var a,m,v,Z,S,j;return u()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return Z=[],n.otherOptions&&n.otherOptions.map(function(_){Z.push(_.name+`
`+_.value)}),F.next=4,ne({name:n.name,driver:"local",type:n.type,nfsUrl:(a=n.nfsUrl)!==null&&a!==void 0?a:"",nfsMountPoint:(m=n.nfsMountPoint)!==null&&m!==void 0?m:"",nfsOptions:(v=n.nfsOptions)!==null&&v!==void 0?v:"",tmpfsOptions:n.tmpfsOptions,otherOptions:Z});case 4:if(S=F.sent,!(S&&S.data&&S.data.info.Name!="")){F.next=10;break}return s.success(c.FD.format("finish")),i.onFinish&&i.onFinish(),(j=x.current)===null||j===void 0||j.resetFields(),F.abrupt("return",!0);case 10:case"end":return F.stop()}},o)}));return function(o){return h.apply(this,arguments)}}(),children:[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormName"),name:"name",placeholder:t.format("volumeCreateFormNameEmpty")}),(0,e.jsx)(X.Z,{label:t.format("volumeCreateFormDriver"),name:"driver",children:(0,e.jsx)(Y.Z,{defaultValue:"local",children:(0,e.jsx)(Y.Z.Option,{value:"local",children:"local"})})}),(0,e.jsx)(ie.Z.Group,{name:"type",label:t.format("volumeCreateFormType"),options:t.option("volumeCreateFormTypeOption",["default","tmpfs","nfs","nfs4","other"]),initialValue:"default"}),(0,e.jsx)(se.Z,{name:["type"],children:function(o){var n=o.type;if(n=="other")return(0,e.jsx)(ue.u,{name:"otherOptions",creatorButtonProps:{creatorButtonText:t.format("volumeCreateFormTypeOptions")},copyIconProps:!1,min:0,children:(0,e.jsxs)(de.UW,{children:[(0,e.jsx)(R.Z,{name:"name",label:t.format("volumeCreateFormTypeOtherName")}),(0,e.jsx)(R.Z,{name:"value",label:t.format("volumeCreateFormTypeOtherValue"),placeholder:"/etc/path"})]})});if(n=="nfs"||n=="nfs4")return[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeNfsUrl"),name:"nfsUrl",required:!0,rules:[{required:!0}],placeholder:t.format("volumeCreateFormTypeNfsUrlEmpty")},"nfsUrl"),(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeNfsMountPoint"),name:"nfsMountPoint",required:!0,rules:[{required:!0}],placeholder:"/export/share, :/export/share, /share or :/share"},"nfsMountPoint"),(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeOptions"),name:"nfsOptions",initialValue:"rw,noatime,rsize=8192,wsize=8192,tcp,timeo=14"},"nfsOptions")];if(n=="tmpfs")return[(0,e.jsx)(R.Z,{label:t.format("volumeCreateFormTypeOptions"),name:"tmpfsOptions",initialValue:"size=100m,uid=1000"},"tmpfsOptions")]}})]})}),fe=me,k=r(5251),q=r(38345),C=r(26412),ve=r(60940),w=r(25593),N=r(66309),he=r(83399),pe=(0,p.forwardRef)(function(i,f){var g;(0,p.useImperativeHandle)(f,function(){return{showDetail:function(m){return y()(u()().mark(function v(){var Z;return u()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,oe({name:m});case 2:Z=j.sent,x(!0),h(Z.data);case 5:case"end":return j.stop()}},v)}))()}}});var l=(0,p.useState)(!1),D=T()(l,2),P=D[0],x=D[1],d=(0,p.useState)(),s=T()(d,2),t=s[0],h=s[1],o=new c.Uo("docker"),n=(0,p.useRef)();return(0,e.jsxs)(J.a,{title:o.format("volumeDetailTitle"),open:P,submitter:!1,onOpenChange:function(m){x(m),!m&&h(void 0)},drawerProps:{width:W.R_},children:[(0,e.jsx)(q.Z,{title:o.format("volumeDetailTitle"),ghost:!0,children:(0,e.jsxs)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:[(0,e.jsx)(C.Z.Item,{label:o.format("volumeDetailName"),children:t==null?void 0:t.info.Name}),(0,e.jsx)(C.Z.Item,{label:o.format("volumeDetailCreatedAt"),children:new Date((g=t==null?void 0:t.info.CreatedAt)!==null&&g!==void 0?g:"").toLocaleString()}),(0,e.jsx)(C.Z.Item,{label:o.format("volumeDetailMountpoint"),children:t==null?void 0:t.info.Mountpoint}),(0,e.jsx)(C.Z.Item,{label:o.format("volumeDetailDriver"),children:t==null?void 0:t.info.Driver}),(t==null?void 0:t.info.Labels)&&(0,e.jsx)(C.Z.Item,{label:"Lables",children:(0,e.jsx)(C.Z,{styles:{label:{width:150}},column:1,bordered:!0,children:(t==null?void 0:t.info.Labels)&&Object.keys(t==null?void 0:t.info.Labels).map(function(a){return(0,e.jsx)(C.Z.Item,{label:a,children:t.info.Labels[a]})})})})]})}),(0,e.jsxs)(q.Z,{title:o.format("volumeDetailUseContainer"),ghost:!0,children:[(0,e.jsx)(he.Z,{ref:n}),(0,e.jsx)(ve.Z,{rowKey:"Name",columns:[{title:c.FD.format("listContainerName"),dataIndex:"Name",render:function(m,v,Z){return(0,e.jsx)(w.Z.Link,{onClick:function(){var j;(j=n.current)===null||j===void 0||j.show(v.Id)},children:(0,k.fi)(v.Name,"/")})}},{title:c.FD.format("listContainerPath"),dataIndex:"Mount"},{title:c.FD.format("listPermission"),render:function(m,v,Z){return v.RW?(0,e.jsx)(N.Z,{children:c.FD.format("listPermission.read")}):(0,e.jsx)(N.Z,{children:c.FD.format("listPermission.write")})}}],dataSource:t==null?void 0:t.inUseContainer,pagination:!1})]})]})}),xe=pe,ge=r(36693),je=r(95591),ye=r(52645),Ce=r(82061),Ze=r(74453),Re=r(97269),M=r(42075),De=r(96074),Fe=r(84567);function Oe(){var i=(0,p.useRef)(),f=(0,p.useRef)(),g=(0,p.useRef)(),l=(0,O.useAccess)(),D=(0,p.useRef)(),P=new c.Uo("docker");return(0,e.jsxs)(Ze._z,{header:{extra:[(0,e.jsx)(A.u,{access:"canSeeDockerVolumeManage",children:(0,e.jsx)(fe,{onFinish:function(){var d,s;!((d=i.current)===null||d===void 0)&&d.reloadAndRest&&((s=i.current)===null||s===void 0||s.reloadAndRest())}},"create")},"volumeManage")]},children:[(0,e.jsx)(xe,{ref:f}),(0,e.jsx)(L.Z,{type:"volume",ref:D,onCloseDestroy:!0}),(0,e.jsx)(H.C,{rowKey:"Name",columns:[{title:c.FD.format("listTitle"),dataIndex:"Name",width:300,render:function(d,s,t,h,o){return(0,e.jsx)(w.Z.Link,{onClick:function(){var a;(a=f.current)===null||a===void 0||a.showDetail(s.Name)},children:(0,e.jsx)(b.Z,{content:s.Name})})}},{title:c.FD.format("listContainerName"),ellipsis:!0,search:!1,render:function(d,s,t,h,o){return s.InUse?(0,e.jsx)(M.Z,{direction:"vertical",children:s.InUse.map(function(n,a){return(0,e.jsx)(N.Z,{color:"cyan",icon:(0,e.jsx)(ge.Z,{}),children:(0,k.fi)(n.name,"/")},a)})},t):(0,e.jsx)(N.Z,{children:c.FD.format("listNotUse")})}},{title:c.FD.format("listDriver"),ellipsis:!0,width:80,search:!1,dataIndex:"Driver"},{title:c.FD.format("listHostPath"),search:!1,width:250,dataIndex:"Mountpoint",render:function(d,s,t,h,o){return(0,e.jsx)(b.Z,{content:s.Mountpoint})}},{title:c.FD.format("listCreatedAt"),ellipsis:!0,width:200,search:!1,dataIndex:"CreatedAt",render:function(d,s,t,h,o){return new Date(s.CreatedAt).toLocaleString()}},{title:c.FD.format("listManage"),width:100,search:!1,fixed:"right",hidden:!l.canSeeDockerVolumeManage,render:function(d,s,t,h,o){return(0,e.jsx)(M.Z,{split:(0,e.jsx)(De.Z,{type:"vertical"}),children:(0,e.jsx)(w.Z.Link,{onClick:function(){var a;(a=D.current)===null||a===void 0||a.showVolume(s.Name)},children:(0,e.jsx)(je.Z,{})})})}}],request:function(){var x=y()(u()().mark(function d(s,t,h){var o,n;return u()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,re({name:s.name});case 2:return o=m.sent,n=[],o.data.inUse?n=o.data.list.map(function(v){return o.data.inUse&&o.data.inUse[v.Name]?v.InUse=o.data.inUse[v.Name]:v.InUse=void 0,v}):n=o.data.list,m.abrupt("return",{data:n,success:!0,total:o.data.list.length});case 6:case"end":return m.stop()}},d)}));return function(d,s,t){return x.apply(this,arguments)}}(),rowSelection:l.canSeeDockerVolumeManage?{defaultSelectedRowKeys:[],alwaysShowAlert:!0}:void 0,actionRef:i,quickToolbarRender:function(d){var s=d.selectedRows,t=d.finish,h=d.loading;return(0,e.jsxs)(M.Z,{size:16,children:[(0,e.jsx)(V.Z,{action:function(){var n,a;return h(),ae({deleteAll:(n=(a=g.current)===null||a===void 0?void 0:a.getFieldValue("deleteAll"))!==null&&n!==void 0?n:!1}).finally(function(){t(!0)})},buttonProps:{icon:(0,e.jsx)(ye.Z,{})},onSuccess:function(){var n,a;return!((n=i.current)===null||n===void 0)&&n.reloadAndRest&&((a=i.current)===null||a===void 0||a.reloadAndRest()),!0},onError:function(){var n,a;return!((n=i.current)===null||n===void 0)&&n.reset&&((a=i.current)===null||a===void 0||a.reset()),!0},confirmProps:{description:(0,e.jsx)(Re.A,{formRef:g,submitter:!1,children:(0,e.jsxs)(M.Z,{style:{width:280},direction:"vertical",children:[(0,e.jsx)(w.Z.Text,{children:P.format("volumeListManagePruneTip")}),(0,e.jsx)(X.Z,{name:"deleteAll",valuePropName:"checked",children:(0,e.jsx)(Fe.Z,{children:P.format("volumeListManagePruneNotAnonymous")})})]})})},children:c.FD.format("listManagePrune")},"clear"),(0,e.jsx)(V.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,e.jsx)(Ce.Z,{})},confirmProps:{showCommonConfirm:!0},action:function(){return h(),le({name:s.map(function(n){return n.Name})}).finally(function(){t(!0)})},onSuccess:function(){var n,a;return!((n=i.current)===null||n===void 0)&&n.reloadAndRest&&((a=i.current)===null||a===void 0||a.reloadAndRest()),!0},onError:function(){var n,a;return!((n=i.current)===null||n===void 0)&&n.reset&&((a=i.current)===null||a===void 0||a.reset()),!0},children:c.FD.format("listManageDeleteBatch")})]})}},"volume-list")]})}}}]);
