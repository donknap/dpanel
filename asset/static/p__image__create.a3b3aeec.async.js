"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7523],{75544:function(ne,x,e){var W=e(5574),i=e.n(W),K=e(12323),s=e(78267),f=e.n(s),u=e(75458),O=e.n(u),P=e(67294),E=e(4244),A=e.n(E),y=e(24078),M=e(85893),T,w,n,I=(0,P.forwardRef)(function(l,L){var _,de=(0,P.useState)(!0),Y=i()(de,2),S=Y[0],ie=Y[1];return(0,P.useEffect)(function(){return T=new E.Terminal(K.X),w=new u.SearchAddon,n=new s.FitAddon,window.addEventListener("resize",function(){l.showInModal||n.fit()}),l.style&&l.style.fontSize&&(T.options.fontSize=l.style.fontSize),T.loadAddon(n),T.loadAddon(w),T.open(document.getElementById(l.id?l.id:"terminal-container")),l.showInModal||n.fit(),function(){T.reset(),ie(!0)}},[]),(0,P.useImperativeHandle)(L,function(){return{write:function(R){S&&(n.fit(),ie(!1)),T.write(R)},clear:function(){T.clear()},getTerminal:function(){return T},findNext:function(R){w.findNext(R)},findPrev:function(R){w.findPrevious(R)},fit:function(){n.fit()},onData:function(R){return T.onData(R)}}}),(0,M.jsx)("div",{id:l.id?l.id:"terminal-container",style:{width:l.width?l.width:"100%",height:l.height?l.height:"500px",marginTop:(_=l.style)===null||_===void 0?void 0:_.marginTop}})});x.Z=I},94359:function(ne,x,e){e.d(x,{Z:function(){return I}});var W=e(5574),i=e.n(W),K=e(3089),s=e(98165),f=e(18429),u=e(8751),O=e(66212),P=e(14313),E=e(30159),A=e(87740),y=e(50888),M=e(66309),T=e(83062),w=e(36146),n=e(85893);function I(l){var L,_,de=new w.Uo("components.containerStatus"),Y=l.status.split("."),S=i()(Y,2),ie=S[0],h=S[1],R="";R=de.format(l.status,(L=l.statusValue)!==null&&L!==void 0?L:{});var t=(0,n.jsx)(n.Fragment,{});return h=="0"&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(K.Z,{}),color:"default",children:R})),h=="10"&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(s.Z,{spin:!0}),color:"processing",children:R})),h=="20"&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(f.Z,{}),color:"error",children:R})),h=="30"&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(u.Z,{}),color:"success",children:R})),h=="new"&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(O.Z,{}),children:R})),(h=="running"||h=="healthy"||h=="active"||h=="ready")&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(P.Z,{}),color:"success",children:R})),(h=="paused"||h=="pause"||h=="rollback_paused")&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(E.Z,{}),color:"warning",children:R})),(h=="waiting"||h=="starting"||h=="accepted")&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(A.Z,{}),children:R})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(h)&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(y.Z,{}),color:"processing",children:R})),(h=="error"||h=="down"||h=="failed")&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(f.Z,{}),color:"error",children:R})),["complete","completed","rollback_completed"].includes(h)&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(u.Z,{}),color:"success",children:R})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(h)&&(t=(0,n.jsx)(M.Z,{icon:(0,n.jsx)(f.Z,{}),color:"warning",children:R})),(0,n.jsx)(T.Z,{placement:"top",title:(_=l.tip)!==null&&_!==void 0?_:"",children:t})}},78451:function(ne,x,e){e.d(x,{Z:function(){return K}});var W=e(67294),i=e(85893);function K(s){var f;return(0,i.jsx)("span",{style:{width:s.width?s.width:"auto",wordBreak:"break-word"},children:(f=s.content)!==null&&f!==void 0?f:s.children})}},51100:function(ne,x,e){e.d(x,{Z:function(){return f}});var W=e(4813),i=e(91604),K=e(1677),s=e(85893);function f(u){return u.showDragger?(0,s.jsx)(i.Z,{max:u.max?u.max:1,title:u.title,label:u.label,required:u.required,rules:[{required:u.required}],fieldProps:{multiple:!!(u.max&&u.max>1),name:"file",accept:u.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(P){return new Promise(function(E){var A;(0,W._)({path:(A=P.response.data.path)!==null&&A!==void 0?A:""}).then(function(y){E(!0)})})},onChange:function(P){P.file.status=="done"&&u.onFinish&&u.onFinish(P.fileList)}},name:u.name}):(0,s.jsx)(K.Z,{max:u.max?u.max:1,title:u.title,label:u.label,required:u.required,rules:[{required:u.required}],fieldProps:{multiple:!!(u.max&&u.max>1),name:"file",accept:u.accept,action:"/dpanel/api/common/attach/upload",headers:{Authorization:"Bearer "+localStorage.getItem("token")},onRemove:function(P){return new Promise(function(E){var A;(0,W._)({path:(A=P.response.data.path)!==null&&A!==void 0?A:""}).then(function(y){E(!0)})})},onChange:function(P){P.file.status=="done"&&u.onFinish&&u.onFinish(P.fileList)}},name:u.name})}},12323:function(ne,x,e){e.d(x,{X:function(){return W},n:function(){return i}});var W={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},i=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},65913:function(ne,x,e){var W=e(5574),i=e.n(W),K=e(74330),s=e(67294),f=e(85893),u=(0,s.forwardRef)(function(O,P){(0,s.useImperativeHandle)(P,function(){return{show:function(){M(!0)},destroy:function(){M(!1)}}});var E=(0,s.useState)(!1),A=i()(E,2),y=A[0],M=A[1];return(0,f.jsx)(K.Z,{spinning:y,size:"default",children:O.children})});x.Z=u},99430:function(ne,x,e){e.r(x),e.d(x,{default:function(){return ze}});var W=e(97857),i=e.n(W),K=e(15009),s=e.n(K),f=e(99289),u=e.n(f),O=e(74453),P=e(25593),E=e(97841),A=e(94359),y=e(99611),M=e(86548),T=e(87740),w=e(82061),n=e(67294),I=e(5574),l=e.n(I),L=e(38345),_=e(82346),de=e(75544),Y=e(3616),S=e(36146),ie=e(85265),h=e(74330),R=e(38703),t=e(85893),$=(0,n.forwardRef)(function(k,le){var m=(0,_.useModel)("subscriber"),N=(0,n.useRef)(),F=(0,n.useState)(!1),o=l()(F,2),c=o[0],p=o[1],D=(0,n.useState)(""),b=l()(D,2),g=b[0],j=b[1],J=(0,n.useState)(0),B=l()(J,2),Q=B[0],V=B[1];return(0,n.useImperativeHandle)(le,function(){return{start:function(){for(var v=arguments.length,r=new Array(v),d=0;d<v;d++)r[d]=arguments[d];var H=r.join(":");p(!0),V(0),j(H),m.addDataHandler("image:"+H,function(U){var q;if(U.data.includes("Step")){var ee=Array.from(U.data.matchAll(/Step\s+(\d+)\/(\d+)/g));if(ee.length>0){var se=ee[ee.length-1],G=parseInt(se[1],10),te=parseInt(se[2],10);if(te>0&&G>=1&&G<=te){var ae=G/te*100;V(Math.round(ae))}}}(q=N.current)===null||q===void 0||q.write(U.data)})},close:function(){var v;(v=N.current)===null||v===void 0||v.clear(),p(!1)},error:function(){V(-100)},show:function(v){p(!0),setTimeout(function(){var r,d;(r=N.current)===null||r===void 0||r.clear(),(d=N.current)===null||d===void 0||d.write(v)},500)}}}),(0,t.jsx)(ie.Z,{width:Y.ob,destroyOnHidden:!0,title:S.FD.format("listLog"),afterOpenChange:function(v){if(v){var r,d;(r=N.current)===null||r===void 0||r.clear(),(d=N.current)===null||d===void 0||d.fit()}},onClose:function(){m.progress.close("image:"+g),p(!1),V(0),j(""),k.onFinish&&k.onFinish()},open:c,children:(0,t.jsx)(L.Z,{ghost:!0,children:(0,t.jsxs)(h.Z,{spinning:Q==0,children:[(0,t.jsx)(R.Z,{strokeLinecap:"butt",status:Q<0?"exception":"normal",percent:Math.abs(Q),size:["100%",10],percentPosition:{align:"center",type:"inner"},format:function(){return null}}),(0,t.jsx)(de.Z,{style:{fontSize:12},height:"85vh",ref:N})]})})})}),X=$,a=e(19632),pe=e.n(a),Me=e(91058),Ee=e(11106),be=e(62370),ge=e(12491);function je(k){var le=new S.Uo("image");return(0,t.jsx)(be.Z,{shouldUpdate:!0,children:function(N){var F=N.getFieldValue,o=N.setFieldValue;return[(0,t.jsx)(be.Z,{name:k.name,hidden:!0},"input"),(0,t.jsx)(ge.Z,{title:le.format("formBuildDockerfileContent"),onImport:function(p){return o(k.name,p),!0},onLoad:function(p){if(p.indexOf("FROM ")<0)throw new Error(S.FD.format("commonFileIncorrectFormat",{name:"Dockerfile"}));return!0}},"importFile"),(0,t.jsx)(Ee.ZP,{value:F("buildDockerfileContent"),onChange:function(p){o(k.name,p)},height:"600px",theme:"dark",style:{marginBottom:"20px"}},"codeMirror")]}})}var he=e(51100),Te=e(75870),re=e(5966),ye=e(24739),Ce=e(64317),we=e(86615),$e=e(97462),Re=e(90672),Be=e(83622),Ue=e(83062),Ie=e(42075),xe=e(27166),Ae=e(47837),Le=e(48399),Ze=e(73813),We=e(68297),Se=e(24963),Ke=(0,n.forwardRef)(function(k,le){var m=new S.Uo("image"),N=(0,n.useContext)(Se.Z),F=N.message,o=(0,n.useRef)(),c=(0,n.useRef)(),p=(0,n.useState)(!1),D=l()(p,2),b=D[0],g=D[1],j=(0,n.useRef)(),J=(0,n.useState)(""),B=l()(J,2),Q=B[0],V=B[1];return(0,n.useImperativeHandle)(le,function(){return{show:function(v){return u()(s()().mark(function r(){var d,H,U,q,ee,se,G,te,ae,ce,ue,me,fe,z,_e,C,oe,ve,Oe;return s()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return g(!0),(d=j.current)===null||d===void 0||d.loading(),Pe.next=4,(0,E.Xr)({id:v}).finally(function(){var De;(De=j.current)===null||De===void 0||De.finish()});case 4:z=Pe.sent,(H=z.data.detail.setting)!==null&&H!==void 0&&H.buildGit&&(ve=z.data.detail.setting.buildGit,ve.includes("#")?(Oe=(0,Ae.Z)(ve,"#"),_e=ve.slice(0,Oe),C=ve.slice(Oe+1)):_e=ve,C&&C.includes(":")&&(C=C.slice(0,(0,Le.Z)(C,":"))),_e.includes("@")&&(oe=new URL(_e),oe&&(_e="".concat(oe.origin).concat(oe.pathname)))),(U=c.current)===null||U===void 0||U.setFieldsValue({id:z.data.detail.id,title:z.data.detail.title,imageTag:(q=z.data.detail.setting)===null||q===void 0?void 0:q.tag,imageRegistry:(ee=z.data.detail.setting)===null||ee===void 0?void 0:ee.registry,buildType:(se=z.data.detail.setting)===null||se===void 0?void 0:se.buildType,buildDockerfileRoot:(G=z.data.detail.setting)===null||G===void 0?void 0:G.buildDockerfileRoot,buildDockerfileContent:(te=z.data.detail.setting)===null||te===void 0?void 0:te.buildDockerfileContent,buildDockerfileName:(ae=z.data.detail.setting)===null||ae===void 0?void 0:ae.buildDockerfileName,buildGit:_e,buildGitBranch:C,buildGitUsername:(ce=oe)===null||ce===void 0?void 0:ce.username,buildGitPassword:(ue=oe)===null||ue===void 0?void 0:ue.password,buildArgs:(me=z.data.detail.setting)===null||me===void 0?void 0:me.buildArgs,platform:(fe=z.data.detail.setting)===null||fe===void 0?void 0:fe.platform});case 7:case"end":return Pe.stop()}},r)}))()}}}),(0,t.jsx)(xe.Z,{drawerProps:{width:Y.R_},ref:j,title:S.Ob.format("image.create"),open:b,onOpenChange:function(v){if(g(v),!v){var r;(r=c.current)===null||r===void 0||r.resetFields(),k.onFinish&&k.onFinish()}},trigger:(0,t.jsx)(Be.ZP,{type:"primary",children:S.Ob.format("image.create")},"create"),onFinish:function(){var Z=u()(s()().mark(function v(r){var d,H,U,q,ee,se,G,te,ae,ce,ue,me,fe,z;return s()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(H=(d=r.buildType)!==null&&d!==void 0?d:"dockerfile",H!="containerTar"){C.next=7;break}return C.next=4,(0,Ze.Ck)({tag:r.imageTag,registry:r.imageRegistry,tar:(U=r.containerTar[0].response.data.path)!==null&&U!==void 0?U:"",cmd:r.cmd,workDir:r.workDir,expose:r.expose?r.expose.split(`
`):[],env:r.env?r.env.split(`
`):[],volume:r.volume?r.volume.split(`
`):[]});case 4:return C.abrupt("return",!0);case 7:return se={name:"",arch:""},We.ii.map(function(oe){oe.name==r.platform&&(se=oe)}),G={id:r.id?parseInt(r.id):0,tag:r.imageTag,title:r.title,registry:r.imageRegistry,buildDockerfileContent:r.buildDockerfileContent,buildDockerfileRoot:r.buildDockerfileRoot,buildDockerfileName:r.buildDockerfileName,buildZip:"",buildGit:r.buildGit,buildType:r.buildType,buildArgs:r.buildArgs},r.buildZip&&r.buildZip.length>0&&(G.buildZip=(te=r.buildZip[0].response.data.path)!==null&&te!==void 0?te:""),H=="git"&&(G.buildGit=G.buildGit+"#"+(r.buildGitBranch||"master"),r.buildDockerfileRoot&&r.buildDockerfileRoot!=""&&(G.buildGit="".concat(G.buildGit,":").concat(r.buildDockerfileRoot)),r.buildGitUsername&&r.buildGitPassword&&(ae="https://",G.buildGit.includes("http://")&&(ae="http://"),G.buildGit="".concat(G.buildGit.replace(ae,"".concat(ae).concat(r.buildGitUsername,":").concat(r.buildGitPassword,"@"))))),(q=o.current)===null||q===void 0||q.start("build",((ee=G.id)!==null&&ee!==void 0?ee:0).toString()),V(""),C.prev=14,C.next=17,(0,E.l9)(G);case 17:if(ue=C.sent,ue.data.id&&((me=c.current)===null||me===void 0||me.setFieldValue("id",ue.data.id)),!ue.data.error){C.next=23;break}return V(ue.data.error),(fe=o.current)===null||fe===void 0||fe.error(),C.abrupt("return");case 23:return F.success(S.FD.format("finish")),(ce=o.current)===null||ce===void 0||ce.close(),C.abrupt("return",!0);case 28:return C.prev=28,C.t0=C.catch(14),V(String(C.t0)),(z=o.current)===null||z===void 0||z.error(),C.abrupt("return",!1);case 33:case"end":return C.stop()}},v,null,[[14,28]])}));return function(v){return Z.apply(this,arguments)}}(),formRef:c,children:(0,t.jsxs)(L.Z,{direction:"column",ghost:!0,gutter:[0,10],children:[(0,t.jsxs)(L.Z,{ghost:!0,children:[(0,t.jsx)(be.Z,{name:"id",hidden:!0}),(0,t.jsx)(re.Z,{width:"lg",label:m.format("formTitle"),name:"title"}),(0,t.jsxs)(ye.UW,{children:[(0,t.jsx)(Ce.Z,{width:"lg",label:m.format("formImageRegistry"),tooltip:m.format("formImageRegistryTip"),name:"imageRegistry",request:u()(s()().mark(function Z(){var v;return s()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,Te.Ot)();case 2:return v=d.sent,d.abrupt("return",v.data.list.map(function(H){return{value:H.serverAddress,label:H.title+"("+H.serverAddress+")"}}));case 4:case"end":return d.stop()}},Z)}))}),(0,t.jsx)(re.Z,{rules:[{required:!0}],width:"lg",required:!0,tooltip:m.format("formImageTagTip"),placeholder:m.format("formImageTagEmpty"),label:m.format("formImageTag"),name:"imageTag"})]}),(0,t.jsx)(we.Z.Group,{name:"buildType",initialValue:"dockerfile",label:m.format("formBuildType"),options:m.option("formBuildTypeOption",["dockerfile","zip","git","containerTar"]).map(function(Z){return{label:(0,t.jsx)(Ue.Z,{title:m.format("formBuildTypeTipOption."+Z.value),children:Z.label}),value:Z.value}})}),(0,t.jsx)($e.Z,{name:["buildType"],children:function(v){var r=v.buildType,d=[];return r=="containerTar"?d=[(0,t.jsx)(re.Z,{tooltip:m.format("formWorkDirTip"),label:m.format("formWorkDir"),name:"workDir",placeholder:m.format("formWorkDirEmpty")},"workDir"),(0,t.jsx)(re.Z,{required:!0,tooltip:m.format("formCmdTip"),rules:[{required:!0}],label:"CMD",name:"cmd"},"cmd"),(0,t.jsx)(Re.Z,{tooltip:m.format("formExposeTip"),label:m.format("formExpose"),name:"expose",placeholder:`80 
9000`},"expose"),(0,t.jsx)(Re.Z,{tooltip:m.format("formEnvTip"),label:m.format("formEnv"),name:"env",placeholder:`TEST_VALUE=123 
TEST_NO_VALUE=`},"env"),(0,t.jsx)(Re.Z,{tooltip:m.format("formVolumeTip"),label:m.format("formVolume"),name:"volume",placeholder:`/app 
/home`},"volume")]:(r=="zip"||r=="git")&&(d=[(0,t.jsxs)(ye.UW,{children:[(0,t.jsx)(re.Z,{width:"lg",name:"buildDockerfileRoot",label:m.format("formBuildDockerfileRoot"),fieldProps:{addonBefore:"/"},placeholder:m.format("formBuildDockerfileRootEmpty")},"buildDockerfileRoot"),(0,t.jsx)(re.Z,{width:"lg",name:"buildDockerfileName",label:m.format("formBuildDockerfileName"),placeholder:m.format("formBuildDockerfileNameEmpty")},"dockerfileName")]},"buildRoot"),(0,t.jsx)(Me.Z,{drawerProps:{ghost:!0},name:"buildArgs",showAddButton:!0,showCodeMode:!0,listLabel:m.format("formBuildArgs")},"env")]),r=="zip"&&(d=[].concat(pe()(d),[(0,t.jsx)(he.Z,{required:!0,label:m.format("formBuildZip"),name:"buildZip",accept:".zip"},"buildZip")])),r=="containerTar"&&(d=[].concat(pe()(d),[(0,t.jsx)(he.Z,{required:!0,label:m.format("formBuildContainerTar"),name:"containerTar",accept:".tar"},"containerTar")])),r=="git"&&(d=[].concat(pe()(d),[(0,t.jsxs)(ye.UW,{children:[(0,t.jsxs)(Ie.Z.Compact,{block:!0,children:[(0,t.jsx)(re.Z,{width:"md",label:m.format("formBuildGitUsername"),name:"buildGitUsername",placeholder:m.format("formBuildGitUsernameEmpty")}),(0,t.jsx)(re.Z,{width:"md",label:m.format("formBuildGitPassword"),name:"buildGitPassword"})]}),(0,t.jsxs)(Ie.Z.Compact,{block:!0,children:[(0,t.jsx)(re.Z,{label:m.format("formBuildGitBranch"),width:"md",name:"buildGitBranch"}),(0,t.jsx)(re.Z,{fieldProps:{min:2,max:255},rules:[{required:!0}],width:"lg",required:!0,placeholder:m.format("formBuildGitEmpty"),label:m.format("formBuildGit"),name:"buildGit"})]})]},"buildGit")])),r=="dockerfile"&&(d=[].concat(pe()(d),[(0,t.jsx)(je,{name:"buildDockerfileContent"},"buildDockerfileContent")])),d}})]}),(0,t.jsx)(X,{onFinish:function(){if(Q&&Q!=""){var v;(v=c.current)===null||v===void 0||v.resetFields(["buildZip"])}else g(!1),k.onFinish&&k.onFinish()},ref:o})]})})}),Fe=Ke,Ge=e(55681),ke=e(1584);function ze(){var k=(0,n.useRef)(),le=(0,n.useRef)(),m=(0,n.useRef)(),N=(0,n.useRef)();return(0,t.jsxs)(O._z,{header:{extra:[(0,t.jsx)(Fe,{ref:m,onFinish:function(){var o;!((o=k.current)===null||o===void 0)&&o.reloadAndRest&&k.current.reloadAndRest()}},"create")]},children:[(0,t.jsx)(ke.Z,{ref:N}),(0,t.jsx)(Ge.Co,{actionRef:k,rowKey:"id",actions:[{key:"view",label:S.FD.format("listManageView"),buttonProps:{icon:(0,t.jsx)(y.Z,{})},action:function(o){return u()(s()().mark(function c(){var p,D,b,g,j;return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:g=o.selectedRow,j=o.finish,j(!0),!((p=g.setting)===null||p===void 0)&&p.imageId&&((D=N.current)===null||D===void 0||D.show((b=g.setting)===null||b===void 0?void 0:b.imageId));case 3:case"end":return B.stop()}},c)}))()},disable:function(o){var c,p=o.isMultiple,D=o.selectedRow;return p()||(D==null||(c=D.setting)===null||c===void 0?void 0:c.imageId)==""},showInContext:"manage",showInOperator:!0},{key:"edit",label:S.FD.format("listManageEdit"),buttonProps:{icon:(0,t.jsx)(M.Z,{})},action:function(o){return u()(s()().mark(function c(){var p,D,b;return s()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:D=o.finish,b=o.selectedRow,D(!0),b.id&&((p=m.current)===null||p===void 0||p.show(b.id));case 3:case"end":return j.stop()}},c)}))()},showInContext:"manage",showInOperator:!0,disable:function(o){return o.isMultiple()}},{key:"build",label:S.FD.format("listManageBuild"),buttonProps:{icon:(0,t.jsx)(T.Z,{})},showInContext:"manage",showInOperator:!0,action:function(o){return u()(s()().mark(function c(){var p,D,b,g,j,J,B,Q,V,Z,v,r,d;return s()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return b=o.loading,g=o.selectedRow,j=o.finish,b(),(p=le.current)===null||p===void 0||p.start("build",((D=g.id)!==null&&D!==void 0?D:0).toString()),U.prev=3,U.next=6,(0,E.l9)(i()(i()({id:g.id,title:g.title},g.setting),{},{buildDockerfileContent:((J=g.setting)===null||J===void 0?void 0:J.buildDockerfileContent)||((B=g.setting)===null||B===void 0?void 0:B.buildDockerfile),buildDockerfileRoot:((Q=g.setting)===null||Q===void 0?void 0:Q.buildDockerfileRoot)||((V=g.setting)===null||V===void 0?void 0:V.buildRoot),buildType:((Z=g.setting)===null||Z===void 0?void 0:Z.buildType)||g.buildType,tag:((v=g.setting)===null||v===void 0?void 0:v.tag)||g.tag}));case 6:return r=U.sent,U.abrupt("return",!0);case 10:U.prev=10,U.t0=U.catch(3),(d=le.current)===null||d===void 0||d.error();case 13:return U.prev=13,j(!0),U.finish(13);case 16:case"end":return U.stop()}},c,null,[[3,10,13,16]])}))()},disable:function(o){return o.isMultiple()}},{key:"delete",label:S.FD.format("listManageDelete"),buttonProps:{danger:!0,type:"primary",icon:(0,t.jsx)(w.Z,{})},confirmProps:{showCommonConfirm:!0},showInContext:!0,showInQuickToolbar:!0,action:function(o){return u()(s()().mark(function c(){var p,D,b;return s()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return p=o.selectedRows,D=o.finish,b=o.loading,b(),j.abrupt("return",(0,E.hf)({id:p.map(function(J){return J.id})}).finally(function(){D(!0)}));case 3:case"end":return j.stop()}},c)}))()}}],columns:[{title:S.FD.format("listTitle"),render:function(o,c,p,D){return c.title}},{title:S.FD.format("listImageName"),dataIndex:"tag",search:!1,render:function(o,c,p,D){var b,g,j;return(0,t.jsx)(P.Z.Link,{type:!((b=c.setting)!==null&&b!==void 0&&b.imageId)||c.setting.imageId==""?"secondary":void 0,onClick:function(){var B,Q,V;!((B=c.setting)===null||B===void 0)&&B.imageId&&((Q=N.current)===null||Q===void 0||Q.show((V=c.setting)===null||V===void 0?void 0:V.imageId))},children:(g=(j=c.setting)===null||j===void 0?void 0:j.tag)!==null&&g!==void 0?g:c.tag})}},{title:S.FD.format("listStatus"),width:150,ellipsis:!0,search:!1,render:function(o,c,p,D){var b;return(b=c.setting)!==null&&b!==void 0&&b.imageId||(c.status=0),[(0,t.jsx)("div",{children:(0,t.jsx)(A.Z,{status:"status.".concat(c.status)},c.id)},c.id)]}}],request:function(){var F=u()(s()().mark(function o(c,p,D){var b,g,j;return s()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,E.bJ)({page:(b=c.current)!==null&&b!==void 0?b:1,pageSize:(g=c.pageSize)!==null&&g!==void 0?g:10});case 2:return j=B.sent,B.abrupt("return",{data:j.data.list,success:!0,total:j.data.list.length});case 4:case"end":return B.stop()}},o)}));return function(o,c,p){return F.apply(this,arguments)}}()}),(0,t.jsx)(X,{onFinish:function(){var o;!((o=k.current)===null||o===void 0)&&o.reloadAndRest&&k.current.reloadAndRest()},ref:le})]})}},4813:function(ne,x,e){e.d(x,{_:function(){return u}});var W=e(15009),i=e.n(W),K=e(99289),s=e.n(K),f=e(82346);function u(P){return O.apply(this,arguments)}function O(){return O=s()(i()().mark(function P(E){return i()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,f.request)("/dpanel/api/common/attach/delete",{method:"POST",data:E});case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},P)})),O.apply(this,arguments)}},97841:function(ne,x,e){e.d(x,{Xr:function(){return M},bJ:function(){return A},c5:function(){return w},hf:function(){return u},l9:function(){return P}});var W=e(15009),i=e.n(W),K=e(99289),s=e.n(K),f=e(82346);function u(I){return O.apply(this,arguments)}function O(){return O=s()(i()().mark(function I(l){return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,f.request)("/dpanel/api/app/image-build/delete",{method:"POST",data:l});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},I)})),O.apply(this,arguments)}function P(I){return E.apply(this,arguments)}function E(){return E=s()(i()().mark(function I(l){return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/dpanel/api/app/image-build/create",{method:"POST",data:l}));case 1:case"end":return _.stop()}},I)})),E.apply(this,arguments)}function A(I){return y.apply(this,arguments)}function y(){return y=s()(i()().mark(function I(l){return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,f.request)("/dpanel/api/app/image-build/get-list",{method:"POST",data:l}));case 1:case"end":return _.stop()}},I)})),y.apply(this,arguments)}function M(I){return T.apply(this,arguments)}function T(){return T=s()(i()().mark(function I(l){return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,f.request)("/dpanel/api/app/image-build/get-detail",{method:"POST",data:l});case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},I)})),T.apply(this,arguments)}function w(){return n.apply(this,arguments)}function n(){return n=s()(i()().mark(function I(){return i()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,f.request)("/dpanel/api/app/image-build/prune",{method:"POST"});case 2:return L.abrupt("return",L.sent);case 3:case"end":return L.stop()}},I)})),n.apply(this,arguments)}},73813:function(ne,x,e){e.d(x,{Ck:function(){return u},Fj:function(){return I},GH:function(){return P},KG:function(){return M},Rb:function(){return de},Xz:function(){return A},YU:function(){return L},ZQ:function(){return S},ao:function(){return w},cD:function(){return h}});var W=e(15009),i=e.n(W),K=e(99289),s=e.n(K),f=e(82346);function u(t){return O.apply(this,arguments)}function O(){return O=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/import-by-container-tar",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),O.apply(this,arguments)}function P(t){return E.apply(this,arguments)}function E(){return E=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/import-by-image-tar",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),E.apply(this,arguments)}function A(t){return y.apply(this,arguments)}function y(){return y=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/dpanel/api/app/image/prune",{method:"POST"});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},t)})),y.apply(this,arguments)}function M(t){return T.apply(this,arguments)}function T(){return T=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/get-list",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),T.apply(this,arguments)}function w(t){return n.apply(this,arguments)}function n(){return n=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/dpanel/api/app/image/delete",{method:"POST",data:$});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},t)})),n.apply(this,arguments)}function I(t){return l.apply(this,arguments)}function l(){return l=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,f.request)("/dpanel/api/app/image/update-title",{method:"POST",data:$});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},t)})),l.apply(this,arguments)}function L(t){return _.apply(this,arguments)}function _(){return _=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/get-detail",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),_.apply(this,arguments)}function de(t){return Y.apply(this,arguments)}function Y(){return Y=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!$.enableExportToPath){a.next=2;break}return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/export",{method:"POST",data:$}));case 2:return a.abrupt("return",new Promise(function(pe,Me){var Ee,be=localStorage.getItem("token"),ge=new URLSearchParams;ge.append("token",be||""),$.md5&&$.md5.forEach(function(Te){ge.append("md5",Te)}),ge.append("enableExportToPath",String((Ee=$.enableExportToPath)!==null&&Ee!==void 0?Ee:!1));var je="/dpanel/api/app/image/export?".concat(ge.toString()),he=document.createElement("iframe");he.style.display="none",he.src=je,document.body.appendChild(he),pe({code:200,data:"success",error:""})}));case 3:case"end":return a.stop()}},t)})),Y.apply(this,arguments)}function S(t){return ie.apply(this,arguments)}function ie(){return ie=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/app/image/check-upgrade",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),ie.apply(this,arguments)}function h(t){return R.apply(this,arguments)}function R(){return R=s()(i()().mark(function t($){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,f.request)("/dpanel/api/pro/image/get-rootfs",{method:"POST",data:$}));case 1:case"end":return a.stop()}},t)})),R.apply(this,arguments)}},75870:function(ne,x,e){e.d(x,{Ot:function(){return u},ZH:function(){return P},ix:function(){return A},t1:function(){return M}});var W=e(15009),i=e.n(W),K=e(99289),s=e.n(K),f=e(82346);function u(w){return O.apply(this,arguments)}function O(){return O=s()(i()().mark(function w(n){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,f.request)("/dpanel/api/common/registry/get-list",{method:"POST",data:n}));case 1:case"end":return l.stop()}},w)})),O.apply(this,arguments)}function P(w){return E.apply(this,arguments)}function E(){return E=s()(i()().mark(function w(n){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,f.request)("/dpanel/api/common/registry/create",{method:"POST",data:n}));case 1:case"end":return l.stop()}},w)})),E.apply(this,arguments)}function A(w){return y.apply(this,arguments)}function y(){return y=s()(i()().mark(function w(n){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,f.request)("/dpanel/api/common/registry/delete",{method:"POST",data:n}));case 1:case"end":return l.stop()}},w)})),y.apply(this,arguments)}function M(w){return T.apply(this,arguments)}function T(){return T=s()(i()().mark(function w(n){return i()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,f.request)("/dpanel/api/common/registry/get-detail",{method:"POST",data:n}));case 1:case"end":return l.stop()}},w)})),T.apply(this,arguments)}}}]);
