"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7499],{43774:function(le,w,t){t.r(w),t.d(w,{default:function(){return Oe}});var V=t(5574),d=t.n(V),H=t(24963),S=t(15078),D=t(74453),$=t(97269),B=t(62370),X=t(97462),I=t(38345),ne=t(45360),E=t(42075),Y=t(25278),K=t(83622),k=t(92398),L=t(2487),q=t(86250),F=t(32983),u=t(4393),o=t(67294),P=t(15009),s=t.n(P),ue=t(97857),ae=t.n(ue),ce=t(99289),de=t.n(ce),me=t(184),he=t(5966),_=t(1269),U=t(71230),y=t(15746),fe=t(34041),pe=t(74842),ee=t(25593),ve=t(83062),re=t(66309),e=t(85893);function se(r){var Z=(0,o.useState)(),v=d()(Z,2),l=v[0],g=v[1];return(0,o.useEffect)(function(){var z=r.url.substring(0,r.url.indexOf("://"));switch(z){case"image":g((0,e.jsx)("img",{width:r.imageSize?r.imageSize.width:"auto",height:r.imageSize?r.imageSize.height:"auto",src:r.url.replace("image://","/dpanel/static/store/file/")}));break;case"http":case"https":g((0,e.jsx)("img",{width:r.imageSize?r.imageSize.width:"auto",height:r.imageSize?r.imageSize.height:"auto",src:r.url}));break;case"markdown-file":(0,S.yL)({path:r.url.replace("markdown-file://","/dpanel/static/store/file/")}).then(function(M){g((0,e.jsx)(_.Z,{source:M,style:{padding:5}},"content"))});break;case"markdown":g((0,e.jsx)(_.Z,{source:r.url.replace("markdown://",""),style:{padding:5}},"content"));break;default:g("")}},[r.url]),(0,e.jsx)(e.Fragment,{children:l})}var T=t(36146);function oe(r){var Z=new T.Uo;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(U.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:6,children:(0,e.jsx)(se,{url:r.app.logo,imageSize:r.logoSize})}),(0,e.jsxs)(y.Z,{span:r.extra?12:18,children:[(0,e.jsx)(U.Z,{children:(0,e.jsx)(y.Z,{span:24,children:(0,e.jsxs)(E.Z,{direction:"horizontal",children:[(0,e.jsx)(ee.Z.Title,{level:5,children:(0,e.jsx)("a",{href:r.app.website,target:"_blank",children:r.app.title})}),(0,e.jsx)(ee.Z.Text,{children:r.app.name})]})})}),(0,e.jsx)(U.Z,{style:{height:"60px"},children:(0,e.jsx)(y.Z,{children:(0,e.jsx)(ve.Z,{title:Z.formatCurrent(r.app.descriptions,r.app.description),children:(0,e.jsx)(ee.Z.Paragraph,{ellipsis:{rows:2},children:Z.formatCurrent(r.app.descriptions,r.app.description)})})})}),(0,e.jsx)(U.Z,{style:{height:"35px"},children:(0,e.jsx)(y.Z,{children:(0,e.jsxs)(E.Z,{wrap:!0,children:[r.app.storeName?(0,e.jsx)(re.Z,{color:"blue-inverse",children:r.app.storeName}):"",r.app.tag&&r.app.tag.map(function(v,l){return(0,e.jsx)(re.Z,{children:v},l)})]})})})]}),(0,e.jsx)(y.Z,{span:r.extra?6:0,children:r.extra})]})})}var ge=t(80821),je=t(90098),xe=t(91218),Se=t(3616),ye=t(68550),Ze=(0,o.forwardRef)(function(r,Z){var v=(0,o.useState)(!1),l=d()(v,2),g=l[0],z=l[1],M=(0,o.useState)(),W=d()(M,2),i=W[0],j=W[1],C=(0,o.useState)(),G=d()(C,2),x=G[0],J=G[1],O=(0,o.useRef)(),N=(0,o.useRef)(),m=new T.Uo("components.appstore");return(0,o.useImperativeHandle)(Z,function(){return{show:function(a){var n;z(!0),j(a),J((n=Object.keys(a.version).find(function(h){return a.version[h].default}))!==null&&n!==void 0?n:(0,ye.Z)(a.version))}}}),(0,e.jsxs)(me.a,{drawerProps:{width:Se.R_},submitter:!1,open:g,onOpenChange:function(a){var n;z(a),(n=O.current)===null||n===void 0||n.resetFields()},title:"".concat(i==null?void 0:i.name," ").concat(T.FD.format("listManageDetail")),children:[(0,e.jsx)(xe.Z,{showBackListButton:!0,ref:N}),i&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.Z,{ghost:!0,style:{marginBottom:"20px",paddingBottom:"20px",borderBottom:"#eeeeee solid 1px"},children:(0,e.jsx)(oe,{app:i,logoSize:{width:"130",height:"130"},extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(U.Z,{gutter:[10,10],children:[(0,e.jsx)(y.Z,{span:24,children:(0,e.jsx)(ge.Z,{buttonProps:{block:!0,type:"primary",icon:(0,e.jsx)(pe.Z,{})},confirmProps:{description:(0,e.jsx)($.A,{submitter:!1,formRef:O,layout:"horizontal",isKeyPressSubmit:!0,children:(0,e.jsx)(he.Z,{placeholder:m.format("detailNameEmpty"),width:"md",label:m.format("detailName"),name:"name"})})},action:de()(s()().mark(function c(){var a,n,h,f,p,A,te;return s()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(x){R.next=2;break}return R.abrupt("return");case 2:return f=i.version[x],f.ref!=""&&(f=i.version[f.ref]),p={storeId:(a=i.storeId)!==null&&a!==void 0?a:0,versionInfo:ae()(ae()({},f),{},{environment:f.environment&&f.environment.map(function(Q){return Q.label=m.formatCurrent(Q.labels,Q.label),Q})}),taskName:(n=(h=O.current)===null||h===void 0?void 0:h.getFieldValue("name"))!==null&&n!==void 0?n:"".concat(i.name,"-%CURRENT_DATE%"),appName:i.name,appTitle:i.title},R.next=7,(0,je.iE)(p);case 7:A=R.sent,A&&A.data.id&&((te=N.current)===null||te===void 0||te.show(A.data.id));case 9:case"end":return R.stop()}},c)})),children:T.FD.format("listManageDeploy")},"deploy")}),(0,e.jsx)(y.Z,{span:24,children:i.version&&(0,e.jsx)(fe.Z,{style:{width:"100%"},value:x,onChange:function(a){J(a)},options:Object.keys(i.version).map(function(c){return{value:c,label:c,checked:!0}})})})]})})})}),x&&function(){var c=i.version[x];if(c&&c.ref!=""&&(c=i.version[c.ref]),!(!c.environment||c.environment.length==0)){var a="";return a+="## ".concat(m.format("detailDescVersion")," <sup>").concat(x,`</sup> 
 |`).concat(m.format("detailDescName"),"|").concat(m.format("detailDescDefault"),"|").concat(m.format("detailDescDesc"),`| 
 |---|---|---|
`),c.environment.map(function(n){a+="|".concat(n.name,"|").concat(n.value,"|").concat(m.formatCurrent(n.labels,n.label),`| 
`)}),a+="<br />",(0,e.jsx)(_.Z,{source:a,style:{padding:5}})}}(),(0,e.jsx)(se,{url:m.formatCurrent(i==null?void 0:i.contents,i==null?void 0:i.content)})]})]})}),Ce=Ze,ie=t(82346),b="dpanel-search-result";function Oe(){var r=(0,o.useRef)(),Z=(0,o.useState)(),v=d()(Z,2),l=v[0],g=v[1],z=(0,o.useContext)(H.Z),M=z.loading,W=(0,o.useState)(""),i=d()(W,2),j=i[0],C=i[1],G=(0,o.useState)([]),x=d()(G,2),J=x[0],O=x[1],N=(0,ie.useLocation)(),m=new T.Uo("compose");(0,o.useEffect)(function(){M.show(),(0,S.eO)().then(function(a){if(a&&a.data&&a.data.list&&a.data.list.push({id:-1,name:b,title:m.format("storeSearchTitle"),setting:{apps:[]}}),g(Object.fromEntries(a.data.list.map(function(h){return[h.name,h]}))),N.state){var n=N.state;n.name!=""&&C(N.state.name)}else a.data.list.length>0&&C(a.data.list[0].name)}).finally(function(){M.destroy()})},[]);var c=function(n){var h=[];if(n=n.toLowerCase(),l){if(n==""){C(Object.keys(l)[0]),O([]);return}Object.keys(l).map(function(f){f!=b&&l[f].setting.apps&&l[f].setting.apps.map(function(p){if(n&&(p.name.toLowerCase().indexOf(n)!==-1||p.title&&p.title.toLowerCase().indexOf(n)!==-1||p.description&&p.description.toLocaleLowerCase().indexOf(n)!==-1)){var A=JSON.parse(JSON.stringify(p));A.storeName="".concat(l[f].title),A.storeId=l[f].id,h.push(A)}})}),h.length>0?(O(h),C(b)):(ne.ZP.error(m.format("storeSearchNotMatch")),C(Object.keys(l)[0]),O([]))}};return(0,e.jsxs)(D._z,{extra:[(0,e.jsx)($.A,{isKeyPressSubmit:!0,submitter:!1,onFinish:function(n){c(n.search)},children:(0,e.jsxs)(E.Z.Compact,{children:[(0,e.jsx)(B.Z,{style:{margin:0},name:"search",children:(0,e.jsx)(Y.Z,{allowClear:!0,addonBefore:m.format("storeSearchButtonTip"),placeholder:m.format("storeSearchButtonEmpty"),onClear:function(){c("")}})}),(0,e.jsx)(X.Z,{name:["search"],children:function(n){var h=n.search;return(0,e.jsx)(K.ZP,{onClick:function(){c(h)},children:m.format("storeSearchButton")})}})]})},"form")],children:[(0,e.jsx)(Ce,{ref:r}),(0,e.jsxs)(I.Z,{children:[j!=""&&l&&(0,e.jsx)(k.Z,{activeKey:j,onChange:function(n){O([]),C(n)},items:Object.keys(l).map(function(a){return{label:l[a].title||new T.Uo("compose").format("storeTitleOption."+a),key:a,disabled:j!=b&&a==b}})}),(0,e.jsx)(L.Z,{locale:{emptyText:(0,e.jsx)(q.Z,{justify:"center",style:{height:"40vh"},vertical:!0,children:(0,e.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsxs)(e.Fragment,{children:[m.format("storeEmpty"),", ",(0,e.jsx)(ie.Link,{to:"/system/appstore?op=create",children:T.Ob.format("compose.appstore.create")})]})})})},pagination:{pageSize:36},rowKey:function(n){return"".concat(n.name).concat(n.storeName)},grid:{gutter:10,xs:1,sm:2,md:2,lg:2,xl:2,xxl:3},dataSource:j==b?J:l&&l[j]&&l[j].setting.apps,renderItem:function(n,h){return(0,e.jsx)(L.Z.Item,{children:(0,e.jsx)(u.Z,{onClick:function(){if(l){var p;n.storeId||(n.storeId=l[j].id),(p=r.current)===null||p===void 0||p.show(n)}},hoverable:!0,children:(0,e.jsx)(oe,{app:n,logoSize:{width:"50",height:"50"}})})},h)}})]})]})}},15078:function(le,w,t){t.d(w,{$c:function(){return $},Me:function(){return k},eO:function(){return Y},ks:function(){return X},yL:function(){return q}});var V=t(15009),d=t.n(V),H=t(99289),S=t.n(H),D=t(82346);function $(u){return B.apply(this,arguments)}function B(){return B=S()(d()().mark(function u(o){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,D.request)("/dpanel/api/common/store/create",{method:"POST",data:o}));case 1:case"end":return s.stop()}},u)})),B.apply(this,arguments)}function X(u){return I.apply(this,arguments)}function I(){return I=S()(d()().mark(function u(o){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,D.request)("/dpanel/api/common/store/sync",{method:"POST",data:o}));case 1:case"end":return s.stop()}},u)})),I.apply(this,arguments)}function ne(u){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime().mark(function u(o){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/dpanel/api/common/store/get-detail",{method:"POST",data:o}));case 1:case"end":return s.stop()}},u)})),E.apply(this,arguments)}function Y(u){return K.apply(this,arguments)}function K(){return K=S()(d()().mark(function u(o){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,D.request)("/dpanel/api/common/store/get-list",{method:"POST",data:o}));case 1:case"end":return s.stop()}},u)})),K.apply(this,arguments)}function k(u){return L.apply(this,arguments)}function L(){return L=S()(d()().mark(function u(o){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,D.request)("/dpanel/api/common/store/delete",{method:"POST",data:o});case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}},u)})),L.apply(this,arguments)}function q(u){return F.apply(this,arguments)}function F(){return F=S()(d()().mark(function u(o){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,D.request)(o==null?void 0:o.path,{method:"GET"}));case 1:case"end":return s.stop()}},u)})),F.apply(this,arguments)}}}]);
