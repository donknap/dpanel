"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1058],{91058:function(ne,K,n){var S=n(9783),_=n.n(S),L=n(19632),E=n.n(L),s=n(97857),d=n.n(s),w=n(5574),g=n.n(w),W=n(89035),D=n(45605),T=n(64317),Y=n(31199),M=n(5966),f=n(38345),x=n(17186),p=n(24739),b=n(42075),F=n(83622),B=n(83062),j=n(85576),I=n(67294),H=n(11106),Z=n(12491),h=n(62597),P=n(79245),V=n(3616),y=n(36146),r=n(85893),u="docker-image",m=(0,I.forwardRef)(function(e,Q){var G=(0,I.useState)(u),q=g()(G,2),z=q[0],A=q[1],v=(0,I.useRef)(),J=(0,I.useState)(""),ee=g()(J,2),ae=ee[0],oe=ee[1],U=new y.Uo("components.appForm");(0,I.useImperativeHandle)(Q,function(){return{addEnvItem:function(a){var l,i=(l=v.current)===null||l===void 0?void 0:l.getList(),o=!1;if(i==null||i.map(function(O){if(O.name==a.name){o=!0;return}}),!o){var c;(c=v.current)===null||c===void 0||c.add(a)}},addEnvNameValue:function(a,l){this.addEnvItem({name:a,value:l})},clear:function(){var a;(a=v.current)===null||a===void 0||(a=a.getList())===null||a===void 0||a.map(function(l,i){var o;(o=v.current)===null||o===void 0||o.remove(i)})}}});function re(t){try{var a,l;t==""&&(t=te());for(var i=(a=(l=v.current)===null||l===void 0||(l=l.getList())===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0,o=i;o>=0;o--){var c,O,R=(c=v.current)===null||c===void 0?void 0:c.get(o);i-=1,(O=v.current)===null||O===void 0||O.remove(o)}var k=t.split(`
`),X=i+1;k.map(function(N){var C,$=N.split("=");$.length<2||((C=v.current)===null||C===void 0||C.add({name:$[0],value:$.slice(1).join("=")},X),X++)})}catch(N){console.log(N)}}function _e(){z!="code"?A("code"):A(u)}function te(){if(v&&v.current&&v.current.getList){var t,a=(t=v.current)===null||t===void 0?void 0:t.getList();if(a){var l=[];return a.forEach(function(i){l.push("".concat(i.name,"=").concat(i.value))}),l.join(`
`)}else return""}else return""}function ue(t){var a,l,i,o,c,O,R={},k={help:(0,P.y)((a=t.rule)===null||a===void 0?void 0:a.kind,h.fp.EnvValueTypeOnePanel)?U.formatOnePanel(t.name):U.formatUser(t.labels),name:"value",label:U.format("createEnvFormValue"),rules:[{required:e.requireValue?!0:(0,P.y)((l=t.rule)===null||l===void 0?void 0:l.kind,h.fp.EnvValueRuleRequired)}],addonAfter:!0,disabled:e.showDisableValue||(0,P.y)((i=t.rule)===null||i===void 0?void 0:i.kind,h.fp.EnvValueRuleDisabled),placeholder:t.label};if((0,P.y)((o=t.rule)===null||o===void 0?void 0:o.kind,h.fp.EnvValueTypeSelect)){var X;return(0,r.jsx)(T.Z,d()(d()({fieldProps:R},k),{},{initialValue:t.value,width:e.showInDrawer?"sm":"md",options:((X=t.rule)===null||X===void 0?void 0:X.option)&&t.rule.option.map(function(C){return{label:C.name,value:C.value}})}),t.name)}else if((0,P.y)((c=t.rule)===null||c===void 0?void 0:c.kind,h.fp.EnvValueTypeSelectMultiple)){var N;return(0,r.jsx)(T.Z,d()(d()({mode:"tags"},k),{},{fieldProps:R,convertValue:function($){return Array.isArray($)?$:$.split(",")},width:e.showInDrawer?"sm":"md",options:((N=t.rule)===null||N===void 0?void 0:N.option)&&t.rule.option.map(function(C){return{label:C.name,value:C.value}})}),t.name)}else return(0,P.y)((O=t.rule)===null||O===void 0?void 0:O.kind,h.fp.EnvValueTypeNumber)?(0,r.jsx)(Y.Z,d()(d()({fieldProps:R},k),{},{width:e.showInDrawer?"sm":"md",rules:[].concat(E()(k.rules),[{pattern:new RegExp("^[0-9]*$")}])}),t.name):(0,r.jsx)(M.Z,d()(d()({fieldProps:R},k),{},{width:e.showInDrawer?"sm":"md"}),t.name)}return(0,r.jsxs)(f.Z,d()(d()({headerBordered:!0,extra:(e.showCodeMode||e.showImportButton)&&(0,r.jsxs)(b.Z,{children:[e.showImportButton&&(0,r.jsx)("div",{style:{marginBottom:"-25px"},children:(0,r.jsx)(Z.Z,{title:U.format("createEnvFormEnvImport"),onImport:function(a){return re(a),!0},onLoad:function(a){if(a.indexOf("=")<0)throw new Error(y.FD.format("commonFileIncorrectFormat",{name:"env"}));return!0}})}),e.showCodeMode?(0,r.jsx)(F.ZP,{icon:(0,r.jsx)(W.Z,{}),type:z=="code"?"primary":"default",onClick:_e,children:U.format("createEnvFormEnvCode")},"code"):""]})},e.drawerProps),{},{children:[(0,r.jsx)(x.u,{style:{marginTop:10},name:e.name?e.name:"environment",actionRef:v,creatorButtonProps:e.showAddButton?{creatorButtonText:e.addButtonLabel?e.addButtonLabel:U.format("createEnvFormListAddButton")}:!1,copyIconProps:!1,deleteIconProps:e.showDeleteButton,actionRender:function(a,l,i,o){var c,O,R=(c=v.current)===null||c===void 0?void 0:c.get(a.key);return R&&(0,P.y)((O=R.rule)===null||O===void 0?void 0:O.kind,h.fp.EnvValueRuleInEnvFile)?[(0,r.jsx)(B.Z,{title:U.format("createEnvFormListInEnvFile"),children:(0,r.jsx)(F.ZP,{type:"text",icon:(0,r.jsx)(D.Z,{})})},"inEnvFile")]:[i[0]]},min:100,label:e.listLabel,transform:function(a,l,i){return _()({},l,a.map(function(o){return Array.isArray(o.value)?o.value=o.value.filter(function(c){return c!=""}).join(","):o.value=o.value.toString(),o}))},children:function(a,l,i){var o,c=i.getCurrentRowData();return(0,r.jsxs)(p.UW,{style:{marginBottom:"5px"},children:[(0,r.jsx)(M.Z,{width:e.showInDrawer?"sm":"md",name:"name",label:U.format("createEnvFormName"),required:!0,rules:[{required:!0}],disabled:e.showDisableName||(0,P.y)((o=c.rule)===null||o===void 0?void 0:o.kind,h.fp.EnvValueRuleInEnvFile),placeholder:U.format("createEnvFormName")},l),ue(c)]})}}),e.showCodeMode&&(0,r.jsx)(j.Z,{width:V.ob,open:z=="code",onCancel:function(){return A("docker-image")},onOk:function(){re(ae),A("docker-image")},children:(0,r.jsx)(H.ZP,{onChange:function(a){return oe(a)},value:te(),height:V.Ed,theme:"dark"})})]}))});K.Z=m},12491:function(ne,K,n){n.d(K,{Z:function(){return x}});var S=n(5574),_=n.n(S),L=n(3616),E=n(24963),s=n(36146),d=n(88484),w=n(57546),g=n(62370),W=n(11106),D=n(42075),T=n(83622),Y=n(85576),M=n(67294),f=n(85893);function x(p){var b=(0,M.useContext)(E.Z),F=b.message,B=b.notice,j=(0,M.useRef)(null),I=(0,M.useState)(!1),H=_()(I,2),Z=H[0],h=H[1],P=(0,M.useState)(""),V=_()(P,2),y=V[0],r=V[1];(0,M.useEffect)(function(){p.data&&r(p.data)},[p.data]);var u=function(){j.current&&(j.current.click(),j.current.onchange=function(e){if(!e||!e.target)return"";var Q=new FileReader;Q.onload=function(z){var A,v,J=(A=z.target)===null||A===void 0?void 0:A.result;if(p.onLoad)try{p.onLoad&&p.onLoad(J)}catch(ee){B.error(ee);return}r(J),typeof p.onImport=="function"&&(F.success(s.FD.format("finish")),p.onImport(J)),(v=j.current)!==null&&v!==void 0&&v.value&&(j.current.value="")};var G=e.target;if(G.files&&G.files[0]){var q=G.files[0];try{Q.readAsText(q)}catch(z){B.error(s.FD.format("commonContentIncorrectFormat",{name:G.files[0].name}))}}})};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g.Z,{children:(0,f.jsxs)(D.Z.Compact,{block:!0,children:[(0,f.jsx)(T.ZP,{icon:(0,f.jsx)(d.Z,{}),block:!0,onClick:u,children:p.title}),p.showPaset&&(0,f.jsx)(T.ZP,{icon:(0,f.jsx)(w.Z,{}),onClick:function(){h(!0)}})]})}),(0,f.jsx)("input",{style:{display:"none"},type:"file",ref:j,name:"importFileInput"}),(0,f.jsx)(Y.Z,{width:L.ob,open:Z,onCancel:function(){h(!1)},onOk:function(){typeof p.onImport=="function"&&(F.success(s.FD.format("finish")),p.onImport(y)),h(!1)},children:(0,f.jsx)(W.ZP,{height:L.Ed,theme:"dark",value:y,onChange:function(e){r(e)}})})]})}},62597:function(ne,K,n){n.d(K,{$G:function(){return W},Ct:function(){return j},Tb:function(){return f},XH:function(){return p},cl:function(){return Y},fp:function(){return T},fu:function(){return w},iE:function(){return F},nL:function(){return g},xU:function(){return V},xb:function(){return H},ze:function(){return h}});var S=n(15009),_=n.n(S),L=n(99289),E=n.n(L),s=n(82346),d="com.dpanel.container.description",w="com.dpanel.container.title",g={Nanosecond:1,Microsecond:1e3,Millisecond:1e3*1e3,Second:1e3*1e3*1e3,Minute:60*1e3*1e3*1e3,Hour:3600*1e3*1e3*1e3};function W(r){return D.apply(this,arguments)}function D(){return D=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/dpanel/api/app/site/create-by-image",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),D.apply(this,arguments)}var T={EnvValueRuleRequired:1,EnvValueRuleDisabled:2,EnvValueRuleInEnvFile:4,EnvValueTypeNumber:1024,EnvValueTypeText:2048,EnvValueTypeSelect:4096,EnvValueTypeSelectMultiple:8192,EnvValueTypeOnePanel:16384};function Y(r){return M.apply(this,arguments)}function M(){return M=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/dpanel/api/app/site/get-list",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),M.apply(this,arguments)}function f(r){return x.apply(this,arguments)}function x(){return x=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.download=!1,e.next=3,(0,s.request)("/dpanel/api/app/log/run",{method:"POST",data:u});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),x.apply(this,arguments)}function p(r){return b.apply(this,arguments)}function b(){return b=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.download=!0,e.next=3,(0,s.request)("/dpanel/api/app/log/run",{method:"POST",data:u,responseType:"blob"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),b.apply(this,arguments)}function F(r){return B.apply(this,arguments)}function B(){return B=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.id=String(u.id),e.next=3,(0,s.request)("/dpanel/api/app/site/get-detail",{data:u,method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)})),B.apply(this,arguments)}function j(r){return I.apply(this,arguments)}function I(){return I=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/dpanel/api/app/container/delete",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),I.apply(this,arguments)}function H(r){return Z.apply(this,arguments)}function Z(){return Z=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/dpanel/api/app/site/delete",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),Z.apply(this,arguments)}function h(r){return P.apply(this,arguments)}function P(){return P=E()(_()().mark(function r(u){return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.request)("/dpanel/api/app/container/ignore",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),P.apply(this,arguments)}function V(){return y.apply(this,arguments)}function y(){return y=E()(_()().mark(function r(){return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,s.request)("/dpanel/api/app/site/prune",{method:"POST"}));case 1:case"end":return m.stop()}},r)})),y.apply(this,arguments)}},79245:function(ne,K,n){n.d(K,{m:function(){return L},y:function(){return E}});var S=n(64599),_=n.n(S);function L(s){var d=[];if(!s||s=="")return d;var w=s.matchAll(/\$\{(\w+)[:-?=]*(.*?)\}/g),g=_()(w),W;try{for(g.s();!(W=g.n()).done;){var D=W.value;d.push({name:D[1],value:D[2]?D[2].indexOf("-")==0?D[2].substring(1):D[2]:""})}}catch(T){g.e(T)}finally{g.f()}return d}function E(s,d){return!s||!d?!1:(s&d)!==0}}}]);
