"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4617],{81146:function(Ye,Te,e){var Pe=e(97857),f=e.n(Pe),Le=e(15009),g=e.n(Le),I=e(99289),B=e.n(I),ye=e(67294),fe=e(97269),A=e(62370),he=e(5966),s=e(97462),H=e(82346),Ze=e(71230),ae=e(15746),h=e(34041),le=e(83622),q=e(84567),de=e(42075),z=e(80821),Oe=e(23430),we=e(93162),Ce=e.n(we),L=e(78267),w=e.n(L),b=e(75458),G=e.n(b),Ee=e(12323),Ge=e(4244),i=e.n(Ge),qe=e(24078),Me=e(36146),y=e(85893),$,ge,Se,De={decorations:{matchBackground:"",matchBorder:"#FFFF00",activeMatchBackground:"#FFFF0066",matchOverviewRuler:"",activeMatchColorOverviewRuler:""}},Be=(0,ye.forwardRef)(function(ue,Ne){var u=(0,ye.useRef)(),j=(0,H.useModel)("subscriber"),E=new Me.Uo("components.containerLog");(0,ye.useImperativeHandle)(Ne,function(){return{fit:function(){$.clear(),Se.fit()},start:function(){return B()(g()().mark(function F(){return g()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,t({lineTotal:500});case 2:case"end":return O.stop()}},F)}))()},close:function(){j.progress.close(ue.id)}}});function t(N){return ce.apply(this,arguments)}function ce(){return ce=B()(g()().mark(function N(F){return g()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:j.progress.close(ue.id),$.clear(),F.download=!1,ue.request(F);case 4:case"end":return O.stop()}},N)})),ce.apply(this,arguments)}return(0,ye.useEffect)(function(){return window.addEventListener("resize",function(){Se.fit()}),$=new Ge.Terminal(f()(f()({},Ee.X),{},{fontSize:12,lineHeight:1.2,allowProposedApi:!0})),Se=new L.FitAddon,ge=new b.SearchAddon({}),$.loadAddon(Se),$.loadAddon(ge),$.open(document.getElementById("terminal-container-log")),Se.fit(),j.addDataHandler(ue.id,function(N){$.write(N.data)}),function(){$.clear(),$.reset(),j.progress.close(ue.id)}},[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(fe.A,{submitter:!1,layout:"horizontal",onFinish:function(F){var n;t({id:ue.id,lineTotal:parseInt(F.lineTotal),showTime:(n=F.showTime)!==null&&n!==void 0?n:!1})},formRef:u,children:(0,y.jsxs)(Ze.Z,{gutter:[10,0],children:[(0,y.jsx)(ae.Z,{span:8,children:(0,y.jsx)(A.Z,{name:"lineTotal",initialValue:"500",label:E.format("formLineTotal"),children:(0,y.jsxs)(h.Z,{defaultValue:"500",onChange:function(F){var n;(n=u.current)===null||n===void 0||n.submit()},children:[(0,y.jsx)(h.Z.Option,{value:"100",children:E.format("formLineTotalOption",{number:"100"})}),(0,y.jsx)(h.Z.Option,{value:"200",children:E.format("formLineTotalOption",{number:"200"})}),(0,y.jsx)(h.Z.Option,{value:"500",children:E.format("formLineTotalOption",{number:"500"})}),(0,y.jsx)(h.Z.Option,{value:"1000",children:E.format("formLineTotalOption",{number:"1000"})}),(0,y.jsx)(h.Z.Option,{value:"-1",children:E.format("formLineTotalOptionAll")})]})})}),(0,y.jsx)(ae.Z,{children:(0,y.jsx)(le.ZP,{onClick:function(){$.clear()},children:E.format("clearButton")})}),(0,y.jsx)(ae.Z,{children:(0,y.jsx)(A.Z,{name:"showTime",valuePropName:"checked",children:(0,y.jsx)(q.Z,{onChange:function(F){var n;(n=u.current)===null||n===void 0||n.submit()},children:E.format("formShowTime")})})}),(0,y.jsx)(ae.Z,{children:(0,y.jsx)(he.Z,{label:E.format("formKeywork"),name:"keywork",fieldProps:{onPressEnter:function(){var F;ge.findNext((F=u.current)===null||F===void 0?void 0:F.getFieldValue("keywork"),De)},onChange:function(F){ge.findNext(F.target.value,De)}},placeholder:E.format("formKeyworkEmpty")})}),(0,y.jsx)(ae.Z,{children:(0,y.jsx)(s.Z,{name:["keywork"],children:function(F){var n=F.keywork;return(0,y.jsxs)(de.Z,{size:10,children:[(0,y.jsx)(le.ZP,{onClick:function(){ge.findNext(n,De)},children:E.format("formKeyworkNext")},"next"),(0,y.jsx)(le.ZP,{onClick:function(){ge.findPrevious(n,De)},children:E.format("formKeyworkPrev")},"prev")]})}})}),(0,y.jsx)(ae.Z,{children:(0,y.jsx)(z.Z,{buttonProps:{icon:(0,y.jsx)(Oe.Z,{})},action:B()(g()().mark(function N(){var F,n,O;return g()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!ue.download){ee.next=5;break}return ee.next=3,ue.download({lineTotal:parseInt((F=u.current)===null||F===void 0?void 0:F.getFieldValue("lineTotal")),showTime:(n=u.current)===null||n===void 0?void 0:n.getFieldValue("showTime")});case 3:O=ee.sent,(0,we.saveAs)(O.data,O.name);case 5:case"end":return ee.stop()}},N)})),children:E.format("downloadButton")})})]})}),(0,y.jsx)("div",{style:{marginTop:"20px",height:ue.showInDrawer?"75vh":"85vh"},id:"terminal-container-log"})]})});Te.Z=Be},94359:function(Ye,Te,e){e.d(Te,{Z:function(){return le}});var Pe=e(5574),f=e.n(Pe),Le=e(3089),g=e(98165),I=e(18429),B=e(8751),ye=e(66212),fe=e(14313),A=e(30159),he=e(87740),s=e(50888),H=e(66309),Ze=e(83062),ae=e(36146),h=e(85893);function le(q){var de,z,Oe=new ae.Uo("components.containerStatus"),we=q.status.split("."),Ce=f()(we,2),L=Ce[0],w=Ce[1],b="";b=Oe.format(q.status,(de=q.statusValue)!==null&&de!==void 0?de:{});var G=(0,h.jsx)(h.Fragment,{});return w=="0"&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(Le.Z,{}),color:"default",children:b})),w=="10"&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(g.Z,{spin:!0}),color:"processing",children:b})),w=="20"&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(I.Z,{}),color:"error",children:b})),w=="30"&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(B.Z,{}),color:"success",children:b})),w=="new"&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(ye.Z,{}),children:b})),(w=="running"||w=="healthy"||w=="active"||w=="ready")&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(fe.Z,{}),color:"success",children:b})),(w=="paused"||w=="pause"||w=="rollback_paused")&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(A.Z,{}),color:"warning",children:b})),(w=="waiting"||w=="starting"||w=="accepted")&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(he.Z,{}),children:b})),["deploying","pending","allocated","accepted","assigned","preparing","updating","rollback_started"].includes(w)&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(s.Z,{}),color:"processing",children:b})),(w=="error"||w=="down"||w=="failed")&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(I.Z,{}),color:"error",children:b})),["complete","completed","rollback_completed"].includes(w)&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(B.Z,{}),color:"success",children:b})),["exited","dead","removing","restarting","unhealthy","created","drain","unreachable","shutdown","rejected","remove","orphaned"].includes(w)&&(G=(0,h.jsx)(H.Z,{icon:(0,h.jsx)(I.Z,{}),color:"warning",children:b})),(0,h.jsx)(Ze.Z,{placement:"top",title:(z=q.tip)!==null&&z!==void 0?z:"",children:G})}},98093:function(Ye,Te,e){e.d(Te,{Z:function(){return F}});var Pe=e(15009),f=e.n(Pe),Le=e(99289),g=e.n(Le),I=e(5574),B=e.n(I),ye=e(3616),fe=e(184),A=e(62370),he=e(83622),s=e(67294),H=e(59252),Ze=e(24796),ae=e(93529),h=e(91058),le=e(82034),q=e(10523),de=e(52255),z=e(38345),Oe=e(5966),we=e(24739),Ce=e(30291),L=e(92398),w=e(36146),b=e(42963),G=e(42075),Ee=e(64317),Ge=e(75870),i=e(85893);function qe(){var n=new w.Uo("components.appForm");return(0,i.jsxs)(G.Z.Compact,{children:[(0,i.jsx)(Ee.Z,{name:"imageRegistry",width:"sm",fieldProps:{popupMatchSelectWidth:!1},request:g()(f()().mark(function O(){var _e;return f()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(0,Ge.Ot)();case 2:return _e=ie.sent,ie.abrupt("return",_e.data.list.map(function(be){return{label:"".concat(be.title,"@").concat(be.serverAddress),value:be.id}}));case 4:case"end":return ie.stop()}},O)})),label:n.format("dockerImageImageName")}),(0,i.jsx)(Oe.Z,{label:" ",name:"imageName",required:!0,rules:[{required:!0}],width:"lg"})]})}var Me=e(86615),y=e(97462),$=e(31199),ge=e(86250),Se=e(44349),De=e(24494);function Be(){var n,O=new w.Uo("components.appForm"),_e=(0,s.useContext)(b.Z),ee=_e.createFormRef,ie=(0,s.useRef)();return(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(ge.Z,{gap:60,children:[(0,i.jsx)(Me.Z.Group,{width:"md",label:O.format("createSchedulingLabel"),name:["scheduling","mode"],options:O.option("createSchedulingOption",["global","replicated"]),initialValue:"replicated",disabled:(n=ee.current)===null||n===void 0?void 0:n.getFieldValue("id")}),(0,i.jsx)(y.Z,{name:["scheduling"],children:function(Ke){var $e=Ke.scheduling;return $e.mode=="replicated"&&(0,i.jsx)($.Z,{width:"md",label:O.format("createSchedulingReplicas"),name:["scheduling","replicas"],initialValue:1})}})]}),(0,i.jsx)(y.Z,{name:["scheduling","constraint"],children:function(Ke){var $e=Ke.scheduling,Fe=Ke.constraint;return $e.mode=="replicated"&&[(0,i.jsx)(Me.Z.Group,{label:O.format("createConstraintNode"),initialValue:"all",name:["constraint","role"],options:O.option("createConstraintNodeOption",["all","manager","worker","user"])},"role"),Fe&&Fe.role=="user"&&(0,i.jsx)(Ee.Z,{name:["constraint","node"],request:g()(f()().mark(function ze(){var ke;return f()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,De.HN)();case 2:return ke=K.sent,K.abrupt("return",ke.data.list&&ke.data.list.map(function(X){var J;return{label:(J=X.Description)===null||J===void 0?void 0:J.Hostname,value:X.ID}}));case 4:case"end":return K.stop()}},ze)}))}),(0,i.jsx)(Se.Z,{name:["constraint","label"],label:O.format("createConstraintLabel"),hideCopyButton:!0,showAddButton:!0,gap:10,ref:ie,items:[{label:O.format("createConstraintLabelOption.name"),name:"name",width:"md",placeholder:"node.labels.name"},{name:"operator",render:function(ke,C,K){return(0,i.jsx)(Ee.Z,{label:" ",name:"operator",valueEnum:{"==":"==","!=":"!="},initialValue:"=="})}},{label:O.format("createConstraintLabelOption.value"),name:"value",width:"md"}]},"label"),(0,i.jsx)(Se.Z,{name:"placement",label:O.format("createPlacementLabel"),hideCopyButton:!0,showAddButton:!0,gap:10,items:[{name:"name",render:function(ke,C,K){return(0,i.jsx)(Ee.Z,{label:" ",name:"type",options:O.option("createPlacementOption",["spread"]),initialValue:"spread",allowClear:!1,width:"sm"})}},{label:O.format("createConstraintLabelOption.value"),name:"value",width:"md",placeholder:"node.labels.hostname"}]},"placement")]}})]})}var ue=e(73396),Ne=e(55730),u=e(33879);function j(){var n=new w.Uo("components.appForm");return(0,i.jsx)(z.Z,{ghost:!0,children:(0,i.jsxs)(ge.Z,{gap:30,children:[(0,i.jsx)(Ee.Z,{label:n.format("createAdvRestart"),name:["restart","name"],width:"sm",initialValue:"any",options:n.option("createAdvRestartOption",["none","on-failure","any"])}),(0,i.jsx)(y.Z,{name:["restart"],children:function(_e){var ee=_e.restart;return ee=="on-failure"&&(0,i.jsx)($.Z,{width:"sm",label:n.format("createAdvRestartMax"),name:["restart","maxAttempt"],initialValue:5})}}),(0,i.jsx)($.Z,{width:"sm",label:n.format("createAdvRestartDelay"),tooltip:n.format("createAdvRestartDelayTip"),name:["restart","delay"],initialValue:5,fieldProps:{addonAfter:w.FD.format("unitSecond")}}),(0,i.jsx)($.Z,{width:"sm",label:n.format("createAdvRestartWindow"),tooltip:n.format("createAdvRestartWindowTip"),name:["restart","window"],initialValue:0,fieldProps:{addonAfter:w.FD.format("unitSecond")}})]})})}function E(){var n=new w.Uo("components.appForm");return(0,i.jsxs)(z.Z,{children:[(0,i.jsxs)(ge.Z,{gap:30,children:[(0,i.jsx)($.Z,{label:n.format("createSwarmUpdateParallelism"),name:["scheduling","update","parallelism"],initialValue:1}),(0,i.jsx)($.Z,{label:n.format("createSwarmUpdateDelay"),name:["scheduling","update","delay"],initialValue:0,fieldProps:{addonAfter:w.FD.format("unitSecond")}})]}),(0,i.jsx)(Me.Z.Group,{label:n.format("createSwarmUpdateFailureAction"),name:["scheduling","update","failureAction"],initialValue:"pause",options:n.option("createSwarmUpdateFailureActionOption",["pause","continue","rollback"])}),(0,i.jsx)(Me.Z.Group,{label:n.format("createSwarmUpdateOrder"),name:["scheduling","update","order"],initialValue:"stop-first",options:n.option("createSwarmUpdateOrderOption",["stop-first","start-first"])})]})}var t=e(64412),ce=e(27323),N=(0,s.forwardRef)(function(n,O){(0,s.useImperativeHandle)(O,function(){return{edit:function(o){var l,c,p,x,D,R,m,v,W,Q,k,Y,oe,a,pe,ne,Ae,me,Xe,je,xe,Ie,Re,T,d,P,M,S,_,se,te,Ue,en,Je,tn,an={id:o.ID,siteName:(l=(c=o.Spec)===null||c===void 0?void 0:c.Name)!==null&&l!==void 0?l:"",siteTitle:((p=o.Spec)===null||p===void 0?void 0:p.Labels)&&((x=o.Spec)===null||x===void 0?void 0:x.Labels[De.$m]),hostname:(D=o.Spec)===null||D===void 0||(D=D.TaskTemplate)===null||D===void 0||(D=D.ContainerSpec)===null||D===void 0?void 0:D.Hostname,imageName:(R=(m=o.Spec)===null||m===void 0||(m=m.TaskTemplate)===null||m===void 0||(m=m.ContainerSpec)===null||m===void 0?void 0:m.Image)!==null&&R!==void 0?R:"",environment:(v=o.Spec)===null||v===void 0||(v=v.TaskTemplate)===null||v===void 0||(v=v.ContainerSpec)===null||v===void 0||(v=v.Env)===null||v===void 0?void 0:v.map(function(r){var Z=r.split("=");return{name:Z[0],value:Z.slice(1).join("=")}}),volumes:(W=o.Spec)===null||W===void 0||(W=W.TaskTemplate)===null||W===void 0||(W=W.ContainerSpec)===null||W===void 0||(W=W.Mounts)===null||W===void 0?void 0:W.map(function(r){var Z,V;return{dest:(Z=r.Target)!==null&&Z!==void 0?Z:"",host:(V=r.Source)!==null&&V!==void 0?V:"",type:r.Type,permission:r.ReadOnly?"readonly":"write"}}),restartPolicy:function(r,Z){return{name:(Z=r.Condition)!==null&&Z!==void 0?Z:"any",maxAttempt:r.MaxAttempts,window:r.Window,delay:r.Delay}}(((Q=o.Spec)===null||Q===void 0||(Q=Q.TaskTemplate)===null||Q===void 0?void 0:Q.RestartPolicy)||{}),cpus:function(r){return r?r/1e9:0}((k=o.Spec)===null||k===void 0||(k=k.TaskTemplate)===null||k===void 0||(k=k.Resources)===null||k===void 0||(k=k.Limits)===null||k===void 0?void 0:k.NanoCPUs),memory:function(r){return r?r/1024/1024:0}((Y=o.Spec)===null||Y===void 0||(Y=Y.TaskTemplate)===null||Y===void 0||(Y=Y.Resources)===null||Y===void 0||(Y=Y.Limits)===null||Y===void 0?void 0:Y.MemoryBytes),workDir:{useDefault:!((oe=o.Spec)!==null&&oe!==void 0&&(oe=oe.TaskTemplate)!==null&&oe!==void 0&&(oe=oe.ContainerSpec)!==null&&oe!==void 0&&oe.Dir),default:"",value:(a=o.Spec)===null||a===void 0||(a=a.TaskTemplate)===null||a===void 0||(a=a.ContainerSpec)===null||a===void 0?void 0:a.Dir},user:{useDefault:!((pe=o.Spec)!==null&&pe!==void 0&&(pe=pe.TaskTemplate)!==null&&pe!==void 0&&(pe=pe.ContainerSpec)!==null&&pe!==void 0&&pe.User),default:"",value:(ne=o.Spec)===null||ne===void 0||(ne=ne.TaskTemplate)===null||ne===void 0||(ne=ne.ContainerSpec)===null||ne===void 0?void 0:ne.User},command:{useDefault:!((Ae=o.Spec)!==null&&Ae!==void 0&&(Ae=Ae.TaskTemplate)!==null&&Ae!==void 0&&(Ae=Ae.ContainerSpec)!==null&&Ae!==void 0&&Ae.Command),default:"",value:(me=o.Spec)===null||me===void 0||(me=me.TaskTemplate)===null||me===void 0||(me=me.ContainerSpec)===null||me===void 0||(me=me.Command)===null||me===void 0?void 0:me.join(" ")},log:function(r,Z){return{driver:(Z=r==null?void 0:r.Name)!==null&&Z!==void 0?Z:"json-file",maxFile:(r==null?void 0:r.Options)&&r.Options["max-file"],maxSize:(r==null?void 0:r.Options)&&r.Options["max-size"]}}((Xe=o.Spec)===null||Xe===void 0||(Xe=Xe.TaskTemplate)===null||Xe===void 0?void 0:Xe.LogDriver),dns:(je=o.Spec)===null||je===void 0||(je=je.TaskTemplate)===null||je===void 0||(je=je.ContainerSpec)===null||je===void 0||(je=je.DNSConfig)===null||je===void 0?void 0:je.Nameservers,label:((xe=o.Spec)===null||xe===void 0||(xe=xe.TaskTemplate)===null||xe===void 0||(xe=xe.ContainerSpec)===null||xe===void 0?void 0:xe.Labels)&&Object.entries((Ie=o.Spec)===null||Ie===void 0||(Ie=Ie.TaskTemplate)===null||Ie===void 0||(Ie=Ie.ContainerSpec)===null||Ie===void 0?void 0:Ie.Labels).map(function(r){return{name:r[0],value:r[1]}}),extraHosts:((Re=o.Spec)===null||Re===void 0||(Re=Re.TaskTemplate)===null||Re===void 0||(Re=Re.ContainerSpec)===null||Re===void 0?void 0:Re.Hosts)&&((T=o.Spec)===null||T===void 0||(T=T.TaskTemplate)===null||T===void 0||(T=T.ContainerSpec)===null||T===void 0?void 0:T.Hosts.map(function(r){var Z=r.split(":"),V=B()(Z,2),He=V[0],We=V[1];return{name:He,value:We}})),capAdd:(d=o.Spec)===null||d===void 0||(d=d.TaskTemplate)===null||d===void 0||(d=d.ContainerSpec)===null||d===void 0?void 0:d.CapabilityAdd,scheduling:function(r){return{mode:r!=null&&r.Global?"global":"replicated",replicas:r!=null&&r.Replicated?r.Replicated.Replicas:1}}((P=o.Spec)===null||P===void 0?void 0:P.Mode),constraint:function(r,Z,V,He){var We="all";r!=null&&(Z=r.Constraints)!==null&&Z!==void 0&&Z.includes("node.role==worker")&&(We="worker"),r!=null&&(V=r.Constraints)!==null&&V!==void 0&&V.includes("node.role==manager")&&(We="manager"),r==null||(He=r.Constraints)===null||He===void 0||He.forEach(function(Qe){Qe.includes("node.id==")&&(We="user")});var nn="",rn=[];return r!=null&&r.Constraints&&r.Constraints.forEach(function(Qe){if(Qe.includes("node.id==")){var un=Qe.split("node.id=="),on=B()(un,2),Sn=on[0],cn=on[1];nn=cn;return}if(Qe.includes("==")){var vn=Qe.split("=="),sn=B()(vn,2),pn=sn[0],mn=sn[1];rn.push({name:pn,value:mn,operator:"=="});return}if(Qe.includes("!=")){var fn=Qe.split("!="),dn=B()(fn,2),hn=dn[0],gn=dn[1];rn.push({name:hn,value:gn,operator:"!="});return}}),{role:We,node:nn,label:rn}}((M=o.Spec)===null||M===void 0||(M=M.TaskTemplate)===null||M===void 0?void 0:M.Placement),placement:((S=o.Spec)===null||S===void 0||(S=S.TaskTemplate)===null||S===void 0||(S=S.Placement)===null||S===void 0?void 0:S.Preferences)&&Object.entries((_=o.Spec)===null||_===void 0||(_=_.TaskTemplate)===null||_===void 0||(_=_.Placement)===null||_===void 0?void 0:_.Preferences).map(function(r){var Z,V;return{name:"spread",value:(Z=(V=r[1].Spread)===null||V===void 0?void 0:V.SpreadDescriptor)!==null&&Z!==void 0?Z:""}}),update:function(r,Z,V){return{parallelism:(Z=r==null?void 0:r.Parallelism)!==null&&Z!==void 0?Z:1,delay:(V=r==null?void 0:r.Delay)!==null&&V!==void 0?V:0,failureAction:r==null?void 0:r.FailureAction,order:r==null?void 0:r.Order}}((se=o.Spec)===null||se===void 0?void 0:se.UpdateConfig),healthcheck:function(r,Z,V,He,We,nn){var rn=r!=null&&(Z=r.Test)!==null&&Z!==void 0&&Z.includes("CMD-SHELL")?"CMD-SHELL":"CMD";return{interval:(V=r==null?void 0:r.Interval)!==null&&V!==void 0?V:30,timeout:(He=r==null?void 0:r.Timeout)!==null&&He!==void 0?He:10,retries:(We=r==null?void 0:r.Retries)!==null&&We!==void 0?We:3,cmd:r!=null&&r.Test?r==null||(nn=r.Test)===null||nn===void 0?void 0:nn.join(" "):"",shellType:rn}}((te=o.Spec)===null||te===void 0||(te=te.TaskTemplate)===null||te===void 0||(te=te.ContainerSpec)===null||te===void 0?void 0:te.Healthcheck)},ln=((Ue=o.Spec)===null||Ue===void 0?void 0:Ue.Labels)&&((en=o.Spec)===null||en===void 0?void 0:en.Labels[De.ev]);if(ln&&(an.imageRegistry=parseInt(ln)),(Je=o.Spec)!==null&&Je!==void 0&&(Je=Je.EndpointSpec)!==null&&Je!==void 0&&Je.Ports){var Ve;an.ports=(Ve=o.Spec)===null||Ve===void 0||(Ve=Ve.EndpointSpec)===null||Ve===void 0||(Ve=Ve.Ports)===null||Ve===void 0?void 0:Ve.map(function(r){var Z;return{dest:String(r.TargetPort),host:String((Z=r.PublishedPort)!==null&&Z!==void 0?Z:""),mode:r.PublishMode}})}(tn=Fe.current)===null||tn===void 0||tn.setFieldsValue(an),re(!0)}}});var _e=(0,s.useState)("basic"),ee=B()(_e,2),ie=ee[0],be=ee[1],Ke=new w.Uo("components.appForm"),$e=new w.Uo("swarm"),Fe=(0,s.useRef)(),ze=(0,s.useRef)(),ke=(0,s.useRef)(),C=(0,s.useRef)(),K=(0,s.useRef)(),X=(0,s.useState)(!1),J=B()(X,2),ve=J[0],re=J[1];return(0,i.jsx)(b.Z.Provider,{value:{createFormRef:Fe,volumeListRef:ze,createEnvRef:K,createLinkRef:C,domainRef:ke},children:(0,i.jsx)(fe.a,{drawerProps:{width:ye.R_,forceRender:n.forceRender,rootClassName:"createAppWapper"},formRef:Fe,title:$e.format("serviceCreateTitle"),onOpenChange:function(o){if(re(o),!o){var l,c;!((l=Fe.current)===null||l===void 0)&&l.resetFields&&((c=Fe.current)===null||c===void 0||c.resetFields()),be("basic")}},open:ve,trigger:n.showTrigger?(0,i.jsx)(he.ZP,{type:"primary",children:$e.format("serviceCreateTitle")}):void 0,onFinish:function(){var U=g()(f()().mark(function o(l){var c,p,x;return f()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return p={id:l.id,siteTitle:l.siteTitle,siteName:l.siteName,hostname:l.hostname,imageRegistry:l.imageRegistry,imageName:l.imageName,ports:l.ports,environment:l.environment,volumes:l.volumes,restartPolicy:l.restart,cpus:l.cpus,memory:l.memory,workDir:l.workDir&&!l.workDir.useDefault?l.workDir.value:"",user:l.user&&!l.user.useDefault?l.user.value:"",command:l.command&&!l.command.useDefault?l.command.value:"",entrypoint:l.entrypoint&&!l.entrypoint.useDefault?l.entrypoint.value:"",log:l.log,dns:l.dns,label:l.label,extraHosts:l.extraHosts,capAdd:l.capAdd,scheduling:l.scheduling,constraint:l.constraint,placement:l.placement,update:l.update},l.healthcheck&&l.healthcheck.cmd&&l.healthcheck.cmd!=""&&(p.healthcheck=l.healthcheck),p.scheduling&&((c=p.scheduling)===null||c===void 0?void 0:c.mode)=="global"&&p.ports&&(p.ports=(x=p.ports)===null||x===void 0?void 0:x.map(function(m){return m.mode="host",m})),R.next=5,(0,De.P3)(p);case 5:return n.onFinish&&n.onFinish(),R.abrupt("return",!0);case 7:case"end":return R.stop()}},o)}));return function(o){return U.apply(this,arguments)}}(),children:(0,i.jsxs)(z.Z,{direction:"column",gutter:[0,10],ghost:!0,children:[(0,i.jsxs)(z.Z,{ghost:!0,children:[(0,i.jsx)(A.Z,{name:"id",hidden:!0}),(0,i.jsx)(Oe.Z,{name:"siteTitle",label:w.FD.format("listDescription"),placeholder:$e.format("serviceCreateListDescriptionEmpty")}),(0,i.jsxs)(we.UW,{children:[(0,i.jsx)(Oe.Z,{width:"lg",name:"siteName",label:w.FD.format("listName"),required:!0,rules:[{required:!0}],placeholder:$e.format("serviceCreateListNameEmpty")}),(0,i.jsx)(Oe.Z,{label:"Hostname",name:"hostname",width:"md"})]}),(0,i.jsx)(qe,{})]}),(0,i.jsx)(Ce.Z,{offsetTop:10,target:function(){return document.querySelector(".createAppWapper .ant-drawer-body")},children:(0,i.jsx)(z.Z,{style:{margin:-20},children:(0,i.jsx)(L.Z,{activeKey:ie,onChange:function(o){be(o)},items:Ke.option("createTabOption",["basic","scheduling","run-command","cap"]).map(function(U){return{label:U.label,key:U.value}})})})}),(0,i.jsxs)(z.Z,{ghost:!0,children:[(0,i.jsxs)(de.Z,{show:ie=="basic",children:[(0,i.jsx)(le.Z,{showIngress:!0}),(0,i.jsx)(h.Z,{showAddButton:!0,showImportButton:!0,showCodeMode:!0,ref:K,drawerProps:{title:Ke.format("createEnvTitle")}}),(0,i.jsx)(q.Z,{showDefault:!0,ref:ze,showType:!0}),(0,i.jsx)(H.Z,{}),(0,i.jsx)(Ze.Z,{})]}),(0,i.jsxs)(de.Z,{show:ie=="scheduling",children:[(0,i.jsx)(Be,{}),(0,i.jsx)(E,{})]}),(0,i.jsxs)(de.Z,{show:ie=="run-command",children:[(0,i.jsx)(j,{}),(0,i.jsx)(u.Z,{showCommand:!0,showUser:!0,showWorkDir:!0}),(0,i.jsx)(ue.Z,{}),(0,i.jsx)(Ne.Z,{}),(0,i.jsx)(t.Z,{}),(0,i.jsx)(ce.Z,{})]}),(0,i.jsx)(de.Z,{show:ie=="cap",children:(0,i.jsx)(ae.Z,{})})]})]})})})}),F=N},94617:function(Ye,Te,e){e.d(Te,{Z:function(){return ke}});var Pe=e(97857),f=e.n(Pe),Le=e(15009),g=e.n(Le),I=e(99289),B=e.n(I),ye=e(5574),fe=e.n(ye),A=e(24494),he=e(5251),s=e(36146),H=e(86548),Ze=e(82061),ae=e(1883),h=e(42075),le=e(66309),q=e(25593),de=e(96074),z=e(83062),Oe=e(60940),we=e(37413),Ce=e(94359),L=e(67294),w=e(87662),b=e(78451),G=e(3616),Ee=e(33160),Ge=e(43425),i=e(57132),qe=e(71965),Me=e(45605),y=e(60433),$=e(38345),ge=e(97269),Se=e(24739),De=e(31199),Be=e(62370),ue=e(9773),Ne=e(64317),u=e(85265),j=e(86250),E=e(83622),t=e(84567),ce=e(26412),N=e(80821),F=e(76428),n=e(85893);function O(C){var K,X,J=new s.Uo("swarm"),ve=C.detail;if((K=ve.Spec)!==null&&K!==void 0&&(K=K.Mode)!==null&&K!==void 0&&K.Replicated){var re;return(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(le.Z,{children:J.format("listServiceMode.replicated")}),(0,n.jsx)(le.Z,{color:"success",bordered:!1,children:(re=ve.ServiceStatus)===null||re===void 0?void 0:re.RunningTasks}),(0,n.jsx)(le.Z,{color:"gold",bordered:!1,children:ve.Spec.Mode.Replicated.Replicas})]})}else if((X=ve.Spec)!==null&&X!==void 0&&(X=X.Mode)!==null&&X!==void 0&&X.Global)return(0,n.jsx)(le.Z,{children:J.format("listServiceMode.global")})}var _e=e(81146);function ee(C){var K=(0,L.useState)(!1),X=fe()(K,2),J=X[0],ve=X[1],re=(0,L.useRef)();return(0,n.jsxs)(n.Fragment,{children:[C.trigger?L.cloneElement(C.trigger,{onClick:function(){ve(!0)}}):null,(0,n.jsx)(u.Z,{title:"".concat(s.FD.format("listLog")," - ").concat(C.detail.name),open:J,forceRender:!0,onClose:function(){ve(!1)},afterOpenChange:function(o){if(o)setTimeout(function(){var c,p;(c=re.current)===null||c===void 0||c.start(),(p=re.current)===null||p===void 0||p.fit()},1e3);else{var l;(l=re.current)===null||l===void 0||l.close()}},width:G.FK,children:J&&(0,n.jsx)(_e.Z,{ref:re,showInDrawer:!0,id:"swarm:log:".concat(C.type,":").concat(C.detail.id),request:function(){var U=B()(g()().mark(function o(l){var c;return g()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,A.m8)({id:C.detail.id,type:C.type,lineTotal:l.lineTotal,download:(c=l.download)!==null&&c!==void 0?c:!1,showTime:l.showTime});case 2:case"end":return x.stop()}},o)}));return function(o){return U.apply(this,arguments)}}(),download:function(){var U=B()(g()().mark(function o(l){var c;return g()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,A.Id)({id:C.detail.id,type:C.type,lineTotal:l.lineTotal,showTime:l.showTime,download:!0});case 2:return c=x.sent,x.abrupt("return",{data:new Blob([c],{type:"text/plain"}),name:C.detail.name+"_"+new Date().toLocaleDateString()+".log"});case 4:case"end":return x.stop()}},o)}));return function(o){return U.apply(this,arguments)}}()})})]})}var ie=e(98093),be=e(67255),Ke=(0,L.forwardRef)(function(C,K){var X,J,ve,re,U,o,l,c,p,x,D,R,m;(0,L.useImperativeHandle)(K,function(){return{show:function(d){pe(d),k(!0)}}});var v=(0,L.useState)(!1),W=fe()(v,2),Q=W[0],k=W[1],Y=(0,L.useState)(),oe=fe()(Y,2),a=oe[0],pe=oe[1],ne=new s.Uo("swarm"),Ae=(0,L.useState)(""),me=fe()(Ae,2),Xe=me[0],je=me[1],xe=(0,L.useRef)(),Ie=(0,L.useRef)(),Re=(0,L.useRef)();return(0,L.useEffect)(function(){(0,w.K3)().then(function(T){var d;je((d=T.data.serverUrl)!==null&&d!==void 0?d:"")})},[]),(0,n.jsxs)(u.Z,{title:ne.format("serviceDetailTitle",{name:a==null||(X=a.Spec)===null||X===void 0?void 0:X.Name}),open:Q,forceRender:!0,width:G.R_,onClose:function(){k(!1),pe(void 0),C.onFinish&&C.onFinish()},extra:[a&&(0,n.jsx)(N.Z,{buttonProps:{type:"link",icon:(0,n.jsx)(Ee.Z,{})},tips:s.FD.format("listManageRefresh"),action:B()(g()().mark(function T(){var d,P;return g()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,A.ig)({id:a.ID});case 2:P=S.sent,pe(P.data.info),!((d=Re.current)===null||d===void 0)&&d.reloadAndRest&&Re.current.reloadAndRest();case 5:case"end":return S.stop()}},T)}))},"refresh")],children:[(0,n.jsx)(ie.Z,{forceRender:!0,ref:Ie,onFinish:B()(g()().mark(function T(){var d,P;return g()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,A.ig)({id:(d=a==null?void 0:a.ID)!==null&&d!==void 0?d:""});case 2:P=S.sent,pe(P.data.info);case 4:case"end":return S.stop()}},T)}))}),(0,n.jsxs)(j.Z,{vertical:!0,gap:20,children:[(0,n.jsx)($.Z,{title:(0,n.jsx)(Ge.Z,{}),ghost:!0,subTitle:s.FD.format("listManage"),children:(0,n.jsxs)(h.Z,{wrap:!0,children:[a&&(0,n.jsx)(E.ZP,{type:"primary",icon:(0,n.jsx)(H.Z,{}),onClick:function(){var d;(d=Ie.current)===null||d===void 0||d.edit(a)},children:s.FD.format("listManageEdit")}),(0,n.jsx)(de.Z,{type:"vertical"}),a&&(0,n.jsx)(ee,{type:"service",detail:{id:(J=a.ID)!==null&&J!==void 0?J:"",name:(ve=(re=a.Spec)===null||re===void 0?void 0:re.Name)!==null&&ve!==void 0?ve:""},trigger:(0,n.jsx)(E.ZP,{icon:(0,n.jsx)(ae.Z,{}),children:s.FD.format("listManageLog")},"log")}),(a==null||(U=a.Spec)===null||U===void 0||(U=U.Mode)===null||U===void 0?void 0:U.Replicated)&&(0,n.jsx)(N.Z,{buttonProps:{icon:(0,n.jsx)(i.Z,{})},confirmProps:{forceRender:!0,onOpenChange:function(d,P){var M,S;(M=xe.current)===null||M===void 0||M.setFieldsValue({replicas:(S=a.Spec)===null||S===void 0||(S=S.Mode)===null||S===void 0||(S=S.Replicated)===null||S===void 0?void 0:S.Replicas,force:!1})},description:(0,n.jsx)(ge.A,{layout:"inline",submitter:!1,formRef:xe,children:(0,n.jsxs)(h.Z,{direction:"vertical",size:[0,15],style:{width:600},children:[(0,n.jsx)(q.Z.Text,{children:ne.format("serviceManageScalingTip")}),(0,n.jsxs)(Se.UW,{children:[(0,n.jsx)(De.Z,{label:ne.format("serviceManageScalingReplicas"),width:"sm",name:"replicas"}),(0,n.jsx)(Be.Z,{name:"force",valuePropName:"checked",children:(0,n.jsxs)(t.Z,{children:[s.FD.format("listManageDeployForce"),"\uFF1F"]})})]})]})})},action:B()(g()().mark(function T(){var d,P,M;return g()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,A.x$)({name:(d=a==null?void 0:a.ID)!==null&&d!==void 0?d:"",replicas:(P=xe.current)===null||P===void 0?void 0:P.getFieldValue("replicas"),force:(M=xe.current)===null||M===void 0?void 0:M.getFieldValue("force")}));case 1:case"end":return _.stop()}},T)})),onSuccess:function(){(0,A.ig)({id:a.ID}).then(function(d){pe(d.data.info)})},children:s.FD.format("listManageScaling")}),a&&(0,n.jsx)(N.Z,{action:function(){return(0,A.x$)({name:a.ID,rollback:!0})},buttonProps:{icon:(0,n.jsx)(qe.Z,{})},confirmProps:{showCommonConfirm:!0},children:s.FD.format("listManageRollback")}),(0,n.jsx)(N.Z,{showDivider:!0,action:function(){var d;return(0,A.tm)({name:[(d=a==null?void 0:a.ID)!==null&&d!==void 0?d:""]})},buttonProps:{type:"primary",danger:!0,icon:(0,n.jsx)(Ze.Z,{})},confirmProps:{showCommonConfirm:!0},onSuccess:function(d){k(!1),C.onFinish&&C.onFinish()},children:s.FD.format("listManageDelete")})]})}),a&&(0,n.jsx)(we.Z,{publicPort:((o=a.Endpoint)===null||o===void 0?void 0:o.Ports)&&((l=a.Endpoint)===null||l===void 0?void 0:l.Ports.map(function(T){var d,P,M;return{PrivatePort:(d=T.TargetPort)!==null&&d!==void 0?d:0,Type:(P=T.Protocol)!==null&&P!==void 0?P:"tcp",IP:"",PublicPort:(M=T.PublishedPort)!==null&&M!==void 0?M:0}})),serverIp:Xe,showInDetail:!0,ghost:!0,layout:"inline"}),(0,n.jsx)($.Z,{title:(0,n.jsx)(Me.Z,{}),subTitle:s.FD.format("listManageDetail"),ghost:!0,children:(0,n.jsxs)(ce.Z,{column:1,bordered:!0,styles:{label:{width:150}},children:[(0,n.jsxs)(ce.Z.Item,{label:s.FD.format("listTitle"),children:[(0,n.jsx)(F.Z,{title:a==null?void 0:a.ID})," - ",a==null||(c=a.Spec)===null||c===void 0?void 0:c.Name,a&&((p=a.UpdateStatus)===null||p===void 0?void 0:p.State)&&(0,n.jsxs)(n.Fragment,{children:[" - ",(0,n.jsx)(Ce.Z,{status:"service.".concat((x=a.UpdateStatus)===null||x===void 0?void 0:x.State)})]})]}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listDescription"),children:(a==null||(D=a.Spec)===null||D===void 0?void 0:D.Labels)&&a.Spec.Labels[A.$m]}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listRunTask"),children:(0,n.jsx)(h.Z,{children:(a==null?void 0:a.ServiceStatus)&&Object.keys(a.ServiceStatus).map(function(T){var d=T;return(a==null?void 0:a.ServiceStatus)&&(0,n.jsx)(z.Z,{title:ne.format("listServiceStatusTipOption.".concat(d)),children:(0,n.jsxs)(le.Z,{color:ne.format("listServiceStatusColorOption.".concat(d)),bordered:!1,children:[ne.format("listServiceStatusOption.".concat(d))," ",a==null?void 0:a.ServiceStatus[d]]})},d)})})}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listServiceMode"),children:a&&(0,n.jsx)(O,{detail:a})}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listImageName"),children:a==null||(R=a.Spec)===null||R===void 0||(R=R.TaskTemplate)===null||R===void 0||(R=R.ContainerSpec)===null||R===void 0?void 0:R.Image}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listVersion"),children:a==null||(m=a.Version)===null||m===void 0?void 0:m.Index}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listCreatedAt"),children:(0,he.NF)(a==null?void 0:a.CreatedAt)}),(0,n.jsx)(ce.Z.Item,{label:s.FD.format("listUpdatedAt"),children:(0,he.NF)(a==null?void 0:a.UpdatedAt)})]})}),a&&(0,n.jsx)($.Z,{title:(0,n.jsx)(y.Z,{}),subTitle:ne.format("listTaskTitle"),ghost:!0,children:(0,n.jsx)(ue.Z,{scroll:{x:"max-content"},rowKey:"ID",search:{filterType:"light"},actionRef:Re,columns:[{search:!1,title:s.FD.format("listName"),render:function(d,P,M,S,_){return P.ID}},{search:!1,width:200,title:s.FD.format("listNodeName"),render:function(d,P,M,S,_){return P.NodeID}},{search:!1,width:50,title:s.FD.format("listSlot"),render:function(d,P,M,S,_){return P.Slot}},{key:"status",renderFormItem:function(d,P,M,S){return(0,n.jsx)(Ne.Z,{name:"status",valueEnum:Object.fromEntries(ne.option("listTaskStatusOption",["running","shutdown","accepted"]).map(function(_){return[_.value,_.label]}))})},width:120,title:s.FD.format("listRunStatus"),render:function(d,P,M){var S;if(P.Status.State!="running"){var _;return(0,n.jsx)(Ce.Z,{status:"task.".concat(P.Status.State),tip:(_=P.Status.Err)!==null&&_!==void 0?_:P.Status.Message})}return(0,n.jsx)(Ce.Z,{status:"task.".concat(P.DesiredState),tip:(S=P.Status.Err)!==null&&S!==void 0?S:P.Status.Message})}},{search:!1,width:180,title:s.FD.format("listUpdatedAt"),render:function(d,P,M,S,_){return(0,he.NF)(P.UpdatedAt)}},{search:!1,width:100,title:s.FD.format("listManage"),fixed:"right",render:function(d,P,M,S,_){var se,te;return(0,n.jsx)(h.Z,{children:(0,n.jsx)(ee,{type:"node",detail:{id:(se=P.ID)!==null&&se!==void 0?se:"",name:(te=P.ID)!==null&&te!==void 0?te:""},trigger:(0,n.jsx)(q.Z.Link,{children:(0,n.jsx)(ae.Z,{})})})})}}],request:function(){var T=B()(g()().mark(function d(P){var M,S;return g()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,(0,A.XX)({serviceName:a==null?void 0:a.ID,status:P.status});case 2:return M=se.sent,se.next=5,(0,A.HN)();case 5:return S=se.sent,se.abrupt("return",{data:M.data.list.map(function(te){var Ue,en=S&&((Ue=S.data.list.find(function(Je){return Je.ID==te.NodeID}))===null||Ue===void 0||(Ue=Ue.Description)===null||Ue===void 0?void 0:Ue.Hostname);return en&&(te.NodeID=en),te}),success:!0,total:M.data.list.length});case 7:case"end":return se.stop()}},d)}));return function(d){return T.apply(this,arguments)}}(),pagination:(0,be.Oh)()})})]})]})}),$e=Ke,Fe=e(98510),ze=(0,L.forwardRef)(function(C,K){(0,L.useImperativeHandle)(K,function(){return{reload:function(){var c;!((c=o.current)===null||c===void 0)&&c.reloadAndRest&&o.current.reloadAndRest()}}});var X=(0,L.useState)(""),J=fe()(X,2),ve=J[0],re=J[1],U=(0,L.useRef)(),o=(0,L.useRef)();return(0,L.useEffect)(function(){(0,w.K3)().then(function(l){var c;re((c=l.data.serverUrl)!==null&&c!==void 0?c:"")})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)($e,{ref:U,onFinish:function(){var c;!((c=o.current)===null||c===void 0)&&c.reloadAndRest&&o.current.reloadAndRest()}}),(0,n.jsx)(Fe.C,f()(f()({},C.tableProps),{},{actionRef:o,rowKey:"ID",columns:[{key:"serviceName",title:s.FD.format("listServiceName"),render:function(c,p,x,D,R){var m,v=0;return p.Task&&p.Task.forEach(function(W){W.Status.State=="running"&&(v+=1)}),(0,n.jsxs)(h.Z,{children:[p.Task&&(0,n.jsx)(le.Z,{color:"success",bordered:!1,children:v}),(0,n.jsx)(q.Z.Link,{onClick:function(){var Q;(Q=U.current)===null||Q===void 0||Q.show(p)},children:(m=p.Spec)===null||m===void 0?void 0:m.Name})]})}},{width:150,search:!1,title:s.FD.format("listPort"),render:function(c,p,x,D,R){var m,v,W=[];return!((m=p.Endpoint)===null||m===void 0)&&m.Ports&&((v=p.Endpoint)===null||v===void 0||v.Ports.map(function(Q){var k,Y,oe;W.push({PrivatePort:(k=Q.TargetPort)!==null&&k!==void 0?k:0,Type:(Y=Q.Protocol)!==null&&Y!==void 0?Y:"tcp",IP:"0.0.0.0",PublicPort:(oe=Q.PublishedPort)!==null&&oe!==void 0?oe:0})})),(0,n.jsx)(we.Z,{ghost:!0,publicPort:W,serverIp:ve})}},{width:150,search:!1,title:s.FD.format("listServiceMode"),render:function(c,p,x,D,R){return(0,n.jsx)(O,{detail:p})}},{hidden:!C.showImageName,width:400,search:!1,title:s.FD.format("listImageName"),render:function(c,p,x,D,R){var m,v=((m=p.Spec)===null||m===void 0||(m=m.TaskTemplate)===null||m===void 0||(m=m.ContainerSpec)===null||m===void 0?void 0:m.Image)||"",W=v.includes("@")?v.split("@"):[v,null],Q=fe()(W,2),k=Q[0],Y=Q[1];return(0,n.jsx)(b.Z,{children:k})}},{search:!1,width:180,title:s.FD.format("listCreatedAt"),render:function(c,p,x,D,R){return(0,he.NF)(p.CreatedAt)}},{search:!1,width:180,title:s.FD.format("listUpdatedAt"),render:function(c,p,x,D,R){return(0,he.NF)(p.UpdatedAt)}},{hidden:!C.showManage,search:!1,title:s.FD.format("listManage"),width:100,fixed:"right",render:function(c,p,x,D,R){return(0,n.jsx)(h.Z,{split:(0,n.jsx)(de.Z,{type:"vertical"}),children:C.showManage&&C.showManage.onEdit&&(0,n.jsx)(q.Z.Link,{onClick:function(){var v;!((v=C.showManage)===null||v===void 0)&&v.onEdit&&C.showManage.onEdit(p)},children:(0,n.jsx)(z.Z,{title:s.FD.format("listManageEdit"),children:(0,n.jsx)(H.Z,{})})},"edit")})}}],request:function(){var l=B()(g()().mark(function c(p){var x,D,R;return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!C.showWithNodeId){v.next=7;break}return v.next=3,(0,A.rN)({nodeId:(x=C.showWithNodeId)!==null&&x!==void 0?x:""});case 3:return D=v.sent,v.abrupt("return",{data:D.data.list,total:D.data.list.length,success:!0});case 7:return v.next=9,(0,A.kM)({name:p.serviceName});case 9:return R=v.sent,v.abrupt("return",{data:R.data.list,total:R.data.list.length,success:!0});case 11:case"end":return v.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),quickToolbarRender:function(c){var p=c.selectedRows,x=c.finish,D=c.loading;return[(0,n.jsx)(N.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,n.jsx)(Ze.Z,{})},action:B()(g()().mark(function R(){return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return D(),v.abrupt("return",(0,A.tm)({name:p.map(function(W){return W.ID})}).finally(function(){x(!0)}));case 2:case"end":return v.stop()}},R)})),onSuccess:function(){var m,v;return!((m=o.current)===null||m===void 0)&&m.reloadAndRest&&((v=o.current)===null||v===void 0||v.reloadAndRest()),!0},onError:function(){var m,v;return!((m=o.current)===null||m===void 0)&&m.reset&&((v=o.current)===null||v===void 0||v.reset()),!0},confirmProps:{showCommonConfirm:!0},children:s.FD.format("listManageDeleteBatch")})]},expandable:C.showWithNodeId?{expandRowByClick:!0,rowExpandable:function(c){return c.Task&&c.Task.length>0&&c.Task.filter(function(p){return p.Status.State=="running"}).length>0},expandedRowRender:function(c){return(0,n.jsx)(Oe.Z,{rowKey:"ID",columns:[{title:s.FD.format("listName"),render:function(x,D,R){return D.ID}},{width:120,title:s.FD.format("listRunStatus"),render:function(x,D,R){var m;return(0,n.jsx)(Ce.Z,{status:"task.".concat(D.Status.State),tip:(m=D.Status.Err)!==null&&m!==void 0?m:D.Status.Message})}},{title:s.FD.format("listUpdatedAt"),width:180,render:function(x,D,R){return(0,he.NF)(D.UpdatedAt)}},{width:100,title:s.FD.format("listManage"),fixed:"right",render:function(x,D,R){var m,v;return(0,n.jsx)(h.Z,{children:(0,n.jsx)(ee,{type:"node",detail:{id:(m=D.ID)!==null&&m!==void 0?m:"",name:(v=D.ID)!==null&&v!==void 0?v:""},trigger:(0,n.jsx)(q.Z.Link,{children:(0,n.jsx)(ae.Z,{})})})})}}],pagination:!1,dataSource:c.Task.filter(function(p){return p.Status.State=="running"})})}}:void 0}),"service-list")]})}),ke=ze},76428:function(Ye,Te,e){e.d(Te,{Z:function(){return g}});var Pe=e(25593),f=e(67294),Le=e(85893);function g(I){return(0,Le.jsx)(Pe.Z.Text,{copyable:!0,children:I.title})}},12323:function(Ye,Te,e){e.d(Te,{X:function(){return Pe},n:function(){return f}});var Pe={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},f=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},24494:function(Ye,Te,e){e.d(Te,{$m:function(){return B},HN:function(){return le},Id:function(){return ae},JC:function(){return fe},P3:function(){return De},QB:function(){return Ce},UK:function(){return he},XX:function(){return G},Zc:function(){return de},ev:function(){return ye},ig:function(){return ue},kM:function(){return qe},kp:function(){return w},m8:function(){return H},rN:function(){return Ge},tm:function(){return ge},vb:function(){return Oe},x$:function(){return y}});var Pe=e(15009),f=e.n(Pe),Le=e(99289),g=e.n(Le),I=e(82346),B="com.dpanel.swarm.service.description",ye="com.dpanel.swarm.service.registry";function fe(){return A.apply(this,arguments)}function A(){return A=g()(f()().mark(function u(){return f()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/info",{method:"POST"}));case 1:case"end":return E.stop()}},u)})),A.apply(this,arguments)}function he(u){return s.apply(this,arguments)}function s(){return s=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/init",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),s.apply(this,arguments)}function H(u){return Ze.apply(this,arguments)}function Ze(){return Ze=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return j.id=String(j.id),t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/log",{method:"POST",data:j}));case 2:case"end":return t.stop()}},u)})),Ze.apply(this,arguments)}function ae(u){return h.apply(this,arguments)}function h(){return h=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return j.download=!0,j.id=String(j.id),t.next=4,(0,I.request)("/dpanel/api/app/swarm/log",{method:"POST",data:j,responseType:"blob"});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},u)})),h.apply(this,arguments)}function le(u){return q.apply(this,arguments)}function q(){return q=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/node-list",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),q.apply(this,arguments)}function de(u){return z.apply(this,arguments)}function z(){return z=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/node-update",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),z.apply(this,arguments)}function Oe(u){return we.apply(this,arguments)}function we(){return we=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/info-join",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),we.apply(this,arguments)}function Ce(u){return L.apply(this,arguments)}function L(){return L=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/node-remove",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),L.apply(this,arguments)}function w(u){return b.apply(this,arguments)}function b(){return b=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/node-prune",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),b.apply(this,arguments)}function G(u){return Ee.apply(this,arguments)}function Ee(){return Ee=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/task-list",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),Ee.apply(this,arguments)}function Ge(u){return i.apply(this,arguments)}function i(){return i=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/task-list-in-node",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),i.apply(this,arguments)}function qe(u){return Me.apply(this,arguments)}function Me(){return Me=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/service-list",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),Me.apply(this,arguments)}function y(u){return $.apply(this,arguments)}function $(){return $=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/service-scaling",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),$.apply(this,arguments)}function ge(u){return Se.apply(this,arguments)}function Se(){return Se=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/service-delete",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),Se.apply(this,arguments)}function De(u){return Be.apply(this,arguments)}function Be(){return Be=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/service-create",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),Be.apply(this,arguments)}function ue(u){return Ne.apply(this,arguments)}function Ne(){return Ne=g()(f()().mark(function u(j){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,I.request)("/dpanel/api/app/swarm/service-detail",{method:"POST",data:j}));case 1:case"end":return t.stop()}},u)})),Ne.apply(this,arguments)}}}]);
