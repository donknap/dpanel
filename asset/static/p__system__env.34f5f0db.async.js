"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1180],{44349:function(ee,F,e){var Y=e(97857),j=e.n(Y),J=e(15009),L=e.n(J),Q=e(99289),V=e.n(Q),X=e(74763),C=e(17186),k=e(5966),N=e(86250),p=e(67294),R=e(85893),$=(0,p.forwardRef)(function(s,G){var P=(0,p.useRef)();(0,p.useImperativeHandle)(G,function(){return{addItem:function(T){function t(l,M,n){return T.apply(this,arguments)}return t.toString=function(){return T.toString()},t}(function(T,t,l){var M,n=(M=P.current)===null||M===void 0?void 0:M.getList(),a;if(n==null||n.forEach(function(K,Z){K[T]==t[T]&&(a=Z)}),!(0,X.k)(a)&&l){var x;(x=P.current)===null||x===void 0||x.remove(a),a=void 0}if(!a){var u;(u=P.current)===null||u===void 0||u.add(t)}}),removeItemByKey:function(t,l){return V()(L()().mark(function M(){var n,a;return L()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=(n=P.current)===null||n===void 0?void 0:n.getList(),a==null||a.forEach(function(K,Z){if(K[t]==l){var S;(S=P.current)===null||S===void 0||S.remove(Z);return}}),u.abrupt("return");case 3:case"end":return u.stop()}},M)}))()},clear:function(t){if(!t){var l;t=(l=P.current)===null||l===void 0||(l=l.getList())===null||l===void 0?void 0:l.map(function(n,a){return a})}if(t){var M;(M=P.current)===null||M===void 0||M.remove(t)}},getList:function(){var t;return(t=P.current)===null||t===void 0?void 0:t.getList()}}});var y={};return s.hideCopyButton===!0&&(y.copyIconProps=!1),s.hideDeleteButton===!0&&(y.deleteIconProps=!1),(0,R.jsx)(C.u,j()(j()({initialValue:s.initialValue,label:s.label,name:s.name,actionRef:P,creatorButtonProps:s.showAddButton?{creatorButtonText:s.label?s.label:s.showAddButtonLabel?s.showAddButtonLabel:s.name}:!1,min:s.min?s.min:0},y),{},{children:function(t,l,M){return(0,R.jsx)(N.Z,{justify:s.justify,gap:s.gap,children:s.items.map(function(n){return n.render?(0,R.jsx)("div",{children:n.render&&n.render(t,l,M)},"".concat(s.name,"-").concat(n.name,"-").concat(t.key)):(0,R.jsx)(k.Z,{width:n.width,name:n.name,label:n.label,required:n.required,rules:[{required:n.required}],disabled:n.disabled,placeholder:n.placeholder},"".concat(s.name,"-").concat(n.name,"-").concat(t.key))})})}}))});F.Z=$},36435:function(ee,F,e){var Y=e(15009),j=e.n(Y),J=e(64599),L=e.n(J),Q=e(99289),V=e.n(Q),X=e(9783),C=e.n(X),k=e(5574),N=e.n(k),p=e(67294),R=e(184),$=e(38345),s=e(97269),G=e(97321),P=e(97462),y=e(64317),T=e(5966),t=e(86615),l=e(68602),M=e(83622),n=e(83403),a=e(24963),x=e(1699),u=e(29177),K=e(1883),Z=e(43425),S=e(44349),ne=e(3616),w=e(36146),d=e(85893),H=(0,p.forwardRef)(function(b,ae){var B=(0,p.useState)(!1),D=N()(B,2),E=D[0],o=D[1],A=(0,p.useRef)(),W=(0,p.useContext)(a.Z),h=W.message,r=(0,p.useState)([]),z=N()(r,2),q=z[0],te=z[1],U=new w.Uo("components.permissionButton"),re=C()(C()(C()(C()(C()({},n.W6.CONTAINER,"Id"),n.W6.APPSTORE,"name"),n.W6.COMPOSE,"name"),n.W6.REGISTRY,"serverAddress"),n.W6.DOCKER_ENV,"name"),oe=C()(C()(C()(C()(C()({},n.W6.CONTAINER,"name"),n.W6.APPSTORE,"name"),n.W6.COMPOSE,"name"),n.W6.REGISTRY,"title"),n.W6.DOCKER_ENV,"title"),_e=re[b.type],le=oe[b.type],ue=b.selected.map(function(i){return i[re[b.type]]});return p.useEffect(function(){if(E){if(!b.selected||b.selected.length==0){h.error(w.FD.format("title.noDataSelect")),o(!1);return}(0,l.dP)({permission:{uri:b.type,key:_e,value:ue}}).then(function(i){var _;(_=A.current)===null||_===void 0||_.setFieldValue("list",Object.keys(i.data.list).map(function(m){return{name:m,type:i.data.list[m].type,users:i.data.list[m].users}}))}),(0,l.lE)().then(function(i){var _,m=(_=i.data)===null||_===void 0||(_=_.list)===null||_===void 0?void 0:_.map(function(c){return{label:c.username,value:c.username}});te(m)})}},[E]),(0,d.jsx)(x.u,{access:["canSeeEnableEe","canSeeFounder","canSeeManage"],children:(0,d.jsxs)(R.a,{name:"create",title:U.format("drawerTitle"),open:E,onOpenChange:function(_){if(!_){var m;(m=A.current)===null||m===void 0||m.resetFields()}o(_)},drawerProps:{forceRender:!0,width:ne.R_},formRef:A,trigger:(0,d.jsx)(M.ZP,{icon:(0,d.jsx)(u.Z,{}),children:U.format("drawerTriggerButton")}),onFinish:function(){var i=V()(j()().mark(function _(m){var c,O,v;return j()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:c=L()(m.list),f.prev=1,c.s();case 3:if((O=c.n()).done){f.next=9;break}return v=O.value,f.next=7,(0,l.Db)({usernames:v.users,permissionType:v.type,permission:{uri:b.type,key:_e,showKey:le,value:[v.name]}});case 7:f.next=3;break;case 9:f.next=14;break;case 11:f.prev=11,f.t0=f.catch(1),c.e(f.t0);case 14:return f.prev=14,c.f(),f.finish(14);case 17:h.success(w.FD.format("finish")),o(!1),b.onSuccess();case 20:case"end":return f.stop()}},_,null,[[1,11,14,17]])}));return function(_){return i.apply(this,arguments)}}(),children:[(0,d.jsxs)($.Z,{ghost:!0,title:(0,d.jsx)(K.Z,{}),subTitle:U.format("batchTitle"),children:[(0,d.jsx)(s.A.Item,{name:"type",style:{marginBottom:0},children:(0,d.jsx)(G.Z.Group,{defaultValue:"admin",onChange:function(_){var m,c,O=(m=A.current)===null||m===void 0?void 0:m.getFieldValue("list");O.forEach(function(v){v.type=_,v.users=[]}),(c=A.current)===null||c===void 0||c.setFieldValue("list",O)},children:["admin","restricted","public"].map(function(i){return(0,d.jsx)(G.Z,{style:{width:240},title:U.format("dataTypeOption.".concat(i)),description:U.format("dataTypeDescOption.".concat(i)),value:i},i)})})}),(0,d.jsx)(P.Z,{name:["type"],children:function(_){var m=_.type;if(m==="restricted")return(0,d.jsx)(y.Z,{mode:"multiple",name:"usernames",label:U.format("formUsernames"),onChange:function(O){var v,g,f=(v=A.current)===null||v===void 0?void 0:v.getFieldValue("list");f.forEach(function(I){I.users=O}),(g=A.current)===null||g===void 0||g.setFieldValue("list",f)},rules:[{required:!0}],request:V()(j()().mark(function c(){var O,v,g;return j()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!(q.length>0)){I.next=2;break}return I.abrupt("return",q);case 2:return I.next=4,(0,l.lE)();case 4:return v=I.sent,g=(O=v.data)===null||O===void 0||(O=O.list)===null||O===void 0?void 0:O.map(function(se){return{label:se.username,value:se.username}}),te(g),I.abrupt("return",g);case 8:case"end":return I.stop()}},c)}))})}})]}),(0,d.jsx)($.Z,{ghost:!0,title:(0,d.jsx)(Z.Z,{}),subTitle:U.format("dataTitle"),children:(0,d.jsx)(S.Z,{name:"list",hideCopyButton:!0,gap:10,items:[{name:"name",label:U.format("dataName"),render:function(_,m,c){var O=c.getCurrentRowData();return(0,d.jsx)(T.Z,{disabled:!0,label:U.format("dataName"),width:"sm",name:"name"})}},{name:"type",label:U.format("dataType"),render:function(_,m,c){var O=c.getCurrentRowData();return(0,d.jsx)(t.Z.Group,{label:U.format("dataType"),name:"type",radioType:"button",options:["admin","public","restricted"].map(function(v){return{label:U.format("dataTypeOption.".concat(v)),value:v}})})}},{name:"users",label:U.format("dataUsers"),render:function(_,m,c){return(0,d.jsx)(P.Z,{name:["type"],children:function(v){var g=v.type;if(g=="restricted")return(0,d.jsx)(y.Z,{width:"sm",mode:"tags",name:"users",label:U.format("dataUsers"),options:q})}})}}]})})]})})});F.Z=H},98163:function(ee,F,e){e.r(F),e.d(F,{default:function(){return x}});var Y=e(15009),j=e.n(Y),J=e(99289),L=e.n(J),Q=e(80821),V=e(77273),X=e(36435),C=e(98510),k=e(83403),N=e(24963),p=e(87662),R=e(36146),$=e(86548),s=e(82061),G=e(74453),P=e(82346),y=e(83622),T=e(42075),t=e(96074),l=e(25593),M=e(83062),n=e(67294),a=e(85893);function x(){var u=(0,n.useRef)(),K=(0,n.useRef)(),Z=(0,P.useModel)("@@initialState"),S=Z.refresh,ne=Z.initialState,w=(0,n.useContext)(N.Z),d=w.message,H=(0,P.useLocation)(),b=(0,P.useNavigate)(),ae=new R.Uo("system.env");return(0,n.useEffect)(function(){var B=H.state;B&&(b(".",{replace:!0}),B&&B.name&&(0,p.Kg)({enableCertContent:!0}).then(function(D){var E,o=D.data.list.find(function(A){return A.name==B.name});o&&((E=K.current)===null||E===void 0||E.edit(o))}))},[H.state]),(0,a.jsx)(G._z,{header:{extra:[(0,a.jsx)(V.Z,{trigger:(0,a.jsx)(y.ZP,{type:"primary",children:ae.format("createButton")}),ref:K,onFinish:L()(j()().mark(function B(){var D,E,o;return j()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(o=H.state,!(o&&o.item)){W.next=6;break}return W.next=4,(0,p.vC)({name:o.item.name});case 4:return b(H.pathname,{replace:!0,state:null}),W.abrupt("return");case 6:S(),!((D=u.current)===null||D===void 0)&&D.reloadAndRest&&((E=u.current)===null||E===void 0||E.reloadAndRest());case 8:case"end":return W.stop()}},B)}))},"dockerEnvCreate")]},children:(0,a.jsx)(C.C,{rowKey:"name",columns:[{title:R.FD.format("listName"),dataIndex:"name"},{title:R.FD.format("listTitle"),dataIndex:"title"},{title:R.FD.format("listTargetAddress"),dataIndex:"address"},{title:R.FD.format("listManage"),width:50,search:!1,render:function(D,E,o,A,W){return(0,a.jsx)(T.Z,{split:(0,a.jsx)(t.Z,{type:"vertical"}),children:(0,a.jsx)(l.Z.Link,{onClick:function(){var r;(r=K.current)===null||r===void 0||r.edit(E)},children:(0,a.jsx)(M.Z,{title:R.FD.format("listManageEdit"),children:(0,a.jsx)($.Z,{})})},E.name)})}}],pagination:!1,request:L()(j()().mark(function B(){var D;return j()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,p.Kg)({enableCertContent:!0});case 2:return D=o.sent,o.abrupt("return",{data:D.data.list,total:D.data.list.length});case 4:case"end":return o.stop()}},B)})),search:!1,actionRef:u,quickToolbarRender:function(D){var E=D.selectedRows,o=D.finish,A=D.loading;return(0,a.jsxs)(T.Z,{size:16,children:[(0,a.jsx)(X.Z,{type:k.W6.DOCKER_ENV,selected:E,onSuccess:function(){var h,r;return!((h=u.current)===null||h===void 0)&&h.reloadAndRest&&((r=u.current)===null||r===void 0||r.reloadAndRest()),!0}},"permissionButton"),(0,a.jsx)(Q.Z,{buttonProps:{danger:!0,type:"primary",icon:(0,a.jsx)(s.Z,{})},action:L()(j()().mark(function W(){return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!E.find(function(z){return z.default})){r.next=3;break}return d.warning(R.FD.format("systemEnvDefaultCannotDelete")),r.abrupt("return",!1);case 3:return A(),r.abrupt("return",(0,p._g)({name:E.map(function(z){return z.name})}).finally(function(){o(!0)}));case 5:case"end":return r.stop()}},W)})),onSuccess:function(){var h,r;return!((h=u.current)===null||h===void 0)&&h.reloadAndRest&&((r=u.current)===null||r===void 0||r.reloadAndRest()),!0},onError:function(){var h,r;return!((h=u.current)===null||h===void 0)&&h.reset&&((r=u.current)===null||r===void 0||r.reset()),!0},confirmProps:{showCommonConfirm:!0},children:R.FD.format("listManageDeleteBatch")})]})}})})}}}]);
