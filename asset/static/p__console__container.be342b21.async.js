(self.webpackChunk=self.webpackChunk||[]).push([[9969],{49610:function(I,f,t){"use strict";var s=t(5574),d=t.n(s),b=t(12323),r=t(52626),C=t(87662),_=t(78267),o=t.n(_),y=t(4244),M=t.n(y),T=t(24078),h=t(67294),w=t(85893),a,g,u,D,O=(0,h.forwardRef)(function(K,A){var S,R=(0,h.useState)(),B=d()(R,2),j=B[0],W=B[1],L=(0,h.useState)(""),n=d()(L,2),i=n[0],p=n[1];function e(){D&&(a.reset(),g.fit(),a.focus(),D.dispose()),u&&(u.close(),u=null)}return(0,h.useImperativeHandle)(A,function(){return{start:function(c,l){e(),g.fit(),l.width=a.cols,l.height=a.rows;var P=l?Object.keys(l).filter(function(E){return l&&l[E]}).map(function(E){return l&&l[E]?"".concat(E,"=").concat(l[E]):""}):[];u=new WebSocket((0,r.R)(c+"?"+P.join("&"))),u.addEventListener("message",function(E){var v=JSON.parse(E.data),U=v.type;if(U===c&&(a.write(v.data),v.data.indexOf("exec failed")!==-1)){e();return}}),D=a.onData(function(E){var v={content:{command:E},type:c};u&&u.send(JSON.stringify(v))}),p(c),W(l)},close:function(){e()},fit:function(){return g.fit(),{width:a.cols,height:a.rows}},run:function(c){j&&(c==null||c.forEach(function(l){var P={content:{command:l+`
`},type:i};u&&u.send(JSON.stringify(P))}))}}}),(0,h.useEffect)(function(){return a=new y.Terminal(b.X),g=new _.FitAddon,a.loadAddon(g),a.open(document.getElementById("terminal-container-console")),g.fit(),a.onKey(function(m){var c=m.domEvent;if(c.ctrlKey&&c.key==="c"){var l=a.getSelection();if(l){navigator.clipboard.writeText(l).then(function(){a.clearSelection()}),c.preventDefault();return}}c.ctrlKey&&c.key==="v"&&(navigator.clipboard.readText().then(function(P){P&&a.input(P)}),c.preventDefault())}),(0,C.pe)({groupName:"setting",name:"themeConsoleConfig"}).then(function(m){m.data&&m.data.fontSize&&Object.assign(a.options,m.data)}),function(){e()}},[]),(0,h.useEffect)(function(){window.addEventListener("resize",function(){g.fit();var m={size:{width:a.cols,height:a.rows},type:i};i&&u&&u.send(JSON.stringify(m))})},[i]),(0,w.jsx)("div",{style:{height:(S=K.height)!==null&&S!==void 0?S:"100vh"},id:"terminal-container-console"})});f.Z=O},12323:function(I,f,t){"use strict";t.d(f,{X:function(){return s},n:function(){return d}});var s={convertEol:!0,fontFamily:'Menlo, Monaco, "Courier New", monospace',fontWeight:400,fontSize:16,lineHeight:1,cursorStyle:"block",cursorInactiveStyle:"outline",cursorBlink:!0,letterSpacing:0,theme:{foreground:"#bfbfbf",cursor:"gray",selectionForeground:"#ffffff"}},d=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"]},15563:function(I,f,t){"use strict";t.r(f),t.d(f,{default:function(){return M}});var s=t(5574),d=t.n(s),b=t(49610),r=t(13822),C=t(5251),_=t(63713),o=t(67294),y=t(85893);function M(){var T=(0,_.useParams)(),h=(0,_.useSearchParams)(),w=d()(h,2),a=w[0],g=w[1],u=(0,o.useRef)();return(0,o.useEffect)(function(){T.id&&(0,r.jV)({md5:T.id}).then(function(D){var O;window.document.title="".concat((0,C.fi)(D.data.info.Name,"/")," - console"),T.id&&((O=u.current)===null||O===void 0||O.start("/console/container/".concat(D.data.info.Id),{cmd:a.get("cmd"),workDir:a.get("workDir")}))}),document.body.style.overflow="hidden"},[]),(0,y.jsx)(b.Z,{ref:u})}},13822:function(I,f,t){"use strict";t.d(f,{IE:function(){return T},IW:function(){return y},KK:function(){return D},LJ:function(){return K},RF:function(){return B},Re:function(){return S},aF:function(){return W},eE:function(){return g},jV:function(){return w}});var s=t(5574),d=t.n(s),b=t(15009),r=t.n(b),C=t(99289),_=t.n(C),o=t(63713);function y(n){return M.apply(this,arguments)}function M(){return M=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/status",{method:"POST",data:i}));case 1:case"end":return e.stop()}},n)})),M.apply(this,arguments)}function T(n){return h.apply(this,arguments)}function h(){return h=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-list",{data:i,method:"POST"}));case 1:case"end":return e.stop()}},n)})),h.apply(this,arguments)}function w(n){return a.apply(this,arguments)}function a(){return a=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/get-detail",{data:i,method:"POST"}));case 1:case"end":return e.stop()}},n)})),a.apply(this,arguments)}function g(n){return u.apply(this,arguments)}function u(){return u=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/update",{data:i,method:"POST"}));case 1:case"end":return e.stop()}},n)})),u.apply(this,arguments)}function D(){return O.apply(this,arguments)}function O(){return O=_()(r()().mark(function n(){return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,o.request)("/dpanel/api/app/container/prune",{method:"POST"}));case 1:case"end":return p.stop()}},n)})),O.apply(this,arguments)}function K(n){return A.apply(this,arguments)}function A(){return A=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.enableExportToPath){e.next=2;break}return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/export",{method:"GET",params:i}));case 2:return e.abrupt("return",new Promise(function(m,c){var l=localStorage.getItem("token"),P=new URLSearchParams;P.append("token",l||""),Object.entries(i).forEach(function(U){var x=d()(U,2),N=x[0],$=x[1];P.append(N,String($))});var E="/dpanel/api/app/container/export?".concat(P.toString()),v=document.createElement("iframe");v.style.display="none",v.src=E,document.body.appendChild(v),setTimeout(function(){v.parentElement&&document.body.removeChild(v)},5e3),m({code:200,data:"success",error:""})}));case 3:case"end":return e.stop()}},n)})),A.apply(this,arguments)}function S(n){return R.apply(this,arguments)}function R(){return R=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/commit",{method:"POST",data:i}));case 1:case"end":return e.stop()}},n)})),R.apply(this,arguments)}function B(n){return j.apply(this,arguments)}function j(){return j=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/upgrade",{method:"POST",data:i}));case 1:case"end":return e.stop()}},n)})),j.apply(this,arguments)}function W(n){return L.apply(this,arguments)}function L(){return L=_()(r()().mark(function n(i){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/dpanel/api/app/container/copy",{method:"POST",data:i}));case 1:case"end":return e.stop()}},n)})),L.apply(this,arguments)}},24078:function(){"use strict"},78267:function(I){(function(f,t){I.exports=t()})(self,()=>(()=>{"use strict";var f={};return(()=>{var t=f;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=class{activate(s){this._terminal=s}dispose(){}fit(){const s=this.proposeDimensions();if(!s||!this._terminal||isNaN(s.cols)||isNaN(s.rows))return;const d=this._terminal._core;this._terminal.rows===s.rows&&this._terminal.cols===s.cols||(d._renderService.clear(),this._terminal.resize(s.cols,s.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const s=this._terminal._core,d=s._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;const b=this._terminal.options.scrollback===0?0:s.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),C=parseInt(r.getPropertyValue("height")),_=Math.max(0,parseInt(r.getPropertyValue("width"))),o=window.getComputedStyle(this._terminal.element),y=C-(parseInt(o.getPropertyValue("padding-top"))+parseInt(o.getPropertyValue("padding-bottom"))),M=_-(parseInt(o.getPropertyValue("padding-right"))+parseInt(o.getPropertyValue("padding-left")))-b;return{cols:Math.max(2,Math.floor(M/d.css.cell.width)),rows:Math.max(1,Math.floor(y/d.css.cell.height))}}}})(),f})())}}]);
